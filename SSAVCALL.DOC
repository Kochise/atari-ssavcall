/////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////
///                                                                   ///
///            >>> "STALLION SOFTWARE'S AES-VDI CALL"¿ <<<            ///
///                                                                   ///
/////////////////////////////////////////////////////////////////////////
///                                                                   ///
/// CONVERTISEUR DE FORMAT D'APPELS A L'AES/VDI PAR STALLION SOFTWARE ///
///                                                                   ///
/////////////////////////////////////////////////////////////////////////
///                                                                   ///
/// PROGRAMM PAR KOCH DAVID (IDFRAKOCH-9508851003894DAVID-7803118M5) ///
///           EN ASSEMBLEUR 68030 AVEC DEVPAC V3.1 DE HISOFT          ///
///           SUR UN ATARI FALCON030 (Y44A02-4005369) 4Mo/540Meg/FP82 ///
///                                                                   ///
/// PREMIERE VERSION FONCTIONNELLE LE LUNDI 14 JUILLET 1997           ///
///                                                                   ///
/////////////////////////////////////////////////////////////////////////
///                                                                   ///
/// ATTENTION : Cette routine N'EST PAS du domaine publique, il est   ///
///             donc formellement proscrit de modifier le source      ///
///             original sans m'avoir demand‚ mon avis au pr‚alable   ///
///             (je tiens … garantir une certaine coh‚sion entre les  ///
///             diff‚rentes versions qui sont en circulation, car les ///
///             versions sauvages risquent juste de faire revenir la  ///
///             simplicit‚ d'emploi que j'avais r‚ussi … obtenir au   ///
///             niveau de la "complication" d'utilisation du GEM …    ///
///             l'origine). Il est cependant conseill‚ de diffuser le ///
///             plus possible cette routine, au cas o— quelques       ///
///             personnes puissent y trouver leur bonheur.            ///
///                                                                   ///
///                                                        KOCHISE    ///
///                                                                   ///
/////////////////////////////////////////////////////////////////////////
///                                                                   ///
/// THANKS TO : ATARI FOR THE FALCON, GREATEST COMPUTER OF THE WORLD  ///
///             MOTOROLA FOR THEIR POWERFULL 68000 CHIPS FAMILLY      ///
///             DIGITAL RESEARCH FOR THEIR FAILING BUT GOOD TOS 4.04  ///
///             HISOFT FOR THEIR EXCELLENT DEVPAC 3.1 AND DSP         ///
///                                                                   ///
/////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////

Infos sur la Version 1.11 :

  Cette version tire partie d'un mode d'accŠs … la m‚moire particulier, r‚serv‚
aux seuls 68020 et successeurs. Ne tentez donc pas de lancer ce code sur votre
Atari ST (sauf si vous disposez de la SST030, de la PAK 3/68K ou de la non moins
formidable BOOSTER 020).
  J'explique cela car pour une premiŠre version, qui risque fortement d'ˆtre
bugg‚e, je ne tiens pas particuliŠrement … me prendre la tˆte avec des appels
simplistes qui tiennent en plusieurs lignes sur 68000, alors qu'… partir du
68020, de formidables modes d'adressages sont pr‚sents, et tiennent, eux, en une
lignes. Ainsi, jusqu'a que ma routine soit d‚bugg‚e, les d‚tenteurs de STs
devront patienter, car d‚bugger des milliers de lignes est d‚j… lourd, mais
multipliez cela par trois ou quatre, et ‡a n'est pas demain que vous en verrez
une nouvelle version.
  N‚anmoins, je vous donne une indication pour que les ST-Maniacs puissent
attendre sans regretter leur achat : Chaque version se terminant par 9
fonctionnera sur ST (par exemple la 1.09). Ainsi, si sur la jaquette d'un
magazine pr‚sentant une disquette contenant une version de ce type, il n'y a
plus qu'a fondre dessus tel un faucon sur sa proie. Vous pouvez donc d‚j…
pr‚parer vos programmes pour accueillir SSAV.
  De plus, pour Mr ATTARD qui se d‚sole des diff‚rences d'appels entre l'AES et
le VDI concernant les coordonn‚es, je compte r‚gulariser cela dans une prochaine
version au profit du systŠme de l'AES. Il faudra donc revoir certains source
devenus obsolŠte, sorry...

DiVaGaTiOn :

  Qui n'a pas tent‚ un jour d'utiliser le GEM … partir de l'Assembleur? Ce
langage qui fait fr‚mir plus d'un programmeur lorsqu'on l'‚voque, … cause
essentiellement de sa puissance et sa rapidit‚, est aussi synonyme de complexit‚
d'utilisation ‚tant donn‚ que c'est un langage de trŠs bas niveau. En effet,
‚tant un langage machine, il s'agit pour le programmeur de dire au processeur
exactement ce qu'il doit faire, pas … pas.
  Si l'utilisation du GEMDOS, BIOS ou XBIOS ne pose pas (ou du moins
pratiquement pas) de problŠme en Assembleur, il s'agit d'une autre paire de
manche lorsqu'on parle du GEM. Tout ATARIste (ou presque) sait que le GEM a ‚t‚
‚crit en C, car l'‚criture d'une interface graphique aussi performante aurait
‚t‚ insongeable en Assembleur. Programmer une interface structur‚ ne peut se
faire qu'avec un langage structur‚. Or l'Assembleur n'est SUREMENT PAS un
langage structur‚, loin de l…. Mr KERNIGHAN et RITCHIE, lorsqu'il ont mis au
point le C, n'avaient peut ˆtre pas pr‚vus qu'il serait utilis‚ avec d'autres
langage. Le C devait ˆtre seul sur un systŠme, c'est … dire que tout sur
l'ordinateur devait avoir ‚t‚ programm‚ en C. Et sur ATARI, o— une partie du
systŠme d'exploitation a ‚t‚ ‚crite justement en C, il arrive des conflits de
format qui oblige le programmeur en Assembleur … se prendre la tˆte pour les
conversions.
  HiSoft … bien tent‚ d'y rem‚dier en diffusant des librairies de macros avec
DEVPAC, mais celle-ci (… mon avis) ne sont pas trŠs ergonomiques. Aussi avais-je
d‚cider de programmer une routine de conversion Assembleur-C pour rendre
l'utilisation de l'AES et du VDI aussi simple que le GEMDOS, BIOS ou autre XBIOS
(car en ce temps l…, j'avais programm‚ l'interface de NeoScape en GFA, or tout
le monde sait ce que donne le GFA sur un Falcon). Il s'agit … pr‚sent d'EmPiler
les informations suivant un sch‚ma pr‚cis (comme il s'agit d‚j… de le faire avec
GEMDOS et compagnie), et de sauter au d‚but de la routine pour titiller le GEM.
Encore fallait-il y penser avant...
  Je vais vous avouez l'un des buts de SSAV : rendre  … l'assembleur ses lettres
de noblesse. Si jusque l… tout le monde est d'accord pour reconnaŒtre que du
point de vue "Vitesse d'Execution", l'assembleur ‚crase tout sur son passage,
n‚anmoins, les grand programmeur de ce monde ricane en en entendant parler, vu
qu'en C, le temps de programmation est dix fois moindre. Je suis de leurs avis.
Cependant, jamais personne (en fait, je n'en sait fichtrement rien...) n'avais
pens‚ … faire des outils dignes de ce nom pour l'assembleur, juste des
d‚buggeurs, et quelques friandises, mais rien de consistant.
  Aussi, SSAV n'est que le PŠre d'une trŠs longue s‚rie d'utilitaires et
d'outils pour r‚duire le temps de d‚veloppement d'une application en assembleur.
Je pense qu'avec cela, le d‚veloppement sur ATARI va prendre plusieurs coups de
fouets qui risquent de r‚veiller. Attention la claque, pros du C... On revient
en force, nous autres Codeurs!

KOSS SSAV The GEM, ou la philosophie du GEM :

  Avant de commencer, je pense qu'il est souhaitable pour certains d'entre vous
de lire ce qui va suivre. Ceux qui au contraire pense ne plus rien avoir …
apprendre du GEM, ma foi, qu'il passent leur chemin.
  Bien, maintenant que l'on est entre nous, posez vous sur un siŠge confortable,
calmez vous et respirez profond‚ment : je vais tenter de vous d‚dramatiser le
GEM. Jusqu'a pr‚sent, les documents de d‚veloppement sur le sujet ‚tait un peu,
... herm‚tique. Ils s'adressaient essentiellement … des personnes ayant d‚j… eut
… faire avec le GEM, et ne servaient en g‚n‚ral que d'aide m‚moire. Moi mˆme, je
me suis sentit plusieurs fois frustr‚e par ces programmeur qui distillaient ou
compliquaient les informations, comme pour les r‚server … une ‚lite, au lieu de
les d‚mocratiser et de les offrir … ceux qui pourrait en faire quelques chose
entres leurs doigts. C'est d'ailleurs pour cela que je me suis mis si tard au
GEM. Remarquez, y'a toujours quelqu'un pour se plaindre du manque de
d‚veloppement sur ATARI, mais la faute … qui...?
  Heureusement, quelques Seigneurs du clavier ont essayez de faire comprendre le
principe du GEM aux n‚ophytes. Cependant, il est plus facile de comprendre
quelques chose que l'on a d‚j… compris, que de le faire comprendre (quelle
science, n'est il pas...). C'est pour cela que j'en profite pour ‚crire ce
paragraphe pendant que j'assimile le concept de cette formidable interface (mˆme
sur ST).
  Voil…, le mot est lanc‚, encore va t-il falloir le r‚ceptionner... Je pense
que la plupart d'entre vous ˆtes de bon programmeur, mais faute de documents,
vous n'avez put tirer parti du potentiel qu'offre le GEM, et vos interface se
sont limit‚es … du TOS pur et dur. Je ne vous blammerais pas, car ce n'est d‚j…
pas le but de ce texte, et moi mˆme je me souviens avoir fait de trŠs bonnes
interfaces sous TOS. Mais … chaque fois il m'a fallut r‚inventer la roue, g‚rer
les ‚v‚nements clavier via le GEMDOS (voire directement exploiter le 6301), et
tout le reste, alors que j'avais le GEM qui fait tout ‡a pour vous, en bien
mieux, avec des fenˆtres et des formulaires. Commen‡ons d‚j… par revoir la
structure, car elle sont trŠs importante sous GEM, d'un programme en assembleur.
Tout programmeur en assembleur commence son programme par un M_SHRINK bien
pens‚, et le fini par un P_TERM judicieux. Ainsi, un programme en assembleur a
une tˆte et une queue.
  C'est comme un bon livre, avec une pr‚face et une conclusion. Cependant, plus
le livre est complet, comporte de chapitre, plus sa consultation devint
contraignante. C'est pour cela qu'il y a le sommaire. Ce sommaire, c'est
l'interface qui va pouvoir vous guider … travers le d‚dale de chapitres, de sous
chapitres, de paragraphes, et autres... Seulement voila, soit vous ‚crivez le
sommaire aprŠs (il est plut“t conseillez avant) avoir ‚crit tous les chapitres
de votre chef d'oeuvre, ou de demander au GEM de le faire pour vous. Vous ˆtes
conscient j'espŠre que plus un livre est complet, plus son sommaire doit ˆtre
intuitif, clair, organis‚, a‚r‚, proportionnellement parlant, ‚videment. Et le
GEM fait ‡a. Bien sur, il va falloir, … la main, r‚cup‚rer les informations que
le GEM nous envoie tout au long des appels, mais rassurez vous, il prend
vraiment le gros du travail, et ne vous demande que le strict n‚cessaire.
Certaines fonctions demandes beaucoup de paramŠtres, mais au lieu d'avoir
plusieurs fonctions avec peu de paramŠtres, vous en avez de complŠtes, qui
utilis‚es intelligemment peuvent vous rendre de trŠs grands services.
  Maintenant, entrons dans l'atmosphŠre du GEM. Ceux qui comme moi se sont d‚j…
essay‚ … la cr‚ation d'une interface sous TOS, ont je pense eut comme
l'impression de travailler en face d'un miroir. L'esprit de l'interface sera …
l'image du programmeur. C'est … lui de tout g‚rer, d'un cot‚ pour les calcul, et
de l'autre pour l'interface. Ainsi, les deux parties, bien que distinctes, sont
trŠs soud‚es. Grƒce … cela, le programmeur peut mettre au point une interface
sur mesure, souvent fiable, disposant du strict n‚cessaire. Le programmeur en
GEM … plut“t l'impression de travailler en r‚seau, avec quelqu'un d'inconnu au
bout du fil, qui lui gŠre l'interface, et lui transmet poliment et avec grande
pr‚cision tout ce qui ce passe de son cot‚.
  Le programmeur doit donc s'adapter … une sorte de protocole standard de
dialogue pour se faire comprendre de son interlocuteur l'interface GEM, un peu
comme nous parlons l'anglais ou l'esp‚ranto dans le monde entier pour nous faire
comprendre. Le programmeur en GEM devra donc prendre en compte des paramŠtres en
plus, qui ne lui serviront peut ˆtre pas, du moins dans ce programme. Mais ces
paramŠtres ont ‚t‚ pr‚vus pour pouvoir r‚pondre … tous les cas de figure d'une
interface conviviale et ergonomique. Au d‚but de la programmation GEM, on se
sent comme au d‚but de la programmation en assembleur : on programme …
l'aveuglette, sans savoir se que cela donnera … l'‚cran. Au fur et … mesure, on
acquiŠre de l'exp‚rience, et on arrive … s'imaginer l'interface … l'avance. La
r‚action de l'interface, c'est cela … quoi doit v‚ritablement penser le
programmeur. C'est comme un bƒtiment, il en construit l'architecture globale, le
reste n'est qu'affaire de go–t.
  Mais tout serait trop simple si en fait le GEM n'‚tait que des "super routines
standardis‚es", et le programmeur … n'avoir qu'a pr‚voir quelques boucles d‚ci
del… au fil de son programme pour g‚rer correctement l'ensemble. Et bien croyez
le ou non, c'est exactement cela! Le GEM n'est autre qu'une interface graphique
pr‚vus pour r‚pondre … tous les besoins (NdM: pas possible...), si l'on lui
demande. Mais comme je tiens … vous le faire comprendre, ne vous attendez pas …
n'avoir que quelques paramŠtres … faire passer au GEM pour que tout ce passe
pour le mieux, il va falloir ‚crire pas mal de lignes, mˆme si SSAV permet de
r‚duire de beaucoup ce nombre (quoique ce n'est pas toujours vrai, mais am‚liore
sensiblement la compr‚hension et la relecture d'un programme). Il ne s'agit pas
cependant de se d‚courager, car vous verrez aprŠs quelques tests d'affichage de
formulaires ou de fenˆtres, que le GEM n'a vraiment rien de sorcier, et qu'il
est vraiment simple … dompter.
  Je pense que certains ont eus peur du GEM en croyant … avoir … appeler
plusieurs fonctions avant d'arriver … leurs fins, ou que certaines fonctions
‚taient capricieuses et ne marchait que dans certains cas. Et bien que nenni,
les fonctions du GEM marchent … tous les coup, comme celles du GEMDOS et
compagnie. Le GEM, c'est comme les op‚rations sur un fichier. Vous l'ouvrez, le
lisez, puis le fermez. En GEM, un formulaire, vous le centrez, l'affichez, et le
g‚rez. Plus vous tenterez d'am‚liorer vos interfaces, plus vous acquerrez de
l'exp‚rience, et comme aprŠs avoir compris l'assembleur, vous en viendrez … vous
demander comment vous n'avez pas saisit plus t“t le concept du GEM, et que vous
aviez continu‚ … faire des interfaces textuelles.
  Si dans les interfaces TOS il ‚tait questions de coordonn‚es textes pour
afficher un texte … un endroit donn‚, le GEM, c'est EXACTEMENT le mˆme chose. Le
GEM est facile … comprendre, moi mˆme je l'ait compris (mais je ne me considŠre
pas comme une r‚f‚rence). Si au d‚but vous croirez perdre du temps … cr‚er une
ressource, et … la g‚rer, vous vous rendrez vite compte qu'en fait, vous faisiez
le mˆme travail, souvent pendant plus longtemps, pour moins joli, et moins
pratique, car ne peut travailler avec d'autres taches.
  Justement, … ce propos, sur le ST, dont les concepteur n'imaginait pas un jour
ses capacit‚s mises … profit du multi-tache (demandez donc … votre 8086 de faire
la mˆme chose, l…, pour voir), ils n'ont pas jug‚s utile d'int‚grer au GEM des
routines de gestion de formulaire qui n'accaparent pas toutes les ressources.
Pas que l'interface va vous bouffer tout votre temps machine, mais ces gestion
font une boucle, dont on ne sort qu'une fois avoir appuy‚ sur un bouton qui est
pr‚vus pour. Donc pas question de continuer … utiliser votre interface si vous
n'ˆtes pas sorti de ce fichus (censure) de formulaire qui vous interdit
d'utiliser le menu, et d'ouvrir un accessoire pour r‚duire le volume.
  C'est pour cela qu'un des grand maŒtre du GEM, je nomme Sir ATTARD, et peut
ˆtre moi mˆme, avons mis au point une routine qui ne bloque pas l'interface des
que l'on … quelque chose … faire passer au programme par le biais d'une boite de
dialogue. Celles ci sont respectivement XForm_Do (pour eXtended Form_Do), trŠs
bien, et SSX2Form_Do (pour STALLION SOFTWARE's eXtended XForm_Do), bien mieux,
sans vouloir d‚pr‚cier les lauriers … notre bienfaiteur (vu la quantit‚ qu'il
possŠde, il peut s'en faire un passe-montagne au lieu d'une simple couronne),
pr‚curseur en la matiŠre.
  N‚anmoins, y'a mˆme encore mieux, une id‚e de Moi, c'est SSForm_Process. Ayant
‚t‚ un fana du CPC (et oui, j'avais une vie avant la vie, et en ces temps
recul‚s, c'‚tait le CPC l'objet de mes d‚lires), j'ai trouv‚ "ind‚licat", nous,
programmeur en assembleur, d'avoir … assembler du code, alors que sur ces
machines, je programmais directement en interpr‚t‚. Ainsi, vous n'aurez mˆme
plus … faire cela (enfin, mouins...). Mais cela ne doit pas vous empˆcher de
comprendre comment ‡a marche, le GEM, car tout le monde n'aura pas SSAV
(quoique...). Il ne vous reste plus qu'a potasser cette doc, en essayant de
relativiser, et de vous imaginer face … une interface que vous connaissez bien,
et essayez de la g‚rer. C'est total Ovaire Ze Taupe (Over The Top...). Je vous
laisse ‚tudier en profondeur le KA (cas) SSAV...

Format de LaDite Routine :

Celle ci est pr‚c‚d‚e de six octets d'informations.
WORD 0 : Num‚ro de la version au format BCD HexaD‚cimal.
           Ex: 0136 est la routine de version 1.36.
WORD 1 : Date d'Assemblage (histoire de se rep‚rer dans ses archivages...).
           Mˆme format que la date systŠme (obtenue par T_GETDATE (GEMDOS $2A)).
           BITS  4-0: Le jour (de 0 … 31).
           BITS  8-5: Le mois (de 0 … 15).
           BITS 15-9: L'ann‚e (de 0 … 127) plus 1980 (d‚but du comptage).
                      Donc 2107 au maximum.
           Par exemple, le 11 Mars 1997: BIT  4-0=%01011  (11)
                                         BIT  8-5=%0011   (03)
                                         BIT 15-9=%001001 (17+1980=1997)
WORD 2 : Compteur de tƒches (de 0 … 65535)
         Avec ce compteur, vous pouvez savoir combien de tƒches sont en train
         d'exploiter SSAV.
WORD 3-...: The Routine.

Informations d'exploitation :

Plusieurs choses, ...
  Evidement, si vous utilisez cette routine dans un de vos programmes, ce serait
cool … vous de l'indiquer quelque part dans votre interface. Merci encore...
  Lorsque j'installe cette routine en m‚moire (donc ne pas l'inclure dans votre
code), j'installe un Cookie du doux nom de "SSAV". Son information (les quatre
octets suivant le nom du Cookie) n'est autre que l'adresse de la routine (la
routine, et pas les octets d'informations). Utilisez une ‚tiquette o— vous
stockerez son adresse. Comme la routine n'est pas elle-mˆme multi-tache,
chaqu'une (des tƒches) doit avoir ses propres variables d'‚change avec le GEM
(voir UTILSSAV.S, qu'il fait bon inclure, par contre, dans vos programmes).
  Je voudrait aussi demander … ceux qui ont, qui font, ou qui vont faire des
interfaces sous GEM de ne pas trop travailler dans leurs coins. Il serait bon
qu'il existe une sorte de "standard esth‚tique" pour homog‚n‚iser l'aspect du
GEM suivant le programme. Il est ‚vident que chacun essaye de se d‚marquer par
tous les moyens possibles son programme d'un autre, mais de l'ext‚rieur, pour
quelqu'un habitu‚ … travailler sous WinDaube ou System 7 et leurs interfaces
aseptis‚es, c'est le fouillis et le bordel le plus total, o— une impression
d'anarchie et de non dialogue rŠgne sur ATARI (peu ˆtre une cause de la mauvaise
image que l'ont portes comme un terrible PC..., pardon, fardeau). Je ne vous
demande pas de suivre mon style d'interface, quoique j'essaye de le rendre le
plus agr‚able possible pour l'oeil.
  Bien, … vous les programmeurs...

Distribution de SSAV et de votre programme :

  Diffusez le plus possible SSAV. Offrez le … vos amis, vos frangins, votre
‚picier, votre chiens, votre inspecteur des imp“ts, votre pr‚sident, votre
postier, votre concierge, votre idole, bref, … quelqu'un susceptible d'appr‚cier
SSAV.
  Pour votre programme, pas la peine de mettre toute l'archive (les utilitaires
et documents de SSAVCALL), le programme SSAVCALL.PRG suffit amplement, …
condition que la version fonctionne avec votre programme, c'est un minimum (mais
SSAV fait le maximum...).

Format d'Appels en Assembleur :

DOCUMENTATION DE SSAV V1.11

Voici enfin la description de chaque fonction AES et VDI, expliqu‚es et
comment‚es, avec le format d'appel pour chaqu'une d'elles.
Les deux derniers paramŠtres … empiler sont :
  WORD : le num‚ro de la fonction
  WORD : 115 pour le VDI ou 200 pour l'AES

ATTENTION : Cette documentation sera sujette … d'importante modifications et
            corrections. Aussi, je vous demande de vous r‚f‚rer le plus possible
            … la derniŠre documentation ‚dit‚e. Pour chaque nouvelle version de
            SSAV, une nouvelle version de la documentation l'accompagne. Il se
            peut, et c'est mˆme certains, que cette documentation comporte des
            erreurs. Si vous en rep‚rez une, ne tardez surtout pas … me la
            communiquer pour que je la corrige.

Nous vous prions d'‚teindre votre cigarette (cigare, c“ne, moquette...),
d'attacher votre ceinture, d'arrˆter de manger au dessus de votre clavier (c'est
pas propre), de prendre vos pr‚caution avant le d‚but de l'explication (si c'est
pas fait, n'oubliez pas de d‚bouclez votre ceinture), et de mettre une musique
douce (style AC-DC ou Thunderdome) en fond sonore.
Merci encore de votre attention...

*** A E S (200) ***

--- LIBRAIRIE APPLICATIONS ---

/// AES  10 : APPL_INIT ///

  Sert … indiquer au GEM qu'une nouvelle tache voudrait profiter de ses nombreux
avantages.
  En soit, inutile car rien ne vous empeche d'appeler les nombreuses fonctions
de l'AES sans passer par celle ci. Cependant, permet par exemple de savoir si
l'AES est (d‚j…) install‚, et de travailler en cons‚quence.
  Cependant, si vous voullez communiquer avec d'autres taches, il faut appeler
imp‚rativement cette fonction afin de signaler au GEM que vous etes une
application communiquante. Si vous n'etes pas en multi-tache, permet tout de
meme de dialoguer avec les accessoires. Voyez Appl_Find.
  C'est tres utile pour faire par exemple des programmes d'extension du systeme,
configurables. Si vous le mettez dans le dossier AUTO, vu que l'AES n'est pas
encore install‚, vous pouvez le savoir, et installer vos routines. Au contraire,
si vous lancez le meme programme depuis le bureau, vous savez que l'AES est
install‚ car cette fonction vous renvoie un code correct, et vous pouvez donc
exploiter une interface pour configurer sans crainte votre programme.
  A ce sujet, n'oubliez pas que dans le File Header de votre programme, il se
trouve l'emplacement de la zone DATA (la zone des constantes), qu'il vous suffit
de prendre, d'additionner l'adresse de d‚but de la zone ou se trouve votre
programme (voyez dans la Base Page, lorsque votre programme est en train d'etre
ex‚cut‚), de modifier correctement ces valeurs, et de re sauvegarder cette zone
au bon endroit sur le disque (… la place de la zone DATA du fichier programme)
pour qu'au prochain lancement, ces donn‚es soient prises en compte.

ParamŠtres : LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = APP_ID (Le Handle du GEM, … retenir imp‚rativement)
                -1 si erreur, sinon OK (mˆme 0)
Pile : 8

/// AES  11 : APPL_READ ///

  Sert … lire un message "Custom", particulier, qui ne tient pas dans les 8
WORDs pr‚vus … cet effet (Voir la LIBRAIRIE EVENEMENTS). Cette fonction sert
essentiellement pour les dialogues entre les applications, lorsque vous
d‚finissez vos propres messages. Mais peut aussi recevoir des messages au format
GEM...
  Justement, … ce sujet, voyez EVNT_MESAG (AES 23) pour obtenir le format d'un
message typiquement GEM.

ParamŠtres : WORD : APP_ID de l'application Expeditrice
             WORD : Longueur du message … lire
             LONG : Adresse du tampon du message … stocker
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon c'est OK
Pile : 16

/// AES  12 : APPL_WRITE ///

  Sert … envoyez un message "Normal" (8 WORDs), ou "Perso" (plus ...), … une
application. Il est souhaitable que les 8 premiers mots correspondent au format
standard du GEM, "le reste vous appartient" (½ Indiana Jones). Pour vos
messages, tachez cependant de garder une certaine logique dans leur
construction.

ParamŠtres : WORD : APP_ID de l'application Destinataire
             WORD : Longueur du message … ‚crire
             LONG : Adresse du tampon du message … envoyer
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon c'est OK
Pile : 16

/// AES  13 : APPL_FIND ///

  Tout programme charg‚ est plac‚ en m‚moire avec le nom du fichier associ‚. En
clair, vous chargez TESTSSAV.PRG, et en m‚moire vous obtenez son code et son nom
(en fait, c'est un peu plus compliqu‚, mais ‡a marche dans ce style). Grace …
cela, le GEM, lors de APPL_INIT, y associe l'APP_ID de TESTSSAV, et simplement
en connaissant le nom du programme, vous pouvez retrouver son APP_ID. Vous
pouvez donc grƒce … cela lui envoyer un message, et le GEM se chargera d‚j… de
lui le faire parvenir.
  C'est en autre pour cela qu'il est important de passer par Appl_Init (AES 10).

ParamŠtres : LONG : Pointeur vers le nom de l'application … chercher (8
                    caractŠres termin‚s par un octet nul. Combler avec des
                    Espaces si le nom fait moins de 8 caractŠres)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = APP_ID de l'application cherch‚e, sinon -1
Pile : 12

/// AES  14 : APPL_TPLAY ///

Sert … rejouer un enregistrement obtenu avec APPL_TRECORD (AES 15).

ParamŠtres : LONG : Adresse de l'enregistrement.
             WORD : Vitesse de lecture
                    ATTENTION : Ceci est un diviseur.
                                  Lors de l'enregistrement, les ‚v‚nements Timer
                                sont calcul‚s en milliŠme de seconde. Cependant,
                                lors de la lecture, ces ‚v‚nements Timer sont
                                pris comme dixiŠme de seconde. Pour obtenir une
                                vitesse de reproduction identique, il suffit de
                                mettre 100 ici (1000/100=10).
                                  Cela sert pour synchroniser la lecture, pour
                                que la vitesse soit la mˆme sur des
                                configurations diff‚rentes.
                                  En principe, lorsque vous bougez la souris,
                                entre deux position diff‚rente, vous devriez
                                trouver un ‚v‚nement Timer, qui permet de
                                reproduire la temporisation du "coul‚" lorsque
                                vous d‚placez la bˆte en question.
                                  En fait, chaque enregistrement est ponctu‚
                                d'‚v‚nements Timer.
             WORD : Nombre d'action … ex‚cuter.
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : Aucun
Pile : 16

/// AES  15 : APPL_TRECORD ///

  Sert … enregistrer des actions utilisateur, comme on peut enregistrer le son
sur FALCON030. Le son est compos‚ de deux fois 16 bits pour chaque canal audio
(plus ou moins suivant sont choix). Ici, chaque action est sauvegard‚e sur 6
octets.

Le format est le suivant :
OCTET 0-1 : Type d'‚v‚nement (0=Timer, 1=Bouton, 2=Souris, 3=Clavier)
OCTET 2-5 : Donn‚e en fonction du type de l'‚v‚nement (0=Nombre de
            millisecondes ‚coul‚es, 1=‚tat des boutons, 2=Coordonn‚es X.w et
            Y.w de la souris, 3=CaractŠres et ‚tat du clavier)

  N'ayez cependant pas peur que votre m‚moire se remplisse trop vite: s'il ne ce
passe rien pendant un certain temps, vous n'obtiendrez qu'un ‚v‚nement Timer qui
vous indiquera la dur‚e entre deux ‚v‚nements. Mais si vous jonglez avec votre
souris, l…, attendez vous rapidement … un "Plus de m‚moire...".

ParamŠtres : LONG : Adresse o— enregistrer. Faites donc attention … bien
                    pr‚voir une m‚moire au moins six fois plus importante que
                    le nombre d'actions … enregistrer.
             WORD : Nombre d'actions … enregistrer.
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Nombre d'actions enregistr‚es.
Pile : 14

/// AES  18 : APPL_SEARCH ///

(Pas de documents, mais implant‚)

ParamŠtres : WORD : Mode
             LONG : Adresse du Nom
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Int_Out0
Pile : 14

/// AES  19 : APPL_EXIT ///

  Sert … indiquer au GEM que l'on voudrait bien … pr‚sent se passer de ses
inestimables services. En soit, indique au GEM qu'on le quitte, et que ce n'est
plus la peine de nous envoyer les messages d'autres applications, au d'autres
choses.

ParamŠtres : LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 8

--- LIBRAIRIE EVENEMENTS ---

/// AES  20 : EVNT_KEYBD ///

  Attend une touche (obtient … peu prŠs le mˆme r‚sultat que VOID INP(2) en
GFA). Cependant, ne bloque pas le systŠme, bien que le d‚roulement du programme
se trouve suspendu (appelez voir un accessoire pour vous rendre compte par vous
mˆme)

ParamŠtres : LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Code de la touche enfonc‚e (Comme C_RAWCIN (GEMDOS 7))
Pile : 8

/// AES  21 : EVNT_BUTTON ///

  Attend une certaine action de la part de la souris (‚loignez le chat, quelle
trouve le courage de sortir de son trou).

ParamŠtres : WORD : Nombre de clicks
                    Cela dans un intervalle de temps d‚termin‚ par EVNT_DCLICK
                    (AES 26)
             WORD : Masque de s‚lection
                    BIT 0 = Bouton gauche
                    BIT 1 = Bouton droit
             WORD : Etat attendu
                    BIT 0 = Etat du bouton gauche
                    BIT 1 = Etat du bouton droit
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.l = Pointeur vers un tableau de r‚ponses du GEM
         Structure du tableau : WORD 0 : Nombre de clicks
                                WORD 1 : Coordonn‚es X lors de l'action
                                WORD 2 : Coordonn‚es Y lors de l'action
                                WORD 3 : Etat des boutons
                                         BIT 0 = Bouton gauche
                                         BIT 1 = Bouton droit
                                WORD 4 : Etat des touches sp‚ciales
                                         BIT 0 = SHIFT Droit
                                         BIT 1 = SHIFT Gauche
                                         BIT 2 = CONTROL
                                         BIT 3 = ALTERNATE
Pile : 14

/// AES  22 : EVNT_MOUSE ///

  Ici, on attend que la souris se positionne (mais pas toute seule) dans un
certains rectangle d‚finit par des coordonn‚es.

ParamŠtres : WORD : Choix de la position
                    0 = Si la souris est dans le rectangle
                    1 = Si la souris est hors du rectangle
             WORD : Coordonn‚e X du coin sup‚rieur gauche du rectangle
             WORD : Coordonn‚e Y du coin sup‚rieur gauche du rectangle
             WORD : Largeur du rectangle en points
             WORD : Hauteur du rectangle en points
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.l = Pointeur vers un tableau de r‚ponses du GEM
         Structure du tableau : WORD 0 : Coordonn‚es X lors de l'action
                                WORD 2 : Coordonn‚es Y lors de l'action
                                WORD 3 : Etat des boutons
                                         BIT 0 = Bouton gauche
                                         BIT 1 = Bouton droit
                                WORD 4 : Etat des touches sp‚ciales
                                         BIT 0 = SHIFT Droit
                                         BIT 1 = SHIFT Gauche
                                         BIT 2 = CONTROL
                                         BIT 3 = ALTERNATE
Pile : 18

/// AES  23 : EVNT_MESAG ///

  Attend un message GEM, voire un message personnel, mais n'exc‚dant pas 8
WORDs (taille standard d'un message GEM).

  Voici la structure d'un message GEM, et des autres, comme les v“tres par
exemple : WORD 0 : Type de message
          WORD 1 : APP_ID de l'application Expeditrice du message
          WORD 2 : Si ce WORD n'est pas nul, c'est que le message n'est pas au
                   format GEM Stardard, et comporte des octets suppl‚mentaires
                   qu'il vous faudra r‚cup‚rer avec APPL_READ (AES 11). Ce
                   nombre est en principe le nombre d'OCTETs suppl‚mentaires …
                   lire avec APPL_READ (AES11). Pour cela, vous disposez de tout
                   ce qui est n‚cessaire dans ce message (APP_ID, taille, ...).
          WORD 3 … 7 : Suivant le Type de message

Voici … pr‚sent la liste des diff‚rents messages GEM (attention les yeux, c'est
parti) :

> MN_SELECTED (Type 10)
  Un ‚l‚ment du menu a ‚t‚ s‚lectionn‚.
  WORD 3 : Num‚ro du Titre du menu s‚lectionn‚ (vous savez, ce qui se trouve
           dans la barre de menu)
  WORD 4 : Num‚ro de l'‚l‚ment s‚lectionn‚ dans ce Titre
  LONG 5 : Adresse de l'arbre contenant le menu PopUp (dans le cas d'une
           gestion de menu PopUp)
  WORD 7 : Num‚ro de l'Objet PŠre du sous menu (Idem)

  ATTENTION : Gerer les menus n'est pas si simple, vu qu'ils sont arborescent.
              Il y a cependant une astuce, car dans un menu, aucun Titre ou
              Entr‚e n'a le mˆme num‚ro. Ainsi, il suffit de travailler avec les
              num‚ro des entr‚es pour se diriger de sous routines en sous
              routines, le num‚ro du Titre n'‚tant l… que pour nous permettre de
              le faire revenir en ‚criture normale avec Menu_TNormal (AES 33).
              Pour plus de d‚tails, voyez Menu_Bar (AES 30), y'a une Grosse
              Surprize.

> WM_REDRAW (Type 20)
  Une demande de restauration d'une fenˆtre (suite … la fermeture d'une autre,
  par exemple).
  WORD 3 : Handle de la fenˆtre … redessiner
  WORD 4 : X du coin sup‚rieur gauche
  WORD 5 : Y du coin sup‚rieur gauche
  WORD 6 : Largeur de la zone … redessiner
  WORD 7 : Hauteur de la zone … redessiner

> WM_TOPPED (Type 21)
  Une fenˆtre vient d'ˆtre mise au premier plan (s‚lectionn‚e). C'est … vous
  cependant de mettre ladites fenˆtre au premier plan, ou ne pas le faire (pour
  d'obscures raisons).
  WORD 3 : Handle de la fenˆtre concern‚e

> WM_CLOSED (Type 22)
  Le bouton "Closer" (coin sup‚rieur gauche) d'une fenˆtre a ‚t‚ cliqu‚, et le
  GEM vous en informe.
  WORD 3 : Handle de la fenˆtre sollicit‚e … disparaŒtre

  ATTENTION : AprŠs que vous ayez r‚ellement ferm‚ cette fenˆtre, vous devez
              vous attendre … recevoir des messages de Redraw s'il y avait
              d'autres ‚l‚ments … l'‚cran que la fenˆtre avait recouverte. Dans
              ce cas, voyez la section Window (rien … voir avec la daube du mˆme
              nom).

> WM_FULLED (Type 23)
  Le bouton "Fuller" (coin sup‚rieur droit) d'une fenˆtre a ‚t‚ cliqu‚. Comme il
  est d'usage … pr‚sent (et tous les livres sur le sujet vous le noterons), au
  premier clic sur cette case, vous devez normalement ‚taler la fenˆtre sur tout
  le bureau.
    Au deuxiŠme clic cependant, il s'agit de faire revenir … son ‚tat initial,
  si vous ne l'aviez modifi‚e entre temps. Ainsi, vous devez toujours avoir une
  fenˆtre dont les dimension sont celles d‚finies par l'utilisateur, et une
  fenˆtre ouverte sur le bureau.
  WORD 3 : Handle de la fenˆtre

> WM_ARROWED (Type 24)
  Une partie des ascenseurs de la fenˆtre … ‚t‚ activ‚e (suivant les ‚l‚ments
  dont dispose effectivement la fenˆtre, Voir WIND_CREATE (AES 100)).
  WORD 3 : Handle de la fenˆtre
  WORD 4 : Element des ascenseurs s‚lectionn‚ et action demand‚e
           0 = WA_UPPAGE : La partie entre la "Cabine" et la flŠche vers le haut
                           a ‚t‚ cliqu‚e. Cela signifie que l'utilisateur d‚sire
                           remonter rapidement d'une page vers le haut.
                           Cependant, … vous de v‚rifier si vous vous trouvez
                           d‚j… tout en haut, ou presque (moins d'une page). La
                           notion de page vient en fait des traitement de
                           textes. La taille de la colonne de l'ascenseur doit
                           ˆtre proportionnelle … la longueur du document (Voir
                           VDI), et la "Cabine" repr‚sente le contenu de la
                           fenˆtre sur le document.
                             La taille de cette cabine doit ˆtre elle aussi
                           proportionnelle … la taille de la page affich‚e par
                           rapport … la taille du document r‚el. Ainsi, si le
                           document ne fait qu'une page, et est affich‚ en
                           entier dans la fenˆtre, la "Cabine" doit occuper
                           toute la colonne de l'ascenseur. Si le document
                           occupe deux fois la page affich‚e, la "Cabine"
                           n'occupera que la moiti‚ de la colonne. Cela d‚pend
                           donc aussi de la taille de la fenˆtre.
           1 = WA_DNPAGE : Idem que pr‚c‚demment, mais c'est la partie entre la
                           "Cabine" et la flŠche vers le bas qui a ‚t‚ cliqu‚e.
                           L'utilisateur demande donc d'aller une page vers le
                           bas. Mˆmes remarques que pr‚c‚demment.
           2 = WA_UPLINE : La flŠche vers le haut a ‚t‚ cliqu‚. Si votre
                           programme est un traitement de texte, l'utilisateur
                           demande donc que la fenˆtre affiche le document …
                           partir d'une ligne pr‚c‚dente (en principe). S'il
                           s'agit d'un programme de dessin, cela peut vouloir
                           signifier "Afficher la ligne pr‚c‚dent" ou "Afficher
                           les 8 lignes pr‚c‚dentes". A vous de voir...
           3 = WA_DNLINE : Pareil, mais flŠche vers le bas.
           4 = WA_LFPAGE : Comme WA_UPPAGE ou WA_DNPAGE, mais ici il s'agit de
                           la partie entre la "Cabine Horizontale" et la flŠche
                           de gauche.
           5 = WA_RTPAGE : Idem, vers la droite
           6 = WA_LFLINE : Fleche vers la gauche
           7 = WA_RTLINE : Fleche vers la droite

> WM_HSLID (Type 25)
  L'utilisateur … directement s‚lectionn‚ la "Cabine Horizontale", la d‚plac‚e,
  et la relƒch‚e … un nouvel endroit.
  WORD 3 : Handle de la fenˆtre concern‚e
  WORD 4 : Nombre entre 0 (la "Cabine" … ‚t‚ d‚plac‚e complŠtement … gauche)
           et 1000 (la "Cabine" butte … droite du couloir horizontal)

> WM_VSLID (Type 26)
  Mˆme chose que pr‚c‚demment, mais pour la "Cabine Verticale".
  WORD 3 : Handle de la fenˆtre constern‚e.
  WORD 4 : Nombre entre 0 (o— la "Cabine" est tout en haut) et 1000 (o— elle
           est au "Rez de Chauss‚")

> WM_SIZED (Type 27)
  L'utilisateur a utilis‚ le bouton "Sizer" (coin inf‚rieur droit), … changer la
  taille de la fenˆtre, et a relƒch‚ le bouton. Le GEM vous communique
  accessoirement la nouvelle taille (mais n‚anmoins la mˆme coordonn‚e, car
  "Sizer" n'affecte que la taille), que devrait prendre votre fenˆtre.
  WORD 3 : Handle de la fenˆtre affect‚e
  WORD 4 : X de la fenˆtre (en principe, le mˆme que pr‚c‚demment)
  WORD 5 : Y de la fenˆtre (idem...)
  WORD 6 : Nouvelle largeur
  WORD 7 : Nouvelle hauteur

  ATTENTION ICI : Il se trouve que le GEM, bien qu'‚crit dans un langage pas
                  vraiment speed, vous donne des coordonn‚es "optimis‚es" pour
                  avoir le moins possible … rafraŒchir l'‚cran. Donc, si la
                  nouvelle taille est inf‚rieure, le GEM ne vous donnera …
                  retracer que les parties recouvertes, et si les nouvelles
                  dimensions sont sup‚rieures, le GEM ne vous demande que
                  d'ajouter ce qu'il y a … ajouter.
                    L… o— le bas blesse, c'est que s'il se produite un bug …
                  l'‚cran, sur une fenˆtre, et que vous esp‚rez le voir
                  disparaŒtre en la modifiant (sur laquelle se trouve, ou en
                  partie, le bug), celui ci restera.
                    Cependant, rien ne vous empˆche de retracer … chaque fois
                  toute la fenˆtre, mais le mieux est bien ‚videment d'avoir un
                  programme rapide, et notoirement bien ‚crit pour ‚viter les
                  gros m‚chants Bugs.

> WM_MOVED (Type 28)
  L'utilisateur a utilis‚ la "Barre de Titre", et … boug‚ la fenˆtre.
  WORD 3 : Handle de la fenˆtre "Emmigr‚e"
  WORD 4 : Nouveau X
  WORD 5 : Nouveau Y
  WORD 6 : Largeur (ne devrait pas avoir boug‚, car la "Barre de Menu" ne
           devrait pas avoir affect‚ la taille)
  WORD 7 : Hauteur (ma foi, ...)

  ATTENTION : Mˆme remarque que pr‚c‚demment. La fenˆtre boug‚e n'est en
              principe pas retrac‚e mais copi‚e, et seules les parties occult‚es
              sont retrac‚es.

> WM_NEWTOP (Type 29)
  €a existe, mais je sait pas … quoi ‡a sert. Mˆmes paramŠtres que WM_TOPPED. Je
  pr‚sume que c'est aprŠs la premiŠre ouverture de la fenˆtre, pour que le
  programme sache qu'il a … sauvegarder les nouveaux paramŠtres de cette
  fenˆtre, mais ce n'est que pure sp‚culation de ma part, et le modeste
  programmeur que je suis (mais quelle grande G...) ne dispose pas d'assez de
  documentations pour vous fournir de plus amples explications.
  WORD 3 : Handle de la fenˆtre

> AC_OPEN (Type 40)
  Sert … "‚veiller" un accessoire, soit lorsque l'on le choisit via le "Menu
  Bureau", ou … la main, avec APPL_WRITE.
  WORD 4 : (Quatre, et pas trois) Num‚ro de l'entr‚e du "Menu Bureau".
           ATTENTION : Rien … voir avec le num‚ro r‚el du G_STRING qui forme le
                       nom de l'accessoire (voyez MENU_BAR (AES 30)), mais bel
                       et bien le num‚ro de l'accessoire.
                         En principe, l'accessoire … re‡ut le mˆme lors de son
                       installation par MENU_REGISTER. Juste histoire de voir
                       s'il n'y a pas de Bug...

> AC_CLOSE (Type 41)
  Demande … l'accessoire de se la boucler (fermer les fenˆtres qu'il a
  ouvertes, lib‚rer la m‚moire qu'il squatte, etc...)
  WORD 3 : (Trois, cette fois ci) Num‚ro obtenu avec MENU_REGISTER (AES 35).
           Permet de v‚rifier que le GEM s'adresse bien … cet accessoire, et
           pas … l'autre.

  ATTENTION : L'application h“te (sous laquelle a ‚t‚ ouvert l'accessoire)
              re‡oit aussi un message, donc ignorez le superbement (Je m'en suis
              rendu compte car lors du d‚veloppement de TESTSSAV, aprŠs avoir
              ferm‚ un accessoire, le programme se terminait … un ‚v‚nement
              diff‚rent du menu (Type 10). AprŠs v‚rification, je me rendit
              compte que l'application recevait le message de Type 31 ($1F)).
              Quelqu'un a de la docs?

  REMARQUE : Il existe un moyen de faire des accessoire auto r‚current. Bien que
             l'info ait ‚t‚ diffus‚e dans StraTOS, je l'avais trouv‚ une semaine
             avant (t‚l‚pathie?).
             Pour fermer un accessoire, deux moyens :
              - Appuyer sur le closer, ou la touche de validation.
              - Quitter l'application en cours (si vous n'ˆtes pas sous
                MultiTOS), ou changer de r‚solution.
             Dans le premier cas, c'est votre programme qui gŠre la sortie de
             l'accessoire, mais dans le second cas, le GEM vous informe poliment
             qu'il serait bon de disparaŒtre, ou que cela va avoir lieu, et
             qu'il devient donc inutile de g‚rer l'accessoire puisque celui ci
             ne sera de toute maniŠre plus pr‚sent … l'‚cran.
               StraTOS conseille, dans ce cas, de r‚ ouvrir l'accessoire au bout
             de huit secondes environ (rechargement des diff‚rents accessoires,
             du bureau, installation du bordel, et surtout si vous avez DeskPic
             en route avec un chargement d'une image GIF en 256 couleurs).
               De mon cot‚, je ne peut h‚las vous conseiller mieux, car … ma
             connaissance, il n'existe aucun moyen de savoir quand exactement le
             bureau … v‚ritablement fini de s'installer, et donc quand votre
             accessoire serait le plus propice … se rouvrir.
               Une indication pour celui qui tiens … chercher : juste … la fin
             de l'installation du bureau, le disque dur fait un cours accŠs...
             De l…, les possibilit‚s sont infinies.
               N‚anmoins, une fois que les accessoires sont charg‚s, la boucle
             principale est execut‚e, donc en principe c'est … ce moment l…
             qu'il sagit de v‚rifier si l'accessoire ‚tait d‚j… pr‚sent avant
             de fermer l'application ou de changer de r‚solution (n'oubliez pas
             que l'on peut d‚selectionner le votre avec diff‚rents outils, ou
             en gardant press‚e la touche Control), et s'il ‚tait ouvert. Le
             TOS ‚tant pseudo-multitache (uniquement pour les accessoires),
             d'ouvrir le votre alors qu'un accessoire est en train de
             travailler ne devrait pas poser de probleme (juste un petit
             retard, le temps que le GEM s'occupe de vous).

> Messages Customs de gestion de formulaires ‚tendus.
  Ces messages seront utilis‚s au sein de SSX2Form_Do. Ces messages ne seront
  pas compatibles avec ceux de Lord ATTARD (pour BIG), car de toute maniŠre, BIG
  n'exploite pas SSAV, et r‚ciproquement.
  Cette liste sera diffus‚e avec l'apparition de la routine, une fois finie (y'a
  du boulot, croyez...).

ParamŠtres : LONG : Adresse du tampon du message (un ds.w 8 quelque part dans
                    votre programme fait trŠs bien l'affaire)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : Aucun
Pile : 12

REMARQUE : Il arrive dans certains programme (presque tous en fait), que le
           programme utilise le message au plus deux fois.
             En clair, aprŠs avoir ex‚cut‚ une action dont l'ordre provenait
           d'un message, celui ci se trouvant encore int‚gralement en m‚moire,
           le programme va l'ex‚cuter une deuxiŠme fois.
             Dans la pratique, l'exemple le plus stressant, c'est lorsque vous
           cliquez dans un ascenseur d'une fenˆtre pour descendre d'une page de
           texte par exemple, et que le programme descende de deux pages, sans
           que vous puissiez faire quoi que ce soit.
             En fait, pour stopper le processus, pendant que le programme
           effectue l'affichage de la page suivante, cliquez sur le bureau, le
           message change, et le programme est leurr‚.
             Donc, dans le cas g‚n‚ral, le mieux est d'effacer le WORD du type
           du message aprŠs l'avoir ex‚cut‚, histoire d'‚viter ce problŠme.

/// AES  24 : EVNT_TIMER ///

Pause en millisecondes … effectuer. L'utilit‚ de cette fonction est discutable.
La pause maximum est de 49 jours, 17 heures, 2 minutes, 47 secondes et 295
milliŠmes.

ParamŠtres : LONG : Nombre de millisecondes … attendre.
                    Normalement les deux WORDs qui composent ce LONG doivent
                    ˆtres invers‚s, mais ne vous inqui‚tez pas, SSAV s'occupe de
                    tout (Le WORD de poids faible … la place du WORD de poids
                    fort, et inversement : devinez pas la faute … qui, Big Blue
                    ou Bill Gates?)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : Aucun
Pile : 12

/// AES  25 : EVNT_MULTI ///

Combinaison de pratiquement tous les appels de gestions vu jusqu'ici. La cerise
sur le gƒteau (ou l'ananas si vous pr‚f‚rez), c'est qu'il est possible de g‚rer
deux EVNT_MOUSE diff‚rents (donc … g‚rer deux zones diff‚rentes).
  De plus, vu que vous g‚rez plusieurs ‚v‚nements en mˆme temps, vous n'ˆtes
plus obligez de r‚partir le travail en plusieurs fois.
Cette fonction est le noyau de XForm_Do et de SSX2Form_Do.

ParamŠtres : WORD : Type d'‚v‚nement
                    BIT 0 = Clavier (Voir EVNT_KEYBD (AES 20))
                    BIT 1 = Boutton (Voir EVNT_BUTTON (AES 21))
                    BIT 2 = (Voir EVNT_MOUSE (AES 22))
                    BIT 3 = (Voir EVNT_MOUSE (AES 22))
                    BIT 4 = Message (Voir EVNT_MESAG (AES 23))
                    BIT 5 = Timer (Voir EVNT_TIMER (AES 24))
               EVNT_BUTTON
             WORD : Nombre de clicks
             WORD : Masque de s‚lection
             WORD : Etat attendu
               EVNT_MOUSE(1)
             WORD : Choix de la premiŠre position
                    0 = Si la souris est dans le rectangle
                    1 = Si la souris est hors du rectangle
             WORD : Coordonn‚e X1 du coin sup‚rieur gauche du rectangle
             WORD : Coordonn‚e Y1 du coin sup‚rieur gauche du rectangle
             WORD : Largeur1 du rectangle en points
             WORD : Hauteur1 du rectangle en points
               EVNT_MOUSE(2)
             WORD : Choix de la deuxiŠme position
                    0 = Si la souris est dans le rectangle
                    1 = Si la souris est hors du rectangle
             WORD : Coordonn‚e X2 du coin sup‚rieur gauche du rectangle
             WORD : Coordonn‚e Y2 du coin sup‚rieur gauche du rectangle
             WORD : Largeur2 du rectangle en points
             WORD : Hauteur2 du rectangle en points
               EVNT_TIMER
             LONG : Nombre de millisecondes … attendre
               EVNT_MESAG
             LONG : Adresse du tampon du message (un ds.w 8, ou plus)
             LONG : Addresse du buffer des variables (AES_PARAMS)
Retour : D0.l = Pointeur vers un tableau de r‚ponses du GEM
         Structure du tableau : WORD 0 : Type d'‚v‚nement survenue (parmi ceux
                                         d‚finis dans le premier paramŠtre de
                                         EVNT_MULTI)
                                WORD 1 : Coordonn‚e X de la souris …
                                         l'apparition de l'‚v‚nement
                                WORD 2 : Coordonn‚e Y de la souris
                                WORD 3 : Etat des boutons
                                WORD 4 : Etat des touches sp‚ciales
                                WORD 5 : Code Clavier - Code ASCII
                                WORD 6 : Nombre de clics

Pile : 44

/// AES  26 : EVNT_DCLICK ///

Sert … obtenir ou … fixer la vitesse de double click de la souris.

ParamŠtres : WORD : Vitesse de double click (0 = Lent … 4 = Rapide)
             WORD : Mode (0 = Lecture de la vitesse, 1 = Ecriture)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Vitesse lue (Si Mode = 0), sinon vitesse ‚crite
Pile : 12

--- LIBRAIRIE MENUS ---

/// AES  30 : MENU_BAR ///

Sert … afficher ou … effacer la barre de menu du GEM. A l'affichage du nouveau
menu, le GEM se charge de remplacer les places r‚serv‚es dans le menu principal
par les accessoires en m‚moire.

  Je tiens … avertir les d‚butants, car la gestion des menus est assez ardue de
prime abord. Cependant, j'utilise une "astuce", qui n'est en fait qu'un baguage
… mon style de programmation. Les bidouilleurs qui se seront d‚j… empress‚ de
d‚sassembler SSAV auront d‚j… compris mon ... truc. En fait, c'est comme
l'assembleur, c'est logique. Mais je vous invite … suivre deux minutes fortement
didactiques.
  Il se trouve que dans le cas g‚n‚ral, le premier Titre d'un menu porte le
num‚ro 3. Le suivant le 4, et ainsi de suite. Ainsi, si votre menu comporte 4
Titres, le dernier se verra attribuer le num‚ro 6 (1ø=3, 2ø=4, 3ø=5 et 4ø=6).
Mais dans ce mˆme cas g‚n‚ral, il se trouve que la premiŠre Entr‚e soit notre
inconditionnelle "A Propos De..." dans le premier Titre. Cette entr‚e sert dans
le cas ... g‚n‚ral vous l'aurez devin‚, … donner des informations sur l'auteur,
le programme, ou... suivant le gr‚ de notre amis ressourciste (NdC : ‡a
existe?).
  Cette premiŠre Entr‚e, en la matiŠre, se voit d‚finir le num‚ro du dernier
Titre, plus 3. Dans notre exemple donc 9. Cela car l'Objet, et oui, aprŠs le
dernier Titre est un I-Box. Le suivant ‚tant la boite contenant les Entr‚es du
premier Titre.
  Donc, aprŠs notre premiŠre Entr‚e, la 9, se trouve une ligne pour d‚limiter
votre menu et les accessoires. Celle ci porte le num‚ro 10, et les Entr‚es pour
les accessoires 1 … 6 respectivement 11 … 16. L'Objet 17 est la boite contenant
les Entr‚e du deuxiŠme Titre. Ainsi de suite, jusqu'a la fin. Compl‚tons
l'exemple par une d‚finition exacte de notre menu.
TestSSAV (Titre 3)
 I-Box (num‚ro 7)
 Box TestSSAV (num‚ro 8)
  A Propos De... (Entr‚e 9)
  -------------- (num‚ro 10)
  Acc 1          (Entr‚e 11)
  Acc 2          (Entr‚e 12)
  Acc 3          (Entr‚e 13)
  Acc 4          (Entr‚e 14)
  Acc 5          (Entr‚e 15)
  Acc 6          (Entr‚e 16)
Fichiers (Titre 4)
 Box Fichiers (num‚ro 17)
  Nouveau     (Entr‚e 18)
  Ouvrir      (Entr‚e 19)
  ----------- (num‚ro 20)
  Sauver      (Entr‚e 21)
  Sauver sous (Entr‚e 22)
  ----------- (num‚ro 23)
  Quitter     (Entr‚e 24)
Affichage (Titre 5)
 Box Affichage (num‚ro 25)
  Fenˆtres    (Entr‚e 26)
  Formulaires (Entr‚e 27)
Graphisme (Titre 6)
 Box Graphisme (num‚ro 28)
  Ligne     (Entr‚e 29)
  Rectangle (Entr‚e 30)

Je suppose que vous avez compris, donc continuons.
  Dans ce menu vous n'avez pas besoin de g‚rer les lignes, les Titres (car ce
n'est pas avec un Titre que vous allez ouvrir un formulaire), les diff‚rentes
boites, et bien sur les accessoires. Mais si vous n'avez pas … les g‚rer, rien
ne doit vous empˆcher de pr‚voir assez grand pour ne pas avoir … vous prendre le
melon sur un casse tˆte. Voyons … pr‚sent ma formule magique.
  Il existe cependant bien d'autre maniŠre de g‚rer un menu, mais je pense que
dans un but de d‚veloppement en assembleur, cette version offre beaucoup
d'avantages.
  Imaginez vous que l'on vient de sortir d'une demande d'‚v‚nement avec
Evnt_Mesage par exemple, et que l'on attend quelque chose pour le menu. Le Type
est … 10, donc c'est pour nous, et il s'agit de jouer serr‚.

                ...

                pea             Menu_Return     ; On se pr‚pare au retour

                lea             Messag_Tab,A0
                move.w          (8,A0),D0       ; Le num‚ro de l'Entr‚e
                cmpi.w          #31,D0          ; On v‚rifie que l'on est bien
                                                ; dans une certaine limite,
                                                ; histoire d'‚viter le gros
                                                ; m‚chant bug
                BGE             Menu_Exit       ; Oups...
                lea             Menu_Jump,A1
                JMP             (A1,D0.w*4)     ; Warp (un BRA prend 4 octets)
                RTS                             ; On met un filet, au cas ou

Menu_Jump       BRA             Menu_Exit       ; c'est quoi l'Objet 0?
                BRA             Menu_Exit       ; Et le 1?
                BRA             Menu_Exit       ; Et le 2?
                BRA             Menu_Exit       ; C'est un Titre, et il ne
                BRA             Menu_Exit       ; peut donc ˆtre s‚lectionn‚
                BRA             Menu_Exit       ; en tant qu'Entr‚e. Donc, on
                BRA             Menu_Exit       ; s'en fout
                BRA             Menu_Exit       ; La fameuse I-Box
                BRA             Menu_Exit       ; La Box TestSSAV
                BRA             Infos           ; A Propos De...
                BRA             Menu_Exit       ; La ligne
                BRA             Menu_Exit       ; Acc 1
                BRA             Menu_Exit       ; Acc 2
                BRA             Menu_Exit       ; Acc 3
                BRA             Menu_Exit       ; Acc 4
                BRA             Menu_Exit       ; Acc 5
                BRA             Menu_Exit       ; Acc 6
                BRA             Menu_Exit       ; La Box Fichier
                BRA             New             ; Nouveau
                BRA             Load            ; Charger
                BRA             Menu_Exit       ; La ligne
                BRA             Save            ; Sauver
                BRA             Save_As         ; Sauver sous
                BRA             Menu_Exit       ; La ligne
                BRA             Quit            ; Quitter
                BRA             Menu_Exit       ; La Box Affichage
                BRA             Windows         ; Fenetres
                BRA             Forms           ; Formulaires
                BRA             Menu_Exit       ; La Box Graphisme
                BRA             Line            ; Ligne
                BRA             Rect            ; Rectangle

Menu_Return     move.w          (6,A0),D0       ; On suppose que l'on a pas
                                                ; touch‚ … A0, que l'on pointe
                                                ; encore le buffer des
                                                ; ‚v‚nements, et qu'il nous
                                                ; suffit de r‚cup‚rer le
                                                ; num‚ro du Titre … faire
                                                ; revenir en ‚criture normale
                BSR             MENU_TNORMAL

Menu_Exit       RTS                             ; On sort de la gestion

Infos           ; Il s'agit d'afficher votre formulaire, et de le g‚rer

                RTS                             ; A cause du pea, qui … simul‚
                                                ; un BSR en empilant l'adresse
                                                ; de Menu_Return, on y va.

MENU_TNORMAL    move.l          Menu_Adr,-(SP)  ; Adresse du menu
                move.w          D0,-(SP)        ; Num‚ro du Titre
                move.w          #1,-(SP)        ; Normal
                pea             AES_Params
                move.w          #33,-(SP)       ; - MENU_TNORMAL -
                move.w          #200,-(SP)      ; *** AES ***
                JSR             ([SSAV_Adr])
                lea             (16,SP),SP

                RTS

Menu_Adr        ds.l            1               ; Adresse du Menu actuel
Message_Tab     ds.w            8               ; Le buffer pour les ‚v‚nements

  Ainsi, vous disposez d'un exemple de gestion simpliste d'un menu. Si celui ci
occupe beaucoup de place, que ce n'est pas fin de ma part de proc‚der ainsi, que
je risque de m'attirer les foudres des Dieux puristes du GEM, il est n‚anmoins
relativement compr‚hensible, et facilement modifiable (il suffit de rajouter des
lignes en cas de rajout d'Entr‚es). Sachez tout de mˆme que vu que les Boxs et
autres lignes ne peuvent ˆtres s‚lectionn‚es, jamais ces sauts ne serviront,
mais je les mets pour une raison de lisibilit‚, et au cas ou un bug vicieux
viendrait vous polluer la vie (bweark...).
  Pour ceux qui veulent g‚rer deux menu (voyez donc TestSSAV), il se trouve un
problŠme lors du retour au menu pr‚c‚dent. Vu que le message ‚v‚nement
enregistr‚ est celui du menu que l'on quitte (le deuxiŠme), Menu_Return ne
trouvera pas dans le message le bon num‚ro du Titre (du premier menu) … changer
(celui qui vous a envoy‚ dans le second menu). Pourtant ce Titre (du premier
menu) est en inverse vid‚o en m‚moire.
  Si vous affichez tel quel le menu, vous aurez la surprise de voir apparaŒtre
le Titre en inverse (car disons pour TestSSAV, j'utilise la premiŠre Entr‚e du
premier Titre du deuxiŠme menu pour revenir au premier menu, donc le num‚ro de
Titre du message sera … 3 (n'oubliez pas que 3 est le num‚ro du premier
Titre)[inspiration profonde...], donc au retour, se sera le premier Titre du
premier menu qui reviendra en normal, alors qu'il y est d‚j…)[Expiration
soulag‚e...].
  La solution consiste avant de revenir, de placer … la main le num‚ro du Titre
qui a invoqu‚ le nouveau menu. En principe, vous savez dans quel Titre se trouve
l'Entr‚e en question, et ne devrais pas changer. De placer le num‚ro du Titre ne
fait pas planter l'ordinateur, mais placez bien ce num‚ro o— il faut...

ParamŠtres : LONG : Adresse du menu (A obtenir avec RSRC_GADDR (AES 100) si l'on
                    travail avec des ressources).
                      Certains finissent avec 0 ici. Allez savoir pourquoi, car
                    l'application suivante force automatiquement l'apparition de
                    la barre de menu par l'appel de cette fonction, que cela
                    soit le Bureau ou autre chose.
             WORD : Mode (0 = D‚sactive le menu ou 1= Active la chose)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 14

ATTENTION : Il se peut que vous veniez … rajouter des Entr‚es dans un menu, mais
            que vous oubliez d'en faire de mˆme avec le programme de gestion. Si
            cela vous arrivais, vous vous en rendriez compte imm‚diatement, car
            une boite ne correspondant pas … l'Entr‚e d‚sir‚e s'ouvrira, par
            exemple.
              De plus, il se peut qu'en ajoutant des Entr‚e … la fin de votre
            menu (dernier Titre), et que vous oubliez de modifier le nombre
            maximum d'Entr‚e, juste avant le saut qui lui mˆme vous enverra dans
            la routine de gestion ad‚quate, le chiffre de l'Entr‚e sera trop
            grand, et vous serez renvoyez … Menu_Exit sans autre forme de procŠs
            (voyez le cmpi avant Menu_Jump).
              Cependant, vu que le message est correct, le Titre reviendra en
            ‚criture normal, mais vous n'obtiendrez pas ce que vous attendiez.

Je tiens … vous donner quelques informations plus complŠtes.
L'Objet 0 du menu est une IBox, qui se trouve ˆtre le bureau en lui mˆme. C'est
grƒce … cela que DeskPic et compagnie mettent une image dans le fond, en for‡ant
le GEM … changer d'Objet 0.
L'Objet 1 est une Box avec un bord. C'est simplement la barre de menu.
L'Objet 2 est une IBox qui contient les Titres.
Notre IBox 7 contient toutes les Box r‚unissant les Entr‚es.
Voici donc l'Arborescence de notre menu :
G_IBox 0 : Bureau
 G_Box 1 : Barre de menu
  G_IBox 2 : Boite avec les Titres
   G_Title 3 : TestSSAV
   G_Title 4 : Fichier
   G_Title 5 : Affichage
   G_Title 6 : Graphisme
 G_IBox 7 : Espace de travail
  G_Box 8 : Boite du titre TestSSAV
   G_STRING 9 : A Propos De..
... Le reste est du mˆme acabit, … raison d'un G_String par Entr‚e.

Un appel … l'‚quipe de Double Click SoftWare : Mais comment faites vous donc
avec DCPOPUP pour transformer n'importe quel menu en Pop-Up hi‚rarchique?

/// AES  31 : MENU_ICHECK ///

Sert … afficher un petit  (CHR$(8)) devant une ligne d'un menu. Par exemple
pour fixer un paramŠtre (utilisation du ClipBoard dans 7UP).

ParamŠtres : LONG : Adresse du menu (Mˆme remarque que pr‚c‚demment)
             WORD : Num‚ro de l'‚l‚ment … marquer (Titre ou Entr‚e)
             WORD : Mode (0 = Efface la marque ou 1 = Affiche la marque)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 16

/// AES  32 : MENU_IENABLE ///

Sert … rendre une ligne d'un menu inactive. On ne peut plus ensuite s‚lectionner
cette ligne. Elle devient grise (comme les lignes de s‚parations dans les
menus).

ParamŠtres : LONG : Adresse du menu (Mˆme remarque que pr‚c‚demment)
             WORD : Num‚ro de l'‚l‚ment … afficher en clair
             WORD : Mode (0 = Ecrit en clair ou 1 = Ecrit en normal)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 16

/// AES  33 : MENU_TNORMAL ///

Sert … afficher une ligne d'un menu en invers‚.
  Si dans votre menu, vous avez s‚lectionn‚ une ligne, il FAUT utiliser cette
commande pour lui faire retrouver son aspect original, car le GEM ne s'en occupe
pas.
  Si vous ne le faite pas, la prochaine fois que vous d‚roulerez le menu qui
contient la ligne, celle ci sera en inverse vid‚o. C'est justement ce qu'il
arrive aux Titres, dont il faut changer l'Ob_State non pas avec OBJC_CHANGE,
mais avec cette fonction.

ParamŠtres : LONG : Adresse du menu (Mˆme remarque que pr‚c‚demment)
             WORD : Num‚ro de l'‚l‚ment … afficher en inverse vid‚o
             WORD : Mode (0 = Ecrit en inverse ou 1 = Ecrit en normal)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 16

/// AES  34 : MENU_TEXT ///

Sert … changer le texte d'un ligne d'un menu, par exemple pour indiquer le fait
qu'une fonction est active ou pas (voir MENU_ICHECK (AES 31)). Le nouveau texte
ne DOIT pas ˆtre plus long que le texte … remplacer, sinon ... BOUM.

ParamŠtres : LONG : Adresse du menu (Mˆme remarque que pr‚c‚demment)
             WORD : Num‚ro de l'‚l‚ment … changer
             LONG : Adresse du nouveau texte (Se terminant par 0, et pas plus
                    long que l'‚l‚ment actuellement affich‚, sinon...)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 18

/// AES  35 : MENU_REGISTER ///

Sert … installer le titre d'un accessoire dans le menu Bureau.
  Attention, contrairement … Menu_Bar, il ne s'agit pas ici de faire apparaŒtre
le nom des accessoires pr‚sents en m‚moire aux emplacements qui leurs sont
r‚serv‚s, mais belle et bien d'indiquer au GEM que vous voulez installer un
nouvel accessoire, dans la mesure du possible.
  Si vous obtenez r‚paration, donc que le GEM vous gratifie de la chance de
pouvoir figurer … tout moments dans la barre de menu, il vous faudra entrer dans
une boucle sans fin, et attendre le message d'ouverture AC_OPEN (Type 40). A ce
moment l…, allez dans une boucle pour g‚rer vos formulaire et fenˆtres.
  Cependant, ne r‚servez pas de m‚moire, ou alors … titre vraiment temporaire
car dans ce cas, le GEM n'inscrira pas l'appartenance du bloc m‚moire … vous,
mais … la tache actuellement en utilisation (le programme en cours, quoi). S'il
vient … disparaŒtre, les blocs m‚moires r‚serv‚s lors de son existence sont
rendus, et vous, vous plantez le systŠme, H‚, con... C'est d'ailleurs pour cela
que RSRC_LOAD ne procŠde pas de cette maniŠre, et dans ce cas, la ressource
charg‚e vous appartient v‚ritablement.

ParamŠtres : WORD : APP_ID de l'accessoire
             LONG : Adresse du titre de l'accessoire (Se terminant par 0)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Num‚ro de l'accessoire (0 … 5), -1 si il n'y a plus de place
Pile : 14

ATTENTION : Il existe un "grugeur" qui ‚tend le nombre d'accessoire … 36. Votre
            accessoire doit donc faire attention … ne pas se limiter de 0 … 5.

/// AES  36 : MENU_POPUP ///

Sert … afficher et … g‚rer un menu du type Pop-Up.
  Ne fonctionne qu'a partir de l'AES 3.4, inclus dans les TOS 4. Ces menus ont
une structure arborescente, assez difficile … mettre en oeuvre … la main, mais
grƒce au nouvel AES, "no problemo" (½ Terminator). Deux nouvelles structures
viennent ‚toffer un nombre d‚j… consid‚rable de ces tableaux de maŒtres.

> Structure Menu_Pop
  Cette structure d‚finie un menu du type PopUp.
  LONG : Adresse de l'arbre contenant le menu
  WORD : Num‚ro de l'Objet PŠre du menu. Comme vous l'avez vu, les Entr‚es d'un
         menu sont contenus dans une Box. Ici, les Entr‚e du menu PopUp DOIVENT
         ˆtres contenus dans une G-Box dont le cadre est de un pixel vers
         l'ext‚rieur, et dont le BIT Shadowed est mis. Chaque Entr‚e de ce menu
         doit ˆtre un G_String.
         En principe, dans un mˆme arbre, on peut mettre plusieurs menu PopUp,
         mais c'est foireux, alors mettez en un par arbre.
  WORD : Objet de d‚part du menu. Si c'est un menu de type hi‚rarchique, ce sera
         l'Entr‚e plac‚e tout en haut, et dans le cas d'un menu PopUp, c'est
         l'Entr‚e qui devra se trouver en face du bouton d'appel.
  WORD : Si c'est … 0, le menu est fixe, sinon les Entr‚es situ‚es entre
         l'Entr‚e dont le num‚ro d'ordre est contenu dans ce WORD, et la fin,
         peuvent scrooler car le GEM ajoute des flŠches pour pouvoir faire
         cela sans problŠmes.

> Structure Menu_Set
  Cette structure d‚finie le comportement d'un menu PopUp.
  LONG : D‚lai en milliŠme de seconde entre le moment o— la souris arrive (ou
         passe) sur une Entr‚e li‚e … un sous menu, et le moment o— celui ci
         doit s'afficher. C'est pratique car si vous passez rapidement sur les
         Entr‚e, le sous menu ne s'affiche pas imm‚diatement, et ne ralentit pas
         la gestion de la souris. 200 en une valeur normale.
  LONG : D‚lai en milliŠme de seconde entre le moment o— le sous menu … ‚t‚
         ouvert, et le moment o— il doit se fermer si la souris n'est pas pass‚e
         sur le sous menu. En principe c'est 10000 qu'il faut mettre ici, mais
         ‡a marche pas de toute maniŠre (bravo Digital Research).
  LONG : D‚lai toujours en milliŠme de seconde entre le moment o— l'on clique
         sur une flŠche de scrool, et o— celui ci scroole vraiment. 250 est un
         bon choix, bien que je pr‚fŠre 150, qui est plus dynamique.
  LONG : D‚lai, comme d'habitude, entre chaque changement de ligne. Mettez ici
         100 pour ‚viter un d‚filement trop rapide.
  WORD : Nombre d'options visualisables dans ce sous menu.

ParamŠtres : LONG : Adresse d'une Structure Menu_Pop
             WORD : X de la G_Box du menu PopUp … afficher
             WORD : Y … afficher
             LONG : Adresse de la boite … afficher
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si rien n'a ‚t‚ cliqu‚, 1 si il y a eut quelque chose
Pile : 20

/// AES  37 : MENU_ATTACH ///

Sert … lier un Objet … une Entr‚e d'un menu comme menu hi‚rarchique, ou Pop-Up.
Celui-ci sera trait‚ avec MENU_PopUp. Vous pouvez cr‚er 4 niveau de menus PopUps
(un PopUp d'un PopUp d'un PopUp d'un PopUp d'une Entr‚e).
Ne JAMAIS lier la premiŠre Entr‚e (A Propos De...) … un menu PopUp.

ParamŠtres : WORD : Mode
                    0 = Informations sur le lien actuel (ne fonctionne pas)
                    1 = Cr‚e ou modifie un lien
                    2 = D‚truit un lien
             LONG : Adresse du de l'arbre contenant le menu
             WORD : Num‚ro de l'Entr‚e
             LONG : Adresse d'une Structure Menu_Pop d‚crivant le sous menu
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Int_Out0
Pile : 22

/// AES  38 : MENU_ISTART ///

Permet de d‚finir dans un menu hi‚rarchique quelle Entr‚e sera la premiŠre du
scrool.

ParamŠtres : WORD : Mode
                    0 = Informations sur le num‚ro de l'Entr‚e du sous menu
                    1 = Fixer ou modifier ce num‚ro
             LONG : Adresse de l'arbre contenant le sous menu
             WORD : Num‚ro de l'Objet PŠre du sous menu
             WORD : Num‚ro de l'Entr‚e du sous menu … fixer au d‚part
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Int_Out0
Pile : 18

/// AES  39 : MENU_SETTING ///

Permet de changer les paramŠtres du comportement d'un sous menu.

ParamŠtres : WORD : Mode
                    0 = Informations sur les choix actuels
                    1 = Fixer ou changer ces choix
             LONG : Adresse d'une Structure Menu_Set
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Int_Out0
Pile : 16

--- LIBRAIRIE OBJETS ---

La Librairie Objet permet de travailler avec des Ressources. Celles ci
contiennent des Objets (un bouton, une boite, un texte, une ic“ne, etc...).
Voici les diff‚rentes structures des Objets, ainsi qu'une explication :

> Structure d'un Objet
  Chaque Objet en m‚moire occupe un tableau contenant toutes les informations
  pouvant le d‚crire. Chaque tableau "Struct Object" occupe 12 WORDs.
  WORD 0 : Ob_Next : Num‚ro du prochain Objet, au mˆme niveau. Ainsi, un Fils
                     pointe son FrŠre. Si c'est le dernier, il pointe le PŠre.
  WORD 1 : Ob_Head : Num‚ro du premier Objet Fils
  WORD 2 : Ob_Tail : Num‚ro du dernier Objet Fils
  WORD 3 : Ob_Type : Type de l'Objet. En voici la liste :
                     - G_BOX (Type 20) : Boite simple, avec cadre et couleur
                                         int‚rieur
                         Ob_Spec : Voir Structure Ob_Spec
                     - G_TEXT (Type 21) : Texte simple
                         Ob_Spec : Voir Structure TedInfo
                     - G_BOXTEXT (Type 22) : Texte simple avec boite simple
                         Ob_Spec : Voir Structure TedInfo
                     - G_IMAGE (Type 23) : Image, sans masque
                         Ob_Spec : Voir Structure BitBlk
                     - G_USERDEF (Type 24) : Objet Custom, … vous d'‚crire la
                                             routine graphique qui va dessiner
                                             cet Objet (bouton … la "Mac",
                                             texte en relief, ...). L'AES saute
                                             … la routine que vous lui
                                             pr‚cisez, et trace l'Objet
                                             (profitez en).
                         Ob_Spec : Voir UserBlk
                     - G_IBOX (Type 25) : Boite vide, avec cadre cependant
                         Ob_Spec : Voir Structure Ob_Spec
                     - G_BUTTON (Type 26) : Boite simple avec texte centr‚
                         Ob_Spec : Pointe le texte … afficher
                     - G_BOXCHAR (Type 27) : Une lettre dans une boite simple
                         Ob_Spec : Voir Structure Ob_Spec
                                   BIT 24 … 31 : le code ASCII du caractŠre …
                                                 afficher
                     - G_STRING (Type 28) : Texte simple
                         Ob_Spec : Pointe le texte … afficher
                     - G_FTEXT (Type 29) : Texte format‚
                         Ob_Spec : Voir Structure TedInfo
                     - G_FBOXTEXT (Type 30) : Texte format‚ dans une boite
                                              simple
                         Ob_Spec : Voir Structure TedInfo
                     - G_ICON (Type 31) : Icone avec masque
                         Ob_Spec : Voir IconBlk
                     - G_TITLE (Type 32) : Titre de menu
                         Ob_Spec : Pointe le Titre du menu
                     - G_CICON (Type 33) : Icone couleur, avec ic“ne
                                           s‚lectionn‚ et version monochrome
                         Ob_Spec : Voir Stucture CIconBlk
  WORD 4 : Ob_Flags : Masque d'Action. D‚finit les caract‚ristiques d'Actions
                      d'un Objet. Voici la signification de BITs :
                      BIT 0 : SELECTABLE : L'Objet peut ˆtre s‚lectionn‚
                      BIT 1 : DEFAULT : S‚lectionne cet Objet si l'on appuie
                                        sur RETURN
                      BIT 2 : EXIT : Termine la gestion du formulaire.
                                     N‚cessite de relƒcher le bouton.
                      BIT 3 : EDITABLE : On peut ‚diter un Champ Editable
                                         (entrer une phrase, ou un code, le tout
                                         au clavier). ATTENTION … ne pas
                                         affecter un bouton ou quoi que ce soit
                                         qui ne soit pas r‚ellement ‚ditable
                                         avec ce BIT, sinon...
                      BIT 4 : RBUTTON : Radio Button, n‚cessite d'appartenir …
                                        un PŠre commun, et d'avoir au moins un
                                        FrŠre. Un seul Radio Button ne peut ˆtre
                                        s‚lectionn‚ … la fois. Les autres se
                                        d‚s‚lectionnent automatiquement si l'ont
                                        s‚lectionne un Radio Button qui ne
                                        l'‚tait pas. Le PŠre Commun est trŠs
                                        souvent un G_IBOX (Type 25).
                      BIT 5 : LASTOB : Dernier Objet de l'Arbre. ATTENTION, sous
                                       FORM_DO, on passe d'un champ ‚ditable …
                                       l'autre avec les touches Fleche Haut ou
                                       Bas. Or FORM_DO ne v‚rifie ce BIT
                                       qu'aprŠs avoir chang‚ d'Objet. Donc si
                                       votre dernier Objet est un Champ
                                       Editable, FORM_DO passe … l'Objet
                                       suivant, et, Boum...
                      BIT 6 : TOUCHEXIT : Termine la gestion du formulaire. Il
                                          suffit que FORM_DO d‚tecte que cet
                                          Objet est s‚lectionn‚ pour quitter. En
                                          clair, mˆme pas besoin de relƒcher la
                                          touche de la souris, comme avec EXIT.
                      BIT 7 : HIDETREE : Cache un Objet, et tous ses Fils. Ils
                                         ne seront pas affich‚s avec OBJC_DRAW,
                                         et pas trouv‚s avec OBJC_FIND. Entre
                                         nous, ‚vitez ce BIT sur l'objet racine
                                         (num‚ro 0).
                      BIT 8 : INDIRECT : Ob_Spec n'est pas utilis‚ directement
                                         (comme Ob_Spec ou comme pointeur), mais
                                         pointe un LONG qui est Ob_Spec (avec
                                         BITs ou pointeur). Utilit‚e : je
                                         cherche encore...
                      BIT 9 : INDICATOR : Donne un Aspect en Relief s'il s'agit
                                          d'une boite ou d'un bouton.
                      BIT A : BACKGROUND : Donne la couleur de l'Objet PŠre …
                                           l'Objet. Ainsi, on peut cr‚er des
                                           bouton "interne" sur le Falcon, en
                                           s‚lectionnant le BIT Indicator,
                                           BackGround, et Selected du statut
                                           (voir juste aprŠs)
                      BIT B : SUBMENU : Je sais pas...
                      BITs C … F : inutilis‚s
  WORD 5 : Ob_State : Masque de Statut. D‚finit les caract‚ristiques Physique
                      d'un Objet (la tˆte qu'il aura … l'‚cran). Voici la
                      signification des BITs:
                      BIT 0 : SELECTED : Donne l'Aspet s‚lectionn‚ … l'Objet.
                      BIT 1 : CROSSED : Les boite se retrouvent avec une croix
                                        qui forme les diagonales de la boite.
                      BIT 2 : CHECKED : Marque un   dans le coin sup‚rieur
                                        gauche de l'Objet.
                      BIT 3 : DISABLED : Affiche l'Objet en gris‚, et ne peut
                                         plus ˆtre s‚lectionn‚
                      BIT 4 : OUTLINED : Les boite ont un deuxiŠme cadre
                      BIT 5 : SHADOWED : Les boites projettent une ombre dans le
                                         coin inf‚rieur droit. L'‚paisseur de
                                         cette ombre, ainsi que sont apparente
                                         distance de la boite d‚pendent de
                                         l'‚paisseur du cadre de la boite.
                      BITs 6 … F : Inutilis‚s
  LONG 6 : Ob_Spec : Sp‚cifications suivant le Type d'Objet (Voir Ob_Type)
                     Contient un champ de BITs ou un pointeur vers une
                     Structure.
  WORD 8 : Ob_X : X du coin sup‚rieur gauche (par rapport au PŠre, sachant que
                  le PŠre de la Racine n'est autre que le Bureau).
  WORD 9 : Ob_Y : Y du coin sup‚rieur gauche. Mˆmes remarques que pr‚c‚demment.
  WORD A : Ob_Width : Largeur de l'Objet
  WORD B : Ob_Height : Hauteur de l'Objet

Juste un appel … l'‚quipe de CENTEK : Vous qui ˆtes en train de programmer
Dolmen, pourquoi ne pas ajouter un G_CIMAGE de Type 34, au format IMG par
exemple? €a m'aiderait beaucoup pour la prochaine version de SSAV (une id‚e,
comme ‡a...).

> Structure Ob_Spec
  C'est un champ de BITs sur 32 BITs qui donne la couleur de l'Objet, ainsi que
  des informations sur son cadre s'il en a un.
  BIT 0 … 15 : TE_COLOR
    BIT 0 … 3 : Couleur … l'int‚rieur du cadre
    BIT 4 … 6 : Motif de remplissage. C'est une trame monochrome. A 0, il n'y
                en a pas, … 7 elle est au maximum, donc remplie.
    BIT 7 : 0 = Texte Transparent (la couleur de fond du texte est transparente
                et laisse voir ce qu'il y a dessous).
            1 = Texte Opaque (la couleur est opaque et recouvre ce qu'il se
                trouvait dessous )
    BIT 8 … 11 : Couleur du Texte
    BIT 12 … 15 : Couleur du Cadre
  BIT 16 … 23 : TE_THICKNESS
    BIT 16 : 0 = Pas de Cadre
             1 = Un cadre
    BIT 17 … 23 : Epaisseur du cadre. ATTENTION, ces 7 BITs sont sign‚s.
                  1 … 127, le cadre va vers l'int‚rieur
                  -1 … -127, le cadre va vers l'ext‚rieur
                  Ici, pour avoir un nombre correct, recopiez les 8 BITs de
                  TE_THICKNESS dans un registre, et faites :
                    ror.b           #1,Dx
                    btst.b          #6,Dx
                    BEQ             NotNeg
                    bset.b          #7,Dx
    NotNeg          ...
                  Avec un ou deux EXT, vous obtiendrez un superbe nombre sign‚.

> Structure TedInfo
  Contient tous les pointeurs et les informations pour un texte format‚
  (regardez, vous comprendrez).
  LONG 0 : TE_PTEXT : Pointeur vers le texte d'entr‚e.
                      Pour exemple, je prendrais celui du "Livre du d‚veloppeur
                      Tome 1" qui est trŠs parlant :
                      En entr‚e, TE_PTEXT pointe vers 8 espaces. TE_TXTLEN
                      (Voir plus loin) contient 8.
  LONG 2 : TE_PTMPLT : Pointeur vers le masque du texte.
                       C'est une chaŒne de caractŠre avec masque (_).
                       Ici, pour poursuivre l'exemple pr‚c‚dent, TE_PTMPLT
                       pointe vers "Veuillez entrer la date : __/__/____".
  LONG 4 : TE_PVALID : Pointeur vers le masque de validation. Suivant les
                       caractŠres contenus, le GEM interdira ou autorisera la
                       saisie d'un type ou plusieurs de caractŠres.
                       Toujours pour compl‚ter l'exemple, TE_PVALID pointe vers
                       "99999999". Ainsi, lorsque ce champs ‚ditable est
                       trait‚, l'utilisateur ne peut saisir que des chiffres,
                       qui composeront la date. A la fin du traitement,
                       TE_PTEXT pointe vers les 8 chiffres qui ont remplac‚s
                       les 8 espaces d'origine. Voici les autres masques :
                       9 = Seuls les chiffres sont pris en compte
                       A = Seuls l'espace et le lettres majuscules sont pris en
                           compte
                       a = Seuls l'espace et toutes les lettres (majuscule et
                           minuscule) sont pris en compte
                       N = Seuls l'espace, les majuscules, et les chiffres sont
                           pris en compte
                       n = Seule l'espace, les majuscules, les minuscules, et
                           les chiffres sont pris en compte
                       F = Uniquement les lettres admises dans un nom de fichier
                           valide, ainsi que les Jokers (?*). C'est … dire :
                           ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ?*
                           ATTENTION : D'autres caractŠres peuvent etres
                                       utilis‚s, mais il est pr‚f‚rable de se
                                       limiter … l'alphabet et aux chiffres.
                       P = Idem que pr‚c‚demment, mais possibilit‚ d'utiliser
                           les descripteurs de chemin (Path), sans les Jokers,
                           soit ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 \:
                       p = Idem, avec les Jokers et les descripteurs de chemins,
                           ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 \:?*
                       X = Tout pris en compte.
                         Dans la plupart des ‚diteurs de ressource, pour choisir
                       ces attributs, il faut se placer dans la ligne masque, et
                       ‚crire avec la touche Alternate enfonc‚e, plus Shift au
                       besoin. Pour les chiffres, utilisez ceux sous les touches
                       de fonctions, car le pav‚ num‚rique ne marche pas (du
                       moins sous ORCS).
  WORD 6 : TE_FONT : Taille du texte
                     3 = Taille normale
                     5 = Taille "Icones"
  WORD 7 : TE_JUNK1 : R‚serv‚
  WORD 8 : TE_JUST : Justification
                     0 = Le texte sera plac‚ … gauche
                     1 = Le texte sera plac‚ … droite
                     2 = Le texte sera centr‚. TrŠs courant pour les boutons.
  WORD 9 : TE_COLOR : Couleur de la boite (0 … 15)
  WORD A : TE_JUNK2 : R‚serv‚
  WORD B : TE_THICKNESS : Epaisseur du cadre. Sign‚
                          0 = Pas de cadre
                          1 … 128 = Cadre vers l'int‚rieur
                          -1 … -127 = Cadre vers l'ext‚rieur
  WORD C : TE_TXTLEN : Longueur du texte point‚ par TE_PTEXT
  WORD D : TE_TMPLEN : Longueur du texte point‚ par TE_PTMPLT

> Structure BitBlk
  Descripteur d'une image sur 6 WORDs.
  LONG 0 : BI_PDATA : Pointeur vers l'image monochrome
  WORD 2 : BI_WB : Largeur en OCTETs de l'image (donc multiple de 8
                   obligatoirement)
  WORD 3 : BI_HL : Hauteur de l'image en points cette fois
  WORD 4 : BI_X : X par rapport au PŠre
  WORD 5 : BI_Y : Y par rapport au PŠre
  WORD 6 : BI_COLOR : Couleur de l'image (les BITs … 1). L'image est
                      transparente, donc les BITs … 0 laissent voir le PŠre

> Structure UserBlk
  Tableau de 2 LONGs contenant les informations pour l'ex‚cution de votre
  routine par l'AES.
  LONG 0 : UB_CODE : Pointeur vers votre routine. Il est hors de question de
                     s'aider de l'AES pour dessiner. Mais le VDI, le GEMDOS, le
                     BIOS, l'XBIOS et les autres sont exploitables.
  LONG 1 : UB_PARM : Votre paramŠtres sur 32 BITs. Celui-ci sera plac‚ dans une
                     Structure au nom de Param, dont l'adresse sera Empil‚e
                     avant l'appel de votre routine.

> Structure ParamBlk
  Descripteur contenant toutes les informations pour que la routine puisse
  correctement afficher votre dessin … l'‚cran, sur 15 WORDs.
  LONG 0 : PB_TREE : Adresse de l'arbre contenant l'Objet "Custom"
  WORD 2 : PB_OBJ : Num‚ro de l'Objet ("Custom") qui … provoqu‚ cette demande
                    d'affichage
  WORD 3 : PB_PREVSTATE : Ancien OB_STATE
  WORD 4 : PB_CURRSTATE : OB_STATE actuel. Si PB_PREVSTATE et PB_CURRSTATE sont
                          identiques, c'est que l'objet en question doit ˆtre
                          trac‚, dont l'affichage a ‚t‚ d‚clench‚ par
                          OBJC_Draw. S'ils sont diff‚rent, c'est qu'il n'y a
                          qu'une demande de rafraŒchissement avec OBJC_Change.
  WORD 5 : PB_X : X de l'Objet … l'‚cran (et pas par rapport au PŠre)
  WORD 6 : PB_Y : Y de l'Objet … l'‚cran
  WORD 7 : PB_W : Largeur de l'Objet en points
  WORD 8 : PB_H : Hauteur de l'Objet en points
  WORD 9 : PB_XC : X du CLIPPING
  WORD A : PB_YC : Y du CLIPPING
  WORD B : PB_WC : Largeur du CLIPPING
  WORD C : PB_HC : Hauteur du CLIPPING
  LONG E : PB_PARAM : Votre paramŠtre pr‚c‚demment contenu dans UB_PARM.

> Structure IconBlk
  Descripteur d'un ic“ne monochrome sur 17 WORDs.
  LONG 0 : IB_PMASK : Pointeur vers le Masque. Celui-ci DOIT ˆtre compos‚ de
                      WORDs car sa largeur ne peut ˆtre qu'un multiple de 16
  LONG 2 : IB_PDATA : Idem, mais pour l'image
  LONG 4 : IB_PTEXT : Pointe vers une chaŒne de caractŠres qui formera le texte
                      de l'ic“ne
  WORD 6 : IB_CHAR : CaractŠre de l'ic“ne. Par exemple le Nom de l'unit‚ pour
                     l'ic“ne d'un lecteur
  WORD 7 : IB_XCHAR : X du caractŠre par rapport … l'ic“ne
  WORD 8 : IB_YCHAR : Y du caractŠre par rapport … l'ic“ne
  WORD 9 : IB_XICON : X de l'ic“ne par rapport au PŠre
  WORD A : IB_YICON : Y de l'ic“ne par rapport au PŠre
  WORD B : IB_WICON : Largeur de l'ic“ne en points (mais multiple de 16 car les
                      donn‚es sont compos‚es de WORDs)
  WORD C : IB_HICON : Hauteur de l'ic“ne en points
  WORD D : IB_XTEXT : X du texte par rapport … l'ic“ne
  WORD E : IB_YTEXT : Y du texte par rapport … l'ic“ne
  WORD F : IB_WTEXT : Largeur du texte en points
  WORD 10 : IB_HTEXT : Hauteur du texte en points
  WORD 11 : IB_RESVD : R‚serv‚

> Structure CIconBlk
  Descripteur d'un ic“ne couleur. Il comprend le descripteur IconBlk, plus des
  descripteur pour chaque r‚solutions.
  IconBlk : Descripteur de l'ic“ne monochrome sur 17 WORDs.
  CIcionPtr : Pointeur vers un premier descripteur CIconBlk :

  CIconBlk : WORD 0 : NUM_PLANES : Nombre de plans de l'ic“ne (4 pour 16
                                   couleurs, 8 pour 256 couleurs, 16 pour NTC)
             LONG 2 : COL_DATA : Pointeur vers les donn‚es de l'ic“ne … l'‚tat
                                 Normal, cela au format RASTER (comme l'‚cran,
                                 avec ce fichus entrelacement de plan vid‚o)
             LONG 4 : COL_MASK : Pointeur vers le Masque de l'ic“ne Normal. Le
                                 masque est en monochrome (1 BIT = 1 point)
             LONG 6 : SEL_DATA : Pointeur vers les donn‚es de l'ic“ne
                                 S‚lectionn‚. Voir COL_DATA
             LONG 8 : SEL_MASK : Pointeur vers le Masque de l'ic“ne
                                 S‚lectionn‚. Voir COL_MASK
             LONG A : NEXT_RES : Pointeur vers un autre descripteur CIconBlk,
                                 d‚crivant une autre r‚solution.
                                 Si ce pointeur est … 0, cela signifie qu'il
                                 n'y a plus d'autres r‚solutions pour cet
                                 ic“ne.

/// AES  40 : OBJC_ADD ///

Sert … additionner un Objet … l'arborescence.
  Pour cr‚er un nouvel objet ne d‚pendant d'aucun autre, il suffit de pr‚ciser
comme Objet pŠre 0, la base de l'arborescence (en g‚n‚ral la boite de dialogue
qui contient les diff‚rents Objets). On peut aussi attribuer un nouveau fils …
un pŠre d‚j… existant. L'Objet est ajout‚ en fin d'arborescence, et seul les
pointeurs son chang‚s.

ParamŠtres : LONG : Adresse de l'arborescence (Voir MENU_BAR (AES 30))
             WORD : Num‚ro de l'objet pŠre
             WORD : Num‚ro de l'objet fils
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 16

/// AES  41 : OBJC_DELETE ///

Sert … effacer un objet de l'arborescence. Comme ‡a, carr‚ment.
Mais trŠs logiquement, vous devez vous en douter, efface aussi ses fils (si
l'Objet en a).

ParamŠtres : LONG : Adresse de l'arborescence (Mˆme remarque que pr‚c‚demment)
             WORD : Num‚ro de l'objet … effacer
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 14

/// AES  42 : OBJC_DRAW ///

Sert … dessiner un objet et ses fistons … l'‚cran.
  Un CLIPPING est enregistr‚ (Voir VDI 129). C'est seulement dans ce rectangle
que l'objet sera dessin‚, et c'est seulement lui qui sera effac‚ de l'‚cran
aprŠs r‚ception du message ReDraw du GEM (Voir EVNT_MESAG (AES 23), message de
Type 20 (WM_REDRAW)).
  Cette fonction d‚clenche aussi l'affichage des Objets "Customs" (pr‚cision …
pr‚ciser car y'a quelque chose de sp‚cial qui se produit pour les Objets Customs
suivant la fonction utilis‚e pour les afficher).

ParamŠtres : LONG : Adresse de l'arborescence (...)
             WORD : Num‚ro de l'objet de d‚part (0 pour dessiner toute
                    l'arborescence)
             WORD : Niveau maximum dans l'arborescence … dessiner. Peut ˆtre
                    sup‚rieur au niveau maximum sans que cela ne pose le
                    moindre problŠme, histoire d'ˆtre certain du bon affichage
                    du formulaire
             WORD : Coordonn‚e X du coin sup‚rieur gauche du CLIPPING
             WORD : Coordonn‚e Y du coin sup‚rieur droit du CLIPPING
             WORD : Largeur du CLIPPING
             WORD : Hauteur du CLIPPING
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 24

/// AES  43 : OBJC_FIND ///

Permet de connaŒtre exactement le num‚ro de l'objet sous la souris.

ParamŠtres : LONG : Adresse de l'arborescence (...)
             WORD : Num‚ro de l'objet de d‚part (0, c'est la racine)
             WORD : Niveau maximum dans l'arborescence … chercher
             WORD : Coordonn‚e X d'un point (par exemple les coordonn‚es de la
                    souris) sous lequel se trouve l'objet … chercher
             WORD : Coordonn‚e Y de ce point
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Num‚ro de l'Objet, sinon -1 si l'Object n'existe pas, ou ne se
                trouve pas dans l'espace de recherche
Pile : 20

/// AES  44 : OBJC_OFFSET ///

Permet de connaŒtre pr‚cis‚ment la position d'un objet (coin sup‚rieur gauche)
… l'‚cran.

ParamŠtres : LONG : Adresse de l'arborescence (...)
             WORD : Num‚ro de l'objet dont on cherche les coordonn‚es
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.l = 0 si erreur, sinon Coordonn‚e X.w et Y.w du coin sup‚rieur
                gauche de l'objet
Pile : 14

/// AES  45 : OBJC_ORDER ///

Permet de changer l'ordre des fils d'un Objet pŠre. Cette fonction doit parfois
ˆtre appel‚e plusieurs fois de suite pour obtenir un classement correct.
Ce serait sympa de m'aider ici, car toutes les documentations que je possŠde ont
une description diff‚rentes entres elles, et je ne peut h‚las garantir
l'exactitude de mes propos... (ce serait rageant de vous induire en erreur)

ParamŠtres : LONG : Adresse de l'arborescence (...)
             WORD : Num‚ro de l'Objet dont on veut changer de position dans la
                    liste des fils appartenant … un Objet pŠre
             WORD : Nouvelle position (-1 = Premier de la liste
                                        0 = Dernier de la liste
                                        1 = Avant dernier de la liste
                                        2 = Avant avant dernier de la liste)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 16

/// AES  46 : OBJC_EDIT ///

Sert … changer le texte d'un Objet ayant le type G_TEXT ou G_BOXTEXT, ou …
saisir un texte dans ce type d'Objet.
Comme MENU_TEXT (AES 34), il est hors de question que le nouveau texte soit plus
long que le pr‚c‚dent. Je vous fait pas de dessin s'il vous arrivait ce cas de
figure, le GEM s'en chargera d‚j… avec zŠle...

ParamŠtres : LONG : Adresse de l'arborescence (...)
             WORD : Num‚ro de l'Objet dont le texte est … modifier
             WORD : CaractŠre utilisateur
             WORD : Position de d‚part
             WORD : Fonction (0 = R‚serv‚
                              1 = ED_INIT : Affiche TE_PTEXT (Voit TedInfo) via
                                            TE_PTMPLT, donc en tenant compte du
                                            masque, et avec le curseur
                              2 = ED_CHAR : Controle de validit‚ du caractŠre
                                            d'aprŠs TE_PVALID, le place au bon
                                            endroit dans TE_PTEXT, puis retrace
                                            TE_PTEXT avec ce nouveau locataire
                              3 = ED_END : Efface le curseur)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon nouvelle position du curseur
Pile : 20

/// AES  47 : OBJC_CHANGE ///

Sert … changer le statut d'un Objet (OB_STATE). Vous pouvez demander qu'il soit
r‚affich‚ avec ses nouveau attributs, ou remettre cette op‚ration pour la
prochaine fois.
Pour les ‚l‚ments du menu, voyez la section … ce sujet.

ParamŠtres : LONG : Adresse de l'arborescence (...)
             WORD : Num‚ro de l'Objet … modifier
             WORD : Coordonn‚e X du CLIPPING
             WORD : Coordonn‚e Y du CLIPPING
             WORD : Largeur du CLIPPING
             WORD : Hauteur du CLIPPING
             WORD : Nouvel ‚tat
             WORD : Mode (0 = Ne re dessine pas ou 1 = Redessine l'objet)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 28

/// AES  48 : OBJC_SYSVAR ///

(Pas document‚, mais implant‚)

ParamŠtres : WORD : Mode
             WORD : Combinaison
             WORD : Donn‚es1
             WORD : Donn‚es2
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Int_Out0
Pile : 16

/// (AES  49 X : OBJC_SEARCH, en cours de d‚veloppement) ///

Une routine pour rechercher un Objet de fa‡on v‚ritablement pr‚cise.
Permet de remplacer partiellement les lacunes de RSRC_GADDR.

--- LIBRAIRIE FORM ---

/// AES  50 : FORM_DO ///

Sert … g‚rer un formulaire.
Inconv‚nient majeur, tout autre traitement est rendu impossible (passer … un
autre formulaire).
C'est pour ‡a qu'il y a SSX2FORM_DO, une version am‚lior‚e de XFORM_DO de Maitre
ATTARD (auteur justement de BIG, bibliothŠque ‚volu‚e pour C sur la chose).

ParamŠtres : LONG : Adresse de l'arborescence … g‚rer (...)
             WORD : Num‚ro de l'Objet "champ ‚ditable" … g‚rer, sinon -1
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Num‚ro de l'Objet qui … fait quitter le processus de gestion
Pile : 14

REMARQUE : Vous voyez, y'a que 8 lignes … ‚crire pour demander au GEM de g‚rer
           son formulaire. Alors o— se trouve la difficult‚?

/// AES  51 : FORM_DIAL ///

C'est une fonction trŠs utile qui permet de faire un CLIPPING (mais ne tremblez
donc pas, allez lire ce que j'en dis dans le VDI), de restaurer une partie de
l'‚cran, et de faire des animations inutiles.
  Cette fonction, en dehors des commandes inutiles, doit jouer (car la simple
figuration est superflue) dans votre programme, et ˆtre pr‚sente … l'ouverture
et … la fermeture d'un formulaire ou d'une fenˆtre. Dans le cas d'un formulaire,
mettez 0 dans les 4 premiers paramŠtres concernant les coordonn‚es (X, Y,
largeur et hauteur au d‚part).
  Une derniŠre chose, pensez toujours … effacer tout ce qui se trouve … l'‚cran,
et que vous y avez mis, car sous MultiTOS, vu que l'on est sous le bureau en
permanence, celui ci n'est pas rafraŒchit … la sortie de votre programme, et il
risque de s'y trouver des r‚sidus de formulaire. Regardez au d‚but de TestSSAV,
le passage par Clr_Before_Quit, pour effacer le premier formulaire. Tachez de ne
pas oublier... De toute maniŠre, effacez tout ce que vous dessinez, c'est plus
propre.

ParamŠtres : WORD : Mode (0 = FMD_START : R‚serve une partie de l'‚cran
                                          (CLIPPING)
                          1 = FMD_GROW : N'est autre que GRAF_GROWBOX (AES 73)
                          2 = FMD_SHRINK : N'est autre que GRAF_SHRINKBOX
                                           (AES 74)
                          3 = FMD_FINISH : LibŠre le CLIPPING, mais … vous de le
                                           redessiner)
             WORD : Coordonn‚e X du CLIPPING ou de la boite de d‚part
             WORD : Coordonn‚e Y du CLIPPING ou de la boite de d‚part
             WORD : Largeur du CLIPPING ou de la boite de d‚part
             WORD : Hauteur du CLIPPING ou de la boite de d‚part
             WORD : Coordonn‚e X de la boite de fin
             WORD : Coordonn‚e Y de la boite de fin
             WORD : Largeur de la boite de fin
             WORD : Hauteur de la boite de fin
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 26

/// AES  52 : FORM_ALERT ///

Permet de g‚rer le plus simplement du monde une boite  d'alerte, sans passer par
FORM_DO avec une arborescence sur les bras.
  TrŠs pratique lorsqu'il s'agit d'avertir notre amis l'utilisateur qu'il serait
temps d'enregistrer son travail et de s'occuper de ses enfants ou de sont
chiens, qui attend patiemment devant la porte avec la laisse entre ses crocs.

ParamŠtres : WORD : Num‚ro du bouton par d‚faut (0 = Pas de bouton par d‚faut
                                                 1 = Premier bouton
                                                 2 = DeuxiŠme bouton
                                                 3 = TroisiŠme bouton)
             LONG : Adresse de la chaŒne de message
                    Structure du message : Il est compos‚ de trois parties
                      Partie 1 : L'icone (0 = Pas d'ic“ne
                                          1 = Point d'exclamation
                                          2 = Point d'interrogation
                                          3 = STOP)
                      Partie 2 : Le texte : 5 lignes de 30 caractŠres
                      Partie 3 : Le ou les boutons
                      Chaque partie se situe entre deux crochets, et la barre
                      verticale CHR$(124) s‚pare les ‚l‚ments d'une mˆme partie
                      Ex : [3][Ceci est un test|de boite d'Alerte][Oui|Non]
                           affiche une boite d'alerte avec un ic“ne STOP, deux
                           lignes de texte, et deux boutons.
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Num‚ro du bouton cliqu‚
Pile : 14

/// AES  53 : FORM_ERROR ///

Sert … afficher rapidement une boite d'erreur correspondant … un code d'erreur
du GEM.
  Ainsi, si vous venez de recevoir ce code, offrez le gracieusement …
l'utilisateur via cette fonction pour lui signaler sont erreur.

Voici les codes d'erreurs et les textes affich‚s :
Code 2, 3, 18 : "Cette application ne peut pas trouver l'objet auquel vous
                 essayez d'acc‚der."
Code 4 : "Cette application n'a pas suffisamment de place pour ouvrir un autre
          document. Fermez un document que vous n'utilisez pas."
Code 5 : "Un objet ayant ce nom existe d‚j…, ou bien il n'autorise pas
          l'‚criture."
Code 8, 10, 11 : "M‚moire insuffisante pour l'application en cours."
Code 15 : "Le lecteur sp‚cifi‚ n'existe pas."
Les autres Code : "Erreur TOS #n", avec n le code de l'erreur

ParamŠtres : WORD : Num‚ro de l'erreur a simuler
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Num‚ro du bouton cliqu‚
Pile : 10

/// AES  54 : FORM_CENTER ///

Permet d'obtenir la position centr‚e d'un arbre.
A utiliser absolument avant le premier traitement avec FORM_DIAL ou OBJC_DRAW.
  AprŠs, une fois trac‚ et d‚plac‚, utilisez des variables pour retracer l'arbre
… des positions d‚finis par l'utilisateur. Les coordonn‚es renvoy‚es sont utiles
pour le CLIPPING, sans plus, car FORM_CENTER change les coordonn‚es de l'Objet
PŠre (le premier Objet qu'il trouve en principe), qui sera centr‚ par la suite.

ParamŠtres : LONG : Adresse de l'arborescence (...)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.l = Pointeur sur un tableau contenant les coordonn‚es de l'objet
                une fois centr‚ … l'‚cran
                Structure du tableau : WORD 0 : Coordonn‚e X
                                       WORD 1 : Coordonn‚e Y
                                       WORD 2 : Largeur
                                       WORD 3 : Hauteur
Pile : 12

/// AES  55 : FORM_KEYBD ///

(Pas document‚, mais implant‚)

ParamŠtres : LONG : Adresse
             WORD : Objet PŠre
             WORD : Objet Fils
             WORD : CaractŠre
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Int_Out0
Pile : 18

/// AES  56 : FORM_BUTTON ///

(Pas document‚, mais implant‚)

ParamŠtres : LONG : Adresse
             WORD : Objet
             WORD : Nombre
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Int_Out0
Pile : 16

/// (AES  57 X : SSX2FORM_DO V1.00, en cours de d‚veloppement) ///

  Sert … g‚rer de fa‡on normalis‚e et ‚tendue un arbre.
Cette routine se base sur XForm_Do que Mr ATTARD, et apporte quelques nombreux
suppl‚ments.
  Cette routine est une macro routine … commandes, qui n'a en fait plus rien …
voir avec Form_Do, ou avec XForm_Do (enfin un peu, mais tiens plut“t de
FlyDial).
  Par exemple, vous n'avez plus le droit de vous occuper de votre formulaire,
c'est SSX2Form_Do qui fait tout. C'est int‚ressant pour le d‚butant, ou pour
faire rapidement une application ne n‚cessitant pas trop d'exigence. Autrement,
il ne vous reste plus qu'a tout g‚rer … la main. Mais le GEM ‚tant ce qu'il est,
ce n'est pas difficile, juste long (voire trŠs...).
  Cette fonction me demandera beaucoup de temps pour la finir, alors patience.

/// (AES  58 X : SSFORM_PROCESS V1.00, en cours de d‚veloppement) ///

  Permet de laisser le contr“le de l'interface … une sorte d'interpr‚teur Basic
orient‚ interface.
  Cette routine joue le r“le de processeur d'interface. Il s'agit de lui
indiquer simplement l'adresse du chemin d'un processus, de le lier … un arbre,
et de laisser celui ci se faire g‚rer tranquillement.
  S'il reste toujours la mission au programmeur d'indiquer comment sera trait‚
son interface, il peut ici prendre son pied en ‚conomisant un temps trŠs
pr‚cieux (surtout prochainement, avec Incroyable!).
  Cependant, SSFORM_PROCESS diminue le potentiel du GEM car ne permet plus
certaines fonctions rarement misent en oeuvre. Mais rien ne vous empˆche de le
g‚rer directement en assembleur. Youpi...

ATTENTION : SSForm_Process utilise SSX2Form_Do, donc l… non plus, ne vous
            attendez pas … r‚volutionner l'interfacage GEM.

/// AES  59 X : SSFORM_SOUND V1.08 ///

Sert … associer manuellement un son … un ‚v‚nement.
Ce son DOIT ˆtre (pour l'instant) au format PRW, c'est … dire 8 BITs mono …
25KHz, et compress‚ avec ICE Packer V2.2. Sur un Falcon030, le temps de
d‚compression avoisine celui de l'ouverture d'une GROW_BOW. Donc au lieu de
perdre du temps … une animation graphique inutile, pr‚f‚rez une animation
sonore, ‡a adoucit les moeurs.

REMARQUE : C'est tout … fait praticable … partir de 16 MHz avec le cache, mais
           en de‡… (8 MHz sans cache), c'est absolument immonde (3 … 4 secondes
           d'attente par sample). Essayez TestSSAV en 256 couleurs … 8 MHz sans
           cache, puis en ST Haute … 16 MHz avec, vous serrez scotch‚ par la
           diff‚rence (et encore, je n'ai pas cherch‚ … optimiser la routine de
           d‚compression (car je tiens … la porter sur ST, quoique vu sa
           vitesse d'ex‚cution, ce n'est peut ˆtre pas une bonne id‚e)).

ParamŠtres : LONG : Adresse du nom du fichier PRW … jouer (DOIT se trouver dans
                    le r‚pertoire COURANT, donc faire attention lorsque vous
                    changez de r‚pertoire avec un FileSelect (AES 90) ou autre)
                    (utilisation de D_GetPath (GEMDOS 71) pour d‚finir le
                    chemin des samples). Voyez la remarque … la fin de la
                    description de cette fonction.
                    Ce paramŠtre peut ˆtre omis si vous demandez d'arrˆter
                    pr‚matur‚ment la lecture du sample.
             WORD : R‚serv‚
             WORD : R‚serv‚
             WORD : Mode de lecture
                    0 = Arrˆt
                        Utile si vous faite une lecture en boucle
                    1 = Lecture une fois
                    2 = D‚sinstalle le sample en m‚moire
                        A faire IMPERATIVEMENT avant de sortir, vu qu'il reste
                        toujours le dernier sample jou‚ en m‚moire afin d'‚vit‚
                        un Bug bien connu de Stabylo/Removers (PRAWPLAY).
                        Vu que SSForm_Sound n'a pas besoin de l'AES ou du VDI,
                        vous pouvez l'appeler aprŠs Appl_Exit (voyez
                        TestSSAV).
                    3 = Lecture en boucle
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si OK, -1 si erreur.
Pile : 18 (ou 10)

REMARQUE : Si vous n'avez pas besoin du ClipBoard, vous pouvez red‚finir le
           chemin du ClipBoard comme ‚tant le chemin o— se trouve tous vos
           ‚chantillons, comme cela, un simple SCRP_READ vous permettra de
           savoir o— ils se trouvent, mˆme au cas o— vous ayez chang‚ de
           r‚pertoire courant. Il suffit ensuite de red‚finir le r‚pertoire
           courant pour que la fonction fonctionne correctement.

ATTENTION : A partir de la prochaine version, un fichier de configuration fera
            son apparition, et vous n'aurez donc plus … vous en soucier (y'aura
            mˆme pas de lignes … changer dans votre programme).

ATTENTION : Il arrive que le son ne soit plus correctement ger‚ pour une raison
            inconnue aprŠs le passage dans "Super Sample Player" (SUPERSAM). Le
            son devient lent, et semble etre jou‚ en 12KHz, alors que SSAV
            initialise le circuit DMA en 25KHz. Y'a t'il quelqu'un dans la
            salle qui puisse me r‚pondre?

ATTENTION : Il arrive qu'… la derniŠre lecture, aprŠs avoir lib‚r‚ le buffer
            comme je vous le demande (c'est vraiment trŠs important, croyez
            moi), le son soit jou‚ avec un bruit. Cela arrive parfois lorsque
            l'on quite TestSSAV. La pr‚c‚dente version de cette fonction ne
            faisait mˆme pas attention aux samples, et ceux ci ‚tait
            horriblement trait‚s. En fait, aprŠs avoir lib‚r‚ le sample, il se
            peut que le circuit DMA soit encore en train de lire les donn‚es.
            Or pour le systeme, la m‚moire est consid‚r‚e comme libre, et une
            nouvelle application peut r‚server la m‚moire fraichement lib‚r‚e
            et y mettre ses donn‚es sans que l'on puisse lui en vouloir, car on
            le lui permet. C'est alors que le gentil circuit DMA, qui continu
            sagement … traiter les donn‚es prend ce que la nouvelle application
            lui glisse sous le nez, et cela ne correspond pas forcement …
            quelque chose d'harmonieux.
              Lorsque l'on quitte TestSSAV, le bureau s'approprie imm‚diatement
            quelques Ko (une vingtaine environ) pour charger la
            DTA, et pouvoir ouvrir la fenˆtre du r‚pertoire courant. Sur ces
            vingt Ko, une petit partie peut se trouver sur le sample qui
            termine d'ˆtre jouer, et il peut finir avec un petit Bip qui ne
            correspond en rien au joli tintement de WinDaube que j'ai mis l….
            Merci … Stabylo/Removers pour sa piste de recherche...

ATTENTION : SSAVCALL est une routine convocable par un JSR, donc en fait, tout
            ce qui est r‚serv‚ comme m‚moire sous votre programme, ainsi que
            lors d'une fonction de SSAVCALL, vous appartient. Conclusion, le
            dernier sample charg‚ disparaŒtra … la sortie de votre programme.
            Cependant il y a un pointeur dans la fonction SSForm_Sound qu'il
            faut remettre … 0 avant de partir, pour qu'un prochain programme ne
            plante pas SSAVCALL. C'est pour cela qu'il faut IMPERATIVEMENT
            d‚sinstaller le sample r‚siduel avec la commande appropri‚e...

REMARQUE : Vu que les samples sont compact‚s, il faut les d‚compacter. €a,
           c'est pas votre boulot, c'est SSForm_Sound qui s'en occupe.
             Cependant, lors du d‚bugguage, vous risquer de vous mordre le bout
           des doigts. En effet, vu le temps de d‚compression en mode
           Run/Util PC=, vous devez souvent attendre 2 … 3 minutes … chaque
           d‚compression. Le mieux est donc de mettre un BreakPoint aprŠs la
           fonction SSForm_Sound, et de lancer l'ex‚cution … vitesse optimale
           (Ctrl-R).

--- LIBRAIRIE DE CONVERSIONS ---

ATTENTION, ces routines n'existent pas dans le jeu original de Digital
Research, mais est une nouvelle bibliothŠque que je suis en train d'‚toffer.
Vous l'aurez compris, il s'agit d'une bibliothŠque ayant une relation avec tout
ce qui concerne les conversions.

/// AES  60 X : CONV_DISPNUM V1.17 ///

Sert … convertir un nombre ASCII en binaire, dans n'importe quel format.
L'inverse est bien ‚videment possible, pour pouvoir afficher … l'‚cran par
exemple le tierc‚ du lendemain.
Je crois que c'est l'une des fonctions majeures qui manque aux utilisateurs de
l'assembleur pour pouvoir dialoguer correctement avec le monde ext‚rieur. La
voici donc offerte sur un plateau d'argent.
Voici la liste des codes d'erreur, au cas o— la routine serait tomb‚e sur un os
lors de la conversion : -1 = Echec g‚n‚ral.
                             Arrive par exemple si vous tentez de
                             convertir un nombre dans le mˆme format (quelle
                             id‚e tout de mˆme).
                        -2 = Le nombre … convertir n'est pas au bon format.
                             Arrive si la routine trouve un K dans un nombre que
                             vous lui aviez signal‚ comme ‚tant hexad‚cimale, ou
                             dans le genre.
                        -3 = Le nombre … convertir est trop grand.
                             En principe lorsque l'on cherche … convertir un
                             Flottant Etendu trop grand en Simple, qui n'a pas
                             assez de place pour acceuillir le nombre.
                             Dans le cas g‚n‚ral, survient lorsque la valeur du
                             nombre … convertir est trop grande pour tenir dans
                             la limite mat‚rielle du nombre destination
                             (essayez d'‚crire 28456 en OCTET).
                        -4 = Pas assez de place pour convertir le nombre.
                             Pr‚voyez plus large, car la routine n'‚crit que
                             dans de la m‚moire blanche comme neige. C'est
                             utile, car ‡a permet de ne pas ‚craser des donn‚es
                             importantes.

ATTENTION : Il se peut que lors d'une utilisation en multitƒche, et que cette
            routine soit utilis‚e en mˆme temps par plusieurs tƒches, il
            intervienne un t‚lescopage magistral, car la routine ne sauvegarde
            pas ses buffers de travail.
              Ces buffers sont situ‚s … la fin de la routine et lui permettent
            d'ˆtre la plus autonome possible, afin de vous ‚viter d'avoir
            encore plus de paramŠtres … entrer, et pour que la programmation
            soit la plus transparente possible.
              Si jamais cela devait arriver, ne balancez pas votre
            ATARI-MEDUSA-CENTEK-EAGLE-GEMULATOR dans l'‚cran, ils n'y peuvent
            rien, c'est de ma faute, j'essaye de vous simplifier la vie...

Pour finir, je vais vous informer sur les diff‚rents formats que cette routine
peut rencontrer. Ces informations n'ont jamais ‚t‚s jusque l… diffus‚es avec
autant de pr‚cision. Alors profitez en et b‚nissez le ciel de ma grande cl‚mence
(encore que c'est justement parce qu'il manque de logiciel que j'essaye de vous
aider, et moi de me produire des documents fiables, mais c'est une autre
histoire).

> Type Binaire, BYTE non sign‚
  L…, ma foi, les types binaire, non sign‚, c'est pas dur, mais bon, allons y.
    Un BYTE, ou OCTET in French, est un ensemble de huit BITs dont celui de
  poids faible est repr‚sent‚ le plus … droite, et celui de poids fort … gauche.
  Le BIT de poids faible dans un entier, car on parle d'entier ici
  (impossibilit‚ de repr‚senter une virgule et ce qui suit), … une "force" de 1.
  Si ce BIT est … 1, il vaut 1.
    Le suivant … une "force" de deux fois la pr‚c‚dente. Le BIT suivant vaut
  donc deux. S'il est … un, il vaut deux. Pour faire trois, il suffit donc de
  mettre le premier BIT … 1, et le suivant aussi. Cela nous donne donc 1+2=3.
  Cette force est d‚termin‚e par la position du BIT dans l'ensemble. Le premier
  BIT, s'il est … un, vaut 2^0=1. C'est pour cela que le premier BIT … le num‚ro
  0.
    Z‚ro n'est pas rien en informatique, il repr‚sente pas de courant, on a un
  BIT non mis … 1, non positionn‚. Le BIT suivant … donc la position 1, et en
  effet, il vaut 2^1=2 s'il est mis. 2^ repr‚sente l'ampleur du choix que l'on
  peut faire. Avec l'alphabet, et cinq lettres, on peut faire 26^5 mots. Ici,
  entre un BIT mis ou non, il y a deux choix. C'est comme une combinaison
  d'interrupteurs, allum‚s ou non.
    Non sign‚ signifie que si les BIT (7 … 0) forment %11111111, le nombre
  obtenu vaut 255 (2^7+2^6+2^5+2^4+2^3+2^2+2^1+2^0). Il y a donc 256
  combinaisons possibles (avec 0).

> Type Binaire, BYTE sign‚
  Idem que pr‚c‚demment, mais le nombre vaut -127 si tous les BITs sont … 1. Il
  n'y a pas de triche, mais c'est un format qui permet au processeur de
  travailler avec des nombres n‚gatifs. De 0 … 127, les combinaisons de BITs
  sont les mˆmes.
    -1 est repr‚sent‚ par %11111111 (00000000-1).
    -2, c'est %11111110. Etc...
  Pour faire un nombre n‚gatif (sign‚) … la main, prennez la valeur absolue
  (positive) du nombre, enlevez 1, et inversez le tout. Comme exemple, je
  prend 2, qui est %00000010. Moins un ‡a donne %00000001. Un NOT sur la chose,
  et l'on obtient %11111110.
    Sign‚ vient du fait que l'on peut rapidement savoir si un nombre est n‚gatif
  si son BIT fort (le plus … gauche) est … 1. Vu que les nombres de -1 … -128
  sont repr‚sent‚s par les mˆmes combinaisons binaires que les nombres de 128 …
  255 en non sign‚, le BIT 7 est ici … 1 (2^7=128).
    Mais tout d‚pend comment vous d‚cidez de traiter le nombre, en sign‚ ou en
  non sign‚. Il n'y a aucune diff‚rence entre ces combinaisons, tout est moral
  (car physiquement -1(U)=255(S)), et dans l'art et la maniŠre de les exploiter.

> Type Binaire, WORD non sign‚
  Idem que BYTE non sign‚, mais sur 16 BITs

> Type Binaire, WORD sign‚
  Idem que BYTE sign‚, mais sur 16 BITs

> Type Binaire, LONG non sign‚
  Idem que BYTE non sign‚, mais sur 32 BITs
  L'OCTET le plus … gauche forme l'OCTET fort (les BITS 24 … 31), et celui …
  droite l'OCTET faible (les BITs 0 … 7). Le LONG est aussi "compos‚" dans le
  jargon du WORD fort (les BITs 16 … 31), et du WORD faible (les BITs 0 … 15).

> Type Binaire, LONG sign‚
  Idem que BYTE sign‚, mais sur 32 BITs
  Structure identique que LONG non sign‚, sauf que ce LONG peut repr‚sent‚ des
  nombres n‚gatifs.

> Type Flottant, SINGLE Precision (4 OCTETs)
  Les flottants sont une combinaison astucieuse de BITs permettant d'obtenir
  des nombres … virgules. Il existe trois formats d'‚criture d'un flottant :
   - L'‚criture Normalis‚e
   - L'‚criture NON Normalis‚e, au cas o— le nombre est trop petit
   - L'‚criture Exceptionnelle, comme l'infini ou les nombres ind‚terminables.
  Voici tout d'abord la description des diff‚rents BITs :
  BIT 31 : BIT de Signe. Si ce BIT est … un, le nombre est n‚gatif
           ATTENTION : Un flottant est n‚gatif si ce BIT est … un, et non pas
           s'il … subit un compl‚ment de deux (inversion et +1).
  BITs 30 … 23 : Exposant "brut". Il est compris entre 0 et 255. Mais ces
                 limites ont des fonctions sp‚ciales.
                   Pour obtenir l'exposant "net", il faut prendre la valeur du
                 BIT le plus fort de l'exposant (ici 128), et retirer 1.
                 Vous obtenez 127, qu'il faut retirer … l'exposant pour
                 obtenir r‚ellement la place de la virgule dans le nombre.
  BITs 22 … 0 : Mantisse. Elle contient le nombre r‚el ainsi que la partie
                situ‚e aprŠs la virgule.
                 Pour savoir … partir d'o— commence cette partie, il suffit …
                pr‚sent de prendre l'exposant "net" que l'on vient d'obtenir, et
                de l'utiliser comme offset. Sautez le nombre de BITs depuis le
                d‚but de la mantisse pour tomber sur le d‚but de la partie dont
                les BITs forment la partie … virgule.
                ATTENTION : Pour ‚conomiser un BIT, les ing‚nieur sous entendent
                            le premier BIT … un. Regardez les exemples.
                  La partie r‚elle est la partie "normale", car le BIT 1 vaut 2
                fois le BIT 0. La lecture se fait de droite … gauche, du BIT le
                plus faible vers le BIT le plus fort.
                  La partie aprŠs la virgule, c'est le sens inverse. Se lit de
                gauche … droite, et chaque BIT vaut la moiti‚ du pr‚c‚dent. En
                fait, c'est comme la partie normale, car si vous allez de droite
                … gauche, il faut multiplier par 2, et dans l'autre sens, il
                faut diviser par 2.
                  Pour r‚sumer, le premier BIT de la partie aprŠs la virgule
                vaut 0.5, et le suivant, … droite, 0.25, puis 0.125, etc...

  EXEMPLES : Pour commencez, imprimez le fichier FLOATEST.DOC, il s'y trouve la
             structure de quelques flottants.

             - 1 - 0.51743532967462426848
                   BIT 33222222222211111111110000000000
                       10987654321098765432109876543210
                       SEEEEEEEEMMMMMMMMMMMMMMMMMMMMMMM
                       0 <- Positif
                        01111110 <- (126)-127=-1
           BIT sous entendu -> 100001000111011010100100
             Comme l'exposant est … -1, la partie aprŠs la virgule inclus le
             BIT sous entendu.

             - 2 - 1243.63589688211
                   BIT 33222222222211111111110000000000
                       10987654321098765432109876543210
                       SEEEEEEEEMMMMMMMMMMMMMMMMMMMMMMM
                       0 <- Positif
                        10001001 <- (137)-127=10
           BIT sous entendu -> 10011011011 (1243)
               Partie aprŠs la virgule -> 1010001011001
             L'exposant est … 10, donc on saute 10 BITs depuis le d‚but de la
             mantisse (sans compter le BIT sous entendu) pour tomber sur le
             d‚but de la partie qui code pour la partie aprŠs la virgule.

             - 3 - -14.152678
                   BIT 33222222222211111111110000000000
                       10987654321098765432109876543210
                       SEEEEEEEEMMMMMMMMMMMMMMMMMMMMMMM
                       1 <- N‚gatif
                        10000010 <- (130)-127=3
           BIT sous entendu -> 1110 (14)
        Partie aprŠs la virgule -> 00100111000101011110
          Pour l'exposant, n'oubliez pas DE NE PAS compter le BIT sous entendu.

             - 4 - -0.000436976881
                   BIT 33222222222211111111110000000000
                       10987654321098765432109876543210
                       SEEEEEEEEMMMMMMMMMMMMMMMMMMMMMMM
                       1 <- N‚gatif
                        01110011 <- (115)-127=-12
                    00000000000111001010001101000001011
          Comme l'exposant est n‚gatif, cela veut d‚j… dire qu'il n'y a pas de
          nombre r‚el, donc que c'est 0.00... quelque chose dans le genre.
          Ici, l'exposant est … -12, donc il doit y avoir 12 BITs sous entendu,
          dont le dernier est … 1.

  ¯ L'‚criture Normalis‚e
    C'est ce que vous venez de voir … l'instant.

  ¯ L'‚criture NON Normalis‚e
    C'est lorsqu'un chiffre est si petit, qu'il peut se transformer en 0 lors
    de l'arrondissement.
    Ce fameux ZERO, c'est l'exposant … 0. Si la mantisse est aussi … 0, le
    chiffre est ‚gale … z‚ro (si l'exposant n'‚tait pas … z‚ro, il y aurait un
    BIT sous entendu qui repr‚senterait quelque chose).

    On peut les obtenir en forcant le coprocesseur … ne pas arrondir, et au
    lieu d'obtenir z‚ro, on obtient un nombre trŠs sp‚cial, dont la structure
    diffŠre pour pouvoir exprimer le nombre avec le plus de pr‚cision possible.

    Je ne vous donnerais la description de ce format que dans la documentation
    de la prochaine versionde SSAVCALL, lorsque j'en aurais inclus la gestion
    dans la fonction ci pr‚sente.

  ¯ L'‚criture Exceptionnelle
    Survient dans des situations exceptionnelles.
    Les infinis (ß) : Tout les BITs de l'exposant sont … 1 et la mantisse … 0.
                      Le signe (BIT de poids fort) donne le signe de l'infini.

    Q-NAN (nombre ind‚finis silencieux) : Imaginez +ß-ß=? car tout d‚pend de la
                      valeur r‚el de chaque infini. Le deuxiŠme infini pourrait
                      ˆtre juste inf‚rieur au premier, et la diff‚rence donner
                      10, mais vu qu'ils sont tellement grand que l'on ne sait
                      pas se qu'ils repr‚sentent. Donc on code un nombre
                      ind‚finis.
                        Le Q-NAN peut ˆtre produit lors d'un calcul par le
                      coprocesseur math‚matique.
                        Tout les BITs de l'exposant sont … 1, mais la mantisse
                      est diff‚rente de 0. Le premier BIT de la mantisse est
                      TOUJOURS … 1 pour un Q-NAN. Le signe n'influe pas le
                      calcul.

    S-NAN (nombre ind‚finis significatif) : Jamais produit par le coprocesseur,
                      mais vous pouvez lui en fournir (c'est pour cela qu'il
                      s'appelle significatif, car vous pouvez lui le donner
                      pour travailler avec). De plus, lors de son utilisation,
                      il se produit une interruption au niveau du coprocesseur.
                        La construction est la mˆme que le Q-NAN, mais le
                      premier BIT de la mantisse est ici TOUJOURS … 0.

  Pour v‚rifier rapidement un flottant, voici un petit programme pour
  calculatrice CASIO (entrez les BITs du plus fort vers le plus faible) :
  "EXPOSANT"¼
  ?A¼
  2^AA¼
  AC¼
  Lbl 0¼
  Aö2A¼
  "BIT"¼
  ?B¼
  B=1(=>)C+AC¼
  C(Disp)
  Goto 0¼

  Exposant est le nombre "net", dans les environ de 0 en g‚n‚ral, et pas celui
  extrait directement du flottant.
  ¼ repr‚sente EXE (passage … la ligne).
  (=>) repr‚sente un test de condition (normalement dans le menu PRGM/JUMP).
   repr‚sente "=" du BASIC.
  (Disp) repr‚sente le triangle rectangle plein du menu PRGM pour afficher une
  variable.

  ATTENTION : Ne donnez pas un exposant … 0 et les BITs sous entendus si vous
              voulez v‚rifier un nombre du genre 0.000...

  ATTENTION : Ceux qui imprimes sur une imprimante avec le jeu de caractŠre PC
              risquent de ne pas obtenir proprement le listing ci dessus...

> Type Flottant, DOUBLE Precision (8 OCTETs)
  Comme le SINGLE, mais tiens sur 64 BITs
  Description des diff‚rents BITs :
  BIT 63 : BIT de Signe.
  BIT 62-52 : Exposant (2^10-1=1023, c'est ce nombre qu'il faut enlever …
              l'Exposant "brut" pour obtenir l'Exposant "net").
  BIT 51-0 : Mantisse.

  ¯ L'‚criture Normalis‚e
    Voyez le format SINGLE, c'est exactement la mˆme chose, sauf qu'il faut
    enlever (2^10)-1=1023 … l'exposant, car celui ci est sur 11 BITs.

  ¯ L'‚criture NON Normalis‚e
    Voyez le format SINGLE.

  ¯ L'‚criture Exceptionnelle
    Voyez le format SINGLE.

> Type Flottant, EXTENDED Precision (12 OCTETs)
  Description des diff‚rents BITs :
  BIT 95 : BIT de Signe.
  BIT 94-80 : Exposant (2^14-1=16383).
  BIT 79-64 : Ces BITs sont … 0 (dommage, on aurait pu les utiliser pour gagner
              en pr‚cision)
  BIT 63 : Ce BIT est … 1, sauf dans le cas d'une ‚criture NON Normalis‚e.
  BIT 62-0 : Mantisse (63 BITs tout de mˆme)

  ¯ L'‚criture Normalis‚e
    Voyez le format SINGLE, c'est exactement la mˆme chose, sauf qu'il faut
    enlever (2^14)-1=16383 … l'exposant, car celui ci est sur 15 BITs.

  ¯ L'‚criture NON Normalis‚e
    Voyez le format SINGLE.
    ATTENTION : Le BIT 63 initialement … 1 est ici … 0.

  ¯ L'‚criture Exceptionnelle
    Voyez le format SINGLE.

> Type ASCII, D‚cimal non sign‚
  Nombre compos‚ des caractŠres de codes ASCII compris entre 48 et 57
  (0123456789). On peut lire quequ'chose, enfin...

> Type ASCII, D‚cimal sign‚
  Idem, mais peut ˆtre n‚gatif, avec le signe - devant.

> Type ASCII, Octal non sign‚
  L'octal est la repr‚sentation de la base de 0 … 7. Dans la base de dix, 10
  suit 9. Ici 10 suit 7, et 20 suit 17. Sont signe de repr‚sentation est
  l'arobace @. Ainsi @10, c'est 8

> Type ASCII, Octal sign‚
  Idem, mais en sign‚.

> Type ASCII, Hexad‚cimal non sign‚
  C'est la repr‚sentation de la base de 0 … 15. Les lettres ABCDEF remplacent
  les nombres 10, 11, 12, 13, 14 et 15. Le 10 suit F. Sont signe de
  repr‚sentation, c'est le dollar $. $10, c'est 16.

> Type ASCII, Hexad‚cimal sign‚
  Idem, mais sign‚. Normalement, on n'utilise jamais de nombre hexad‚cimal
  sign‚, mais c'est une question d'habitude.

> Type ASCII, Binaire
  C'est la repr‚sentation binaire type d'un nombre. Elle est compos‚e de 0 et
  de 1. Son signe est le pour cent %. %10, c'est 2.

> Type ASCII, Flottant Minuscule
  Repr‚sentation ASCII d'un nombre … virgule. Celui ci utilise en g‚n‚ral un
  exposant s'il y en a besoin, comme 2595.412 ‚crit 2.595412e2. G‚n‚ralement,
  l'exposant est justifi‚ sur 4 caractŠre, et donne 2.595412e0002. On peut
  obtenir des nombres n‚gatifs … l'exposant n‚gatif, en clair, des nombres
  inverses n‚gatifs … virgule, comme -2.9856e-0003 pour -0.0029856.

> Type ASCII, Flottant Majuscule
  Idem, mais les signes d'exposant sont des E majuscules.
  J'ai d‚cid‚ de mettre cette fonctions au cas o— il existerait de part le monde
  des programmes sauvegardant des fichiers dont les signes sont des E
  majuscules. Juste histoire d'ˆtre compatible sans que l'utilisateur soit
  oblig‚ de convertir tous les E en e. C'est le cas des productions du
  1StBasic, qui lors de l'utilisation de nombres en double pr‚cision, pousse
  l'imb‚cillit‚ … utiliser un "D" comme signe d'exposant.
  C'est vraiment trŠs fort, bravo HiSoft...

> Type UserBinaire, UnDefined Size non sign‚
  Un nombre binaire non sign‚ dans le nombre de BITs est d‚finit dans le
  paramŠtre correspondant

> Type UserBinaire, UnDefined Size sign‚
  Idem, mais sign‚

Moralement, voici ce que donne ces conversion ($FF sert d'exemple, et le format
peut ˆtre l'un des suivant) :
$FF(US) -> 255(US) : Le nombre reste dans sont format
           -255(S) : Le nombre est invers‚
                     ATTENTION : Ici, c'est dans le cas o— il est … afficher.
                                 Ne tentez pas de le reconvertir en BYTE, car
                                 celui ci est limit‚ … -127.
                                   Techniquement, c'est une erreur de proc‚der
                                 ainsi, mais logiquement ‡a marche.
                                 Pour le retransformer en BYTE, faites lui
                                 subir la transformation inverse (ici
                                 (S)->(US)).
$FF(S) -> 1(US) : Le nombre est ‚crit en sign‚ absolu, donc d'aprŠs l'exemple
                  pr‚c‚dent : -255(S) -> 255(US), soit $FF(US).
          -1(S) : Le nombre est ‚crit en sign‚ normal ($1(S) -> 1(S))

ParamŠtres : LONG : Adresse du nombre … convertir
             ATTENTION : Vu que SSAV est une routine convocable par un JSR, elle
                         se d‚roule en Utilisateur. Conclusion, ne donnez pas
                         d'adresses trop extrˆmes (dans les registres HardWare),
                         ou sinon, un "Bus Error" viendra vous f‚liciter de
                         votre clairvoyance. Les routines de conversions ne
                         faisant pas appels … l'AES ou le VDI, vous pouvez
                         pr‚alablement passer en Superviseur sans courir au Bug
                         qui vous rattrapera si vous faites la mˆme chose pour
                         l'AES et le VDI justement.
               Je me devais de vous pr‚venir, car je pense que certains sont
             tent‚s par la conversion num‚rique des diff‚rents registres Hard de
             l'ATARI. Pour les registres du 680X0, voyez ce qui suit (les
             indications suivants l'acronyme du registre se r‚fŠre … sa taille,
             et non son format; ainsi .d indique un registre sur 64 BITs, et non
             pas un flottant) :
                    -1 = D0.l                                               --+
                    -2 = D1.l                                                 |
                    -3 = D2.l                                                 |
                    -4 = D3.l                                                 |
                    -5 = D4.l                                                 |
                    -6 = D5.l                                                 |
                    -7 = D6.l                                                 6
                    -8 = D7.l                                                 8
                    -9 = A0.l                                                 0
                   -10 = A1.l                                                 0
                   -11 = A2.l                                                 0
                   -12 = A3.l                                                 /
                   -13 = A4.l                                                 0
                   -14 = A5.l                                                 8
                   -15 = A6.l                                                 |
                   -16 = A7.l                                                 |
                   -17 = USP.l (User Stack Pointer)                           |
                   -18 = SSP.l (Supervisor Stack Pointer)                     |
                   -19 = SR.w (Status Register)                               |
                   -20 = PC.l (Program Counter)                             --+
                   -21 = VBR.l (Vector Base Register)                         1
                   -22 = SFC.l (Source Function Code)                         0
                   -23 = DFC.l (Destination Function Code)                  --+
                   -24 = ISP.l (Interrupt Stack Pointer)                      |
                   -25 = MSP.l (Master Stack Pointer)                         |
                   -26 = CACR.l (CAche Control Register)                      6
                   -27 = CAAR.l (CAche Address Register)                      8
                   -28 = TC.l (Translation Control)                           0
                   -29 = CRP.d (Cpu Root Pointer)                             3
                   -30 = SRP.d (Supervisor Root Pointer)                      0
                   -31 = TT0.l (Transparent Translation 0)                    |
                   -32 = TT1.l (Transparent Translation 1)                    |
                   -33 = MMUSR.w (MMU Status Register)                      --+
                   -34 = FPCR.l (Floating Point Control Register)             |
                   -35 = FPSR.l (Floating Point Status Register)              |
                   -36 = FPIAR.l (Floating Point Instruction Address Register)6
                   -37 = FP0.x                                                8
                   -38 = FP2.x                                                8
                   -39 = FP3.x                                                8
                   -40 = FP4.x                                                2
                   -41 = FP5.x                                                |
                   -42 = FP6.x                                                |
                   -43 = FP7.x                                              --+
                   -44 = R‚serv‚
                   -45 = R‚serv‚
                   -46 = R‚serv‚
                   -47 = R‚serv‚
                   -48 = R‚serv‚
             WORD : Type du nombre … convertir
                     0 = Type Binaire, BYTE non sign‚
                     1 = Type Binaire, BYTE sign‚
                     2 = Type Binaire, WORD non sign‚
                     3 = Type Binaire, WORD sign‚
                     4 = R‚serv‚
                     5 = R‚serv‚
                     6 = Type Binaire, LONG non sign‚
                     7 = Type Binaire, LONG sign‚
                     8 = R‚serv‚
                     9 = R‚serv‚
                    10 = Type Flottant, SINGLE Precision (4 OCTETs)
                    11 = Type Flottant, DOUBLE Precision (8 OCTETs)
                    12 = Type Flottant, EXTENDED Precision (12 OCTETs)
                    13 = R‚serv‚
                    14 = R‚serv‚
                    15 = R‚serv‚
                    16 = R‚serv‚
                    17 = R‚serv‚
                    18 = Type ASCII, D‚cimal non sign‚
                    19 = Type ASCII, D‚cimal sign‚
                    20 = Type ASCII, Octal non sign‚
                    21 = Type ASCII, Octal sign‚
                    22 = Type ASCII, Hexad‚cimal non sign‚
                    23 = Type ASCII, Hexad‚cimal sign‚
                    24 = Type ASCII, Binaire
                    25 = R‚serv‚
                    26 = Type ASCII, Flottant Minuscule
                    27 = Type ASCII, Flottant Majuscule
                    28 = Type UserBinaire, UnDefined Size non sign‚
                    29 = Type UserBinaire, UnDefined Size sign‚
                    30 = R‚serv‚
                    31 = R‚serv‚
             WORD : Taille des donn‚es … convertir en OCTETs.
                    Dans les types 28 et 29, surtout.
                    Pour les types 26 et 27, c'est le nombre de chiffres aprŠs
                    la virgule.
             LONG : Adresse du nombre converti (pr‚voyez un buffer)
                    Peut ˆtre un registre, voyez la liste pr‚c‚dente.
                      Dans le cas du PC, les programmeurs perspicaces auront
                    d‚j… ‚mis un doute quand … l'utilit‚ de ce registre.
                      Ici, c'est l'adresse du retour … votre programme qui est
                    converti.
             WORD : Type du nombre une fois converti (Idem que pr‚c‚demment)
             WORD : Mode de conversion
                    0 = Force le mode demand‚
                        Vous obtenez ce que vous avez demand‚
                    1 = Conversion optimale (ne marche pas encore). Si vous
                        demandez de convertir un Flottant au format Extended (12
                        OCTETs) qui vaut 124, en LONG, la routine vous le
                        transformera en BYTE pour vous ‚conomiser 3 OCTETs, par
                        exemple.
                    2 = Permet l'‚criture en arrondi pour les nombres …
                        virgules flottantes. Si la routines tombes sur deux 9
                        successifs, elle arrondie et stoppe la convertion, si
                        elle ne l'avais pas encore termin‚e.
                        Par exemple, ...399 devient ...4.
             WORD : APP_ID. Pour l'instant ne sert … rien, mais pour la
                    prochaine version, je pr‚voie de modifier la routine et de
                    lui permettre de gerer correctement plusieurs applications.
                    Ce n'est pas encore le cas, aussi faites bien attention,
                    car les t‚l‚scopages risquent d'etres fr‚quents...
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = un code d'erreur, sinon le type r‚ellement obtenu
Pile : 24

Je vous invite … essayer le plus de combinaisons possibles, car je n'aurait
s–rement pas le temps de v‚rifier les 380 routines de conversion num‚rique qui
forment cette fonction. Une version corrig‚e pour celui qui me trouve des bugs.
Si je n'ai pas inclus les format BCD, c'est que c'est trŠs simple … faire soit
mˆme (utilisez les instructions ABCD, NBCD ou SBCD), qu'ils sont rarement mis
en oeuvres, et que les "r‚serv‚" le sont pour les format Intel, dont provient
beaucoup de format d'image qu'il serait bon d'avoir chez nous.

ATTENTION : Je me permet ici de rappeler ici, essentiellement pour les nouveaux
            venus dans le monde formidouble de l'assembleur, que si vous ˆtes en
            Superviseur, et que vous faites un appels utilisant un adressage
            relatif au SP (move.l (24,SP),D0 par exemple), c'est … partir de SSP
            qu'il faut regarder.
              En principe SSP et USP sont diff‚rents, car bien que juste aprŠs
            le TRAP du GEMDOS, les adresses des deux piles soit ‚gales, il se
            forme une diff‚rence lorsque vous restaurez la pile par un addq.l
            #6,SP. Donc faites attention … bien vous r‚f‚rer … SSP lorsque vous
            d‚bugez en superviseur, et … A7 en Utilisateur.

REMARQUE : Pour les heureux possesseurs du STOS BASIC, vous pouvez utiliser la
           routine d'‚mulation du coprocesseur, vu qu'elle est trŠs bien. Le
           bouquin est trŠs bien ‚crit et explique parfaitement comment utiliser
           la routine (c'est rare des explications aussi claire de nos jours,
           seul les allemands sont coutumiers du fait, bien que certaines
           pr‚cisions ne sont pas donn‚es).
             Cependant, cette routine ne travaille qu'avec des nombres en DOUBLE
           pr‚cision, qu'il faut passer comme sur PC (oui, vous avez bien lu,
           ces moulins … caf‚ qu'on arrive … faire passer pour des ordinateurs)
           dans les registres de donn‚es (ici D1 et D2, ainsi que D3 et D4 pour
           certaines op‚rations).
             Y'a juste … faire attention, car il y a un retour fr‚quent de
           $12345678 dans certains registres. Une valeur semblerait-il "magic"
           pour la routine, qui ne fonctionne que si elle trouve ce nombre dans
           un registre donn‚ pour chaque fonction. Le but n'‚tant pas ici de
           vous refaire la documentation de la chose, je vous invite … la
           desassembler. C'est trŠs instructif, croyez, surtout pour quelqu'un
           qui se sait pas totalement comment s'y prendre pour convertir ces
           fichus nombres flottants en ASCII, et inversement (clin d'oeil
           entendu...).
             De plus, pour l'utiliser, c'est un peu particulier. En dehors du
           fait qu'il faille passer les parametres par les registres de
           donn‚es, il faut la mettre en m‚moire, et la reloger. En effet,
           cette routine peut ˆtre executer en temps que programme, mais cela
           ne fait qu'installer le TRAP 6, et sort par un RTS (attendez vous …
           une erreur bus si vous lancez la chose depuis le bureau, ou par le
           GemDos (vus qu'au d‚part d'un programme, le LONG point‚ par la pile
           est vide (sauter … 0 est impossible, vu que ce n'est pas l'adresse
           de d‚part du systeme d'exploitation, mais la pile... rappellez vous,
           on revient par un RTS), car le LONG suivant est l'adresse de la Base
           Page (vous voyez enfin o— l'on est?)). Donc chargez avec le GemDOS
           (P_EXEC), sans executer, cherchez le d‚but de la Base Page (en
           principe en retour dans DO.l), cherchez le d‚but de la section TEXT
           (8 Octets aprŠs le d‚but de la Base Page, donc aprŠs P_EXEC,
           D0.l+8), et faites un JSR, histoire de fumer le foin...

/// (AES  61 X : CONV_RSC2WK V1.00, en cours de d‚veloppement) ///

Sert … convertir la r‚solution d'une ressource … la r‚solution de l'‚cran.
Ainsi, il devient inutile de faire une ressource pour chaque type de r‚solution.
Il suffit de faire la Haute R‚so, puis d'utiliser cette fonction qui la
convertie et Moyenne ou Basse. Conversion automatique des images avec
CONV_COLORPIC, et redimensionnement.

/// (AES  62 X : CONV_RSC2LANG V1.00, en cours de d‚veloppement) ///

Sur Falcon surtout, on peut changer la langue de son TOS. Sur ST, c'est d‚j…
d‚finit en ROM. Combien de personnes se sont d‚j… trouv‚es devant un ‚cran en
allemand, alors qu'elle ne comprennent que l'albanais (je prend un cas extrˆme).
Cette fonction ne traduit pas, ce qui prendrait bien trop de place, mais utilise
un fichier sp‚cifique qui contient toutes les langues support‚es, et place celle
en cours dans la ressource. Il s'agit donc d'‚crire chaque langue dans un
fichier, et de choisir une langue par d‚faut, au cas ou vous tentiez de
convertir une ressource en albanais (pas support‚) alors que celui-ci n'a pas
‚t‚ ‚crit dans le fichier en question.
  Relisez trois fois en avant, deux fois en arriŠre, une fois … cloche pied,
vous comprendrez...

/// (AES  63 X : CONV_COLORPIC V1.00, en cours de d‚veloppement) ///

  Sert pour convertir une image TC ou NTC (voire 256) en moins, pour s'adapter …
l'‚cran. Diff‚rents modes de conversions seront disponibles pour offrir la plus
large palette de possibilit‚s afin de subvenir … tous les besoins.
  Si quelqu'un dispose de routines rapides et correctes, qu'il n'h‚site pas … me
les communiquer. Je me ferais une joie de le glorifier (disons faire figurer son
nom en TRES bonne place pour services rendus (un peu comme Michael Jack's Son,
mais sans les 5 millions de dollar)).
  Je compte inclure un systŠme multi-plans pour effectuer un tramage sur
seulement certaines parties du dessin, ainsi qu'un systeme limitatif de la
palette (enfin un traming qui ne saccage pas vos belles couleurs).

--- LIBRAIRIE GRAPHIQUES ---

/// AES  70 : GRAF_RUBBERBOX ///

Sert … afficher et … changer la taille d'une boite avec la souris.
  Cette fonction se termine si le bouton gauche de la souris n'est pas ou plus
press‚. Donc si vous appelez cette fonction sans que le bouton gauche soit
press‚, vous revenez illico … votre programme.

ParamŠtres : WORD : Coordonn‚e X du coin sup‚rieur gauche de la boite
             WORD : Coordonn‚e Y du coin sup‚rieur gauche de la boite
             WORD : Largeur de la boite
             WORD : Hauteur de la boite
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.l = 0 si erreur, sinon Largeur.w et Hauteur.w
Pile : 16

/// AES  71 : GRAF_DRAGBOX ///

Sert … d‚placer une boite … l'aide de la souris dans un rectangle.
Comme pr‚cedemment, cette fonction se termine au relƒchement du bouton gauche.

ParamŠtres : WORD : Largeur de la boite en points
             WORD : Hauteur de la boite en points
             WORD : X de d‚part de la boite
             WORD : Y de d‚part de la boite
             WORD : X du rectangle d'action
             WORD : Y du rectangle d'action
             WORD : Largeur du rectangle d'action
             WORD : Hauteur du rectangle d'action
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.l = 0 si erreur, sinon X.w et Y.w de la boite au relƒchement du
                bouton gauche
Pile : 24

/// AES  72 : GRAF_MOVEBOX ///

Sert … faire d‚placer une boite toute seule, comme une grande.

ParamŠtres : WORD : Largeur de la boite en points
             WORD : Hauteur de la boite en points
             WORD : X de d‚part de la boite
             WORD : Y de d‚part de la boite
             WORD : X de fin de la boite
             WORD : Y de fin de la boite
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 20

/// AES  73 : GRAF_GROWBOX ///

Dessine une "boite" qui grandit. Utilit‚ discutable.
Vous savez, c'est les petites lignes qui s'animent lorsque vous ouvrez un
lecteur sous le bureau, juste avant l'ouverture de la fenˆtre, par exemple.

ParamŠtres : WORD : X de d‚part de la boite
             WORD : Y de d‚part de la boite
             WORD : Largeur de d‚part de la boite en points
             WORD : Hauteur de d‚part de la boite en points
             WORD : X fin de la boite
             WORD : Y fin de la boite
             WORD : Largeur finale de la boite en points
             WORD : Hauteur finale de la boite en points
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 24

/// AES  74 : GRAF_SHRINKBOX ///

Dessine une "boite" qui r‚tr‚cit. Idem, si vous avez deux secondes devant vous,
… perdre... (or le temps c'est de l'argent, et tout le monde le sait).

ParamŠtres : WORD : X fin de la boite
             WORD : Y fin de la boite
             WORD : Largeur finale de la boite en points
             WORD : Hauteur finale de la boite en points
             WORD : X de d‚part de la boite
             WORD : Y de d‚part de la boite
             WORD : Largeur de d‚part de la boite en points
             WORD : Hauteur de d‚part de la boite en points
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 24

/// AES  75 : GRAF_WATCHBOX ///

Cette fonction change l'aspect d'une boite suivant deux facteurs :
 - La position de la souris (hors ou sur la boite)
 - L'‚tat du bouton gauche (enfonc‚ ou pas)
Sert par exemple si vous s‚lectionn‚ un bouton, mais sans relƒcher le bouton
gauche, vous sortez de la boite. Vous pouvez donc d‚finir deux ‚tats.
  Il est trŠs courant … ce niveau de mettre l'‚tat s‚lectionn‚ si la souris se
trouve au dessus de la boite, et d‚s‚lectionn‚ si la souris ne l'est pas. Permet
par exemple de revenir sur sa d‚cision si l'on change d'avis alors que l'on …
s‚lectionn‚ le bouton. Il suffit de sortir de la boite, et de relƒcher.
  Mais en fait, c'est … vous de g‚rer cela. Cette fonction est l… plut“t … titre
d'embellissement. FORM_DO utilise d'ailleurs cette fonction. Vous pouvez essayer
sous un de vos formulaire, ou tout autre programme (TestSSAV).

ParamŠtres : LONG : Adresse de l'arbre
             WORD : Num‚ro de l'objet
             WORD : Aspect lorsque la souris est au dessus de la boite
                    BIT 0 : Normal
                    BIT 1 : Selected
                    BIT 2 : Crossed
                    BIT 3 : Checked
                    BIT 4 : Disabled
                    BIT 5 : OutLined
                    BIT 6 : Shadowed
             WORD : Aspect lorsque la souris est hors de la boite
                    Idem que pr‚cedemment
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Position de la souris au relƒchement du bouton gauche
                0 = Hors de la boite
                1 = Au dessus de la boite
Pile : 18

/// AES  76 : GRAF_SLIDEBOX ///

Permet de faire glisser une boite avec la souris dans sa boite MŠre. Comme
pr‚cedemment, la fonction se termine au relƒchement du bouton gauche.
  Lors de la r‚ception du r‚sultat, faite un BCLR sur le bit 15. Vous pourrez
savoir de quel type de d‚placement il s'agissait, et vous pourrez ainsi utiliser
le r‚sultat qui sera ainsi compris entre 0 et 1000, comme il doit l'ˆtre.

ParamŠtres : LONG : Adresse de l'arbre
             WORD : Num‚ro du PŠre (ou de la MŠre dans ce cas)
             WORD : Num‚ro de l'Objet par rapport … la Racine
             WORD : Direction de d‚placement
                    0 = Horizontale
                    1 = Verticale
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Postion de l'Objet par rapport … son PŠre. Cette position
                s'apparente … celle des "Cabines" des ascenseurs.
                0 = Tout en haut s'il s'agissait d'un d‚placement Vertical
                    Tout … gauche s'il s'agissait d'un d‚placement Horizontal
                1000 = Tout en bas s'il s'agissait d'un d‚placement Vertical
                       Tout … droite s'il s'agissait d'un d‚placement Horizontal
                BIT 15 = 0 : s'il s'agissait d'un d‚placement Horizontal
                         1 : s'il s'agissait d'un d‚placement Vertical
Pile : 18

/// AES  77 : GRAF_HANDLE ///

Permet d'obtenir le Handle VDI du bureau courant, et des informations sur la
fonte actuelle.
Avec cela, et un Extended Inquire Function (VDI 102) bien sentit, vous pouvez
obtenir toutes les informations dont vous avez besoin.

ParamŠtres : LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.l = Pointeur vers un tableau contenant les informations
                Structure du tableau : WORD 0 : Handle du VDI
                                       WORD 1 : Largeur d'un caractŠre en
                                                points
                                       WORD 2 : Hauteur d'un caractŠre en
                                                points
                                       WORD 3 : Largeur d'une cellule en points
                                       WORD 4 : Hauteur d'une cellule en points
Pile : 8

/// AES  78 : GRAF_MOUSE ///

Permet de changer la forme de la souris.
Il est souhaitable d'appeler cette fonction juste aprŠs votre APPL_INIT, car
sinon la souris reste sur la forme de l'abeille, signe de chargement. Ce n'est
pas le GEM qui s'en charge, car rien ne vous empˆche au d‚but de votre programme
de continuer … charger des fichiers compl‚mentaires, et de signaler …
l'utilisateur que l'ordinateur n'a pas fini son chargement en laissant la souris
sous forme d'abeille.

ParamŠtres : WORD : Code du dessin
                      0 = FlŠche normale
                      1 = Curseur Texte (Barre verticale)
                      2 = Abeille
                      3 = Main ferm‚e avec doigt tendu
                      4 = Main ouverte
                      5 = R‚ticule ‚pais (Un grand + noir)
                      6 = R‚ticule encadr‚ (Un grand + OutLined)
                    255 = Forme d‚finit par l'utilisateur
                    256 = Supprime la souris
                    257 = R‚ussusite la souris
                          ATTENTION : Vous devez r‚ssusiter la souris autant de
                                      fois que vous l'avez supprim‚ avant
                                      qu'elle ne r‚apparaisse. Voyez pourquoi
                                      dans le chapitre sur la LineA (les
                                      variables systŠme)
             LONG : Adresse d'une structure UserMouse
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 14

> Structure UserMouse
  Cette structure contient les informations relative au nouveau pointeur de la
  souris.
  WORD 0 : MF_XHOT : X du "Point Chaud". C'est le "Point Chaud" qui agit sur
                     les diff‚rents ‚l‚ments du GEM. Il est compris entre 0 et
                     15, car la souris fait 16 pixels de haut et de large.
  WORD 1 : MF_YHOT : Y du "Point Chaud"
  WORD 2 : MF_NPLANES : Ben... TOUJOURS … 1, car le pointeur est TOUJOURS
                        monochrome, mais les programmeurs de Digital Research
                        sont pr‚voyants. Rien ne vous empˆche d'‚crire votre
                        propre routine de traitement de la souris, et donc
                        d'utiliser cette donn‚e pour en faire une en couleur.
  WORD 3 : MF_FG : Couleur du masque. Mettez 0 (Blanc).
  WORD 4 : MF_BG : Couleur du dessin. Mettez 1 (Noir)
  WORD 5 : MF_MASK : 16 WORDs repr‚sentant le masque du pointeur
  WORD 15 : MF_DATA : 16 WORDs repr‚sentant le dessin du pointeur

/// AES  79 : GRAF_MKSTATE ///

Fournit plein de petites informations sur la souris. Jetez un oeil …
EVNT_MOUSE (AES 22), mais n'oubliez pas de le reprendre, sinon ‡a fait n‚glig‚.

ParamŠtres : LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.l = Pointeur vers un tableau resplendissant, tant il contient de
                chose utile (j'entend d‚j… McGyver japper et piaffer de plaisir)
                Structure du tableau : WORD 0 : 1 (doze, treize...)
                                       WORD 1 : X de la souris
                                       WORD 2 : Y de la souris
                                       WORD 3 : Etat des boutons
                                                BIT 0 : Bouton gauche
                                                BIT 1 : Bouton droit
                                       WORD 4 : Etat des touches sp‚ciales
                                                BIT 0 : SHIFT droit
                                                BIT 1 : SHIFT gauche
                                                BIT 2 : CONTROL
                                                BIT 3 : ALTERNATE
Pile : 8

--- LIBRAIRIE SCRAP ---

/// AES  80 : SCRP_READ ///

Lit le chemin du ClipBoard actuel.
Encore faut il que celui ci ait ‚t‚ d‚finit par SCRP_WRITE (AES 81). Le tampon,
faites le assez grand, mais pas trop (256 OCTETs suffisent), car le chemin ne
doit comporter que le lecteur et le nom du r‚pertoire.

ParamŠtres : LONG : Adresse du tampon pour recevoir le chemin du ClipBoard
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 12

/// AES  81 : SCRP_WRITE ///

Sert … fixer le chemin correct du ClipBoard. Le nom du r‚pertoire DOIT ˆtre
"CLIPBRD", et rien d'autre, Pig‚? De plus, le chemin du r‚pertoire DOIT se
terminer par "\" et un OCTET nul.
Vous me direz : "C'est idiot de red‚finir le chemin d'accŠs au dossier ClipBoard
… chaque lancement d'un programme", mais bon, vaut mieux deux fois que pas du
tout.
  D'ailleurs, pour ‚viter de vous prendre la tˆte, UTILSSAV.S contient une
routine pour red‚finir ce chemin. Si vous n'en voulez pas (des fois que vous
veniez … ne pas avoir besoin du ClipBoard), effacez la routine, elle ne dira
rien (enfin, ...).
  Cette fonction peut avoir une utilit‚ particuliŠrement int‚ressante dans le
cas de SSForm_Sound (X AES 59)

ParamŠtres : LONG : Adresse du r‚pertoire
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 12

--- LIBRAIRIE SELECTEURS DE FICHIER ---

/// AES  90 : FSEL_INPUT ///

C'est le s‚lecteur de fichier Standard.
  Youpi, mais il n‚cessite environ 16 Ko de libre dans la m‚moire pour
fonctionner, sinon, rien ne se passe, histoire de vous laisser lib‚rer de la
m‚moire et de le resiffler.
  De plus, il semble fortement que le s‚lecteur de fichier soit g‚r‚ … la
 maniŠre
de FORM_DO, car vous ne pouvez en sortir que par voie l‚gale (les boutons).
C'est bien dommage d'ailleurs.

ParamŠtres : LONG : Adresse du r‚pertoire de d‚part, avec masque
             LONG : Adresse du nom du fichier qui apparaŒtra au d‚part, mais
                    que l'on peut changer par la suite. Le nom de ce fichier
                    sera remplac‚ par le nouveau si vous appuyez sur "O-KAY"
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.l = 0 si erreur, sinon le WORD de poids fort contient soit :
                  0 = Bouton "Annul‚"
                  1 = Bouton "OK"
Pile : 16

/// AES  91 : FSEL_EXINPUT ///

La grande Star (cris de foule, trompette, choeur d'enfants, ...). Idem que
pr‚c‚demment (sifflements, ...), mais l'on peut donner le titre que l'on d‚sir
au s‚lecteur (soupirs de soulagement, ...).
  Certains n'en verront pas l'utilit‚, mais imaginez que vous avez programmez un
traitement de texte, et que dans le menu, l'option de chargement et de
sauvegarde soient juxtapos‚s. Si l'utilisateur ne fait pas attention, il risque
de choisir l'option "Sauver" au lieu de "Charger", et ainsi, sans le savoir,
‚craser, avec le texte qu'il est en train d'‚diter, le texte qu'il voulait
charger.
  Donc, avec ce s‚lecteur, vous pouvez v‚ritablement indiquer … l'utilisateur
l'option qu'il a choisit, et en cas d'erreur, il peut revenir en arriŠre avant
de commettre l'irr‚parable. Cependant, cette fonction ne fonctionne qu'… partir
du TOS 1.4, Arghh...

ParamŠtres : LONG : Adresse du r‚pertoire de d‚part, avec masque
             LONG : Adresse du nom du fichier
             LONG : Adresse du titre du s‚lecteur (pas plus de 30 caractŠres)
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour :  D0.l = 0 si erreur, sinon le WORD de poids fort contient soit :
                   0 = Bouton "Annul‚"
                   1 = Bouton "OK"
Pile : 20

--- LIBRAIRIE FENETRES ---

/// AES 100 : WIND_CREATE ///

Sert … cr‚er une fenˆtre pour qu'elle soit g‚r‚e par l'AES.
  A sa cr‚ation, la fenˆtre n'est pas ouverte, mais existe, et peut l'ˆtre par
l'appel de la fonction WIND_OPEN (AES 101).

ParamŠtres : WORD : Champ de BITs d‚finissant la tˆte qu'aura la fenˆtre.
                    BIT 0 : Barre de Titre
                    BIT 1 : Closer - Bouton au coin sup‚rieur gauche pour
                            fermer la fenˆtre
                    BIT 2 : Fuller - Bouton au coin sup‚rieur droit pour
                            ouvrir la fenˆtre sur tout le bureau
                    BIT 3 : Barre de d‚placement - En fait, la Barre de Titre,
                            mais indique … l'AES que l'on d‚sire que cette
                            fenˆtre soit d‚pla‡able
                    BIT 4 : Info - La ligne d'informations juste sous la Barre
                            de Titre
                    BIT 5 : Sizer - Le bouton au coin inf‚rieur droit pour
                            modifier la taille de la fenˆtre
                    BIT 6 : UpArrow - La flŠche vers le haut
                    BIT 7 : DnArrow - La flŠche vers le bas
                    BIT 8 : VSlide - La "cabine" verticale, ainsi que
                            l'ascenseur
                    BIT 9 : LfArrow - La flŠche vers la gauche
                    BIT A : RtArrow - La flŠche vers la droite
                    BIT B : HSlide - La "cabine" horizontale, ainsi que le
                            couloir
             WORD : X de la fenˆtre
             WORD : Y de la fenˆtre
             WORD : Largeur de la fenˆtre
             WORD : Hauteur de la fenˆtre
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Handle de la fenˆtre cr‚e
Pile : 18

/// AES 101 : WIND_OPEN ///

Sert … faire apparaŒtre la fenˆtre avec la taille d‚finie.

ParamŠtres : WORD : Handle de la fenˆtre que l'on souhaite ouvrir
             WORD : X de la fenˆtre
             WORD : Y de la fenˆtre
             WORD : Largeur de la fenˆtre
             WORD : Hauteur de la fenˆtre
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 18

/// AES 102 : WIND_CLOSE ///

Sert … fermer une fenˆtre. N‚anmoins, celle ci existe toujours en m‚moire, et
peut ˆtre … tout moment r‚ouverte. Attendez vous aprŠs cette fonction … recevoir
une s‚rie de messages de Redraw, histoire de redessiner ce que la fenˆtre avait
recouvert.

ParamŠtres : WORD : Handle de la fenˆtre … fermer
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 10

/// AES 103 : WIND_DELETE ///

Indique … l'AES que l'on d‚sire d‚truire une fenˆtre qui ne nous servira plus.
Il s'agit aussi de d‚truire toutes les fenˆtres cr‚es avant de quitter le
programme. Si vous disposez d'un TOS r‚cent, utilisez WIND_NEW (AES 109), il
fait tout.

ParamŠtres : WORD : Handle de la fenˆtre … d‚truire
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 10

/// AES 104 : WIND_GET ///

Sert … obtenir un tas d'informations sur une fenˆtre. D‚pend aussi de se que
vous voulez comme renseignements.

ParamŠtres : WORD : Handle de la fenˆtre
             WORD : Informations demand‚es
                    4 = WF_WORKXYWH : Position et dimension de la zone de
                                      travail de la fenˆtre, c'est … dire o—
                                      apparaŒt le texte ou le dessin, sans
                                      compter les ‚l‚ments de la fenˆtre
                                      WORD 0 : X
                                      WORD 1 : Y
                                      WORD 2 : Largeur
                                      WORD 3 : Hauteur
                    5 = WF_CURRXYWH : Position et dimensions de la fenˆtre
                                      WORD 0 : X
                                      WORD 1 : Y
                                      WORD 2 : Largeur
                                      WORD 3 : Hauteur
                    6 = WF_PREVXYWH : Idem, mais pour sa pr‚c‚dente position et
                                      taille (utile pour faire revenir la
                                      fenˆtre dans sa position initiale sans
                                      utiliser de variables)
                                      WORD 0 : X
                                      WORD 1 : Y
                                      WORD 2 : Largeur
                                      WORD 3 : Hauteur
                    7 = WF_FULLXYWH : Idem, mais pour la taille maximale (pour
                                      un Full sur le bureau)
                                      WORD 0 : X
                                      WORD 1 : Y
                                      WORD 2 : Largeur
                                      WORD 3 : Hauteur
                    8 = WF_HSLIDE : Position de la "Cabine" horizontale
                                    WORD 0 : Position
                    9 = WF_VSLIDE : Position de la "Cabine" verticale
                                    WORD 0 : Position
                    10 = WF_TOP : Handle de la fenˆtre en premier plan
                                  WORD 0 : Handle
                    11 = WF_FIRSTXYWH : Position et dimension du premier
                                        rectangle dans la liste "Intersection".
                                        C'est grƒce … cette liste que vous allez
                                        pouvoir demander au GEM de redessiner
                                        morceaux par morceaux  les ‚l‚ments de
                                        l'‚cran effac‚s par votre fenˆtre ou
                                        formulaire.
                                          Il faut utiliser cette fonction aprŠs
                                        un message de Redraw pour obtenir une
                                        liste de rectangles qu'il faudra
                                        demander de redessiner.
                                          Ici, on commence par demander le
                                        premier rectangle (un peu comme F_SFIRST
                                        et F_SNEXT du GEMDOS). Dans le message
                                        de Redraw, vous recevez la position et
                                        la dimension d'une zone rectangulaire.
                                        C'est celle pr‚c‚demment Clipp‚. Avec
                                        WF_FIRSTXYWH, vous obtenez de petits
                                        rectangles, qui correspondent aux
                                        v‚ritables zones … redessiner. Mais il
                                        ne s'agit pas d'omettre les coordonn‚es
                                        et les dimensions envoy‚es par le
                                        message de Redraw.
                                          Il ne faut redessiner que les parties
                                        communes de ce rectangle, et les petits
                                        rectangles de WF_FIRSTXYWH. Ca peut vous
                                        paraŒtre abscons … la premiŠre lecture,
                                        mais je vous invite … vous r‚f‚rer …
                                        l'article de Mr ATTARD sur ce sujet,
                                        parus dans le num‚ro 80 d'ST MAGAZINE.
                                          Je peut fournir des photocopies contre
                                        5 francs (porc [Gro‹?] compris).
                                        WORD 0 : X
                                        WORD 1 : Y
                                        WORD 2 : Largeur
                                        WORD 3 : Hauteur
                    12 = WF_NEXTXYWH : Position et taille des autres rectangles,
                                       un par appel, jusqu'a obtention d'une
                                       taille nulle (plus de rectangles …
                                       redessiner).
                                       WORD 0 : X
                                       WORD 1 : Y
                                       WORD 2 : Largeur
                                       WORD 3 : Hauteur
                    15 = WF_HSLSIZE : Taille de la "Cabine" horizontale. -1 est
                                      la taille minimum, sinon c'est entre 1 et
                                      1000 pour les raisons que vous connaissez.
                                      WORD 0 : Taille
                    16 = WF_VSLSIZE : Taille de la "Cabine" verticale. Idem que
                                      pr‚cedemment.
                                      WORD 0 : Taille
                    17 = WF_SCREEN : J'ai pas de doc explicite, mais d'aprŠs le
                                     livre du d‚veloppeur, vous obtenez dans
                                     LONG 0 : Adresse du tampon ALERT
                                     WORD 2 : Largeur
                                     WORD 3 : Hauteur
                                     Il s'agirait d'un buffer qui doit
                                     normalement avoir la taille d'un quart de
                                     l'‚cran pour y ranger le fond lors de
                                     l'ouverture d'un menu d‚roulant ou d'une
                                     boite d'alerte, histoire que le GEM n'ait
                                     pas … vous envoyer de message de ReDraw
                                     aprŠs vous avoir saccag‚ le bureau.
                                       C'est pas propre, mais ‡a marche. Et pis
                                     c'est rapide, en plus...
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.l = 0 si erreur, sinon pointeur sur un tableau contenant les
                informations demand‚es
                Structure du tableau : Regardez dans les Informations
                                       sollicit‚es
Pile : 12

/// AES 105 : WIND_SET ///

Sert … changer les attributs d'une fenˆtre. Il s'agira de la redessiner par la
suite.

ParamŠtres : WORD : Handle de la fenˆtre … retoucher
             WORD : Attributs … changer
                    1 = WF_KIND : Les attributs de la fenˆtre
                                  In1 : Nouveaux attributs comme WIND_CREATE
                                  BIT 0 : Barre de Titre
                                  BIT 1 : Closer - Bouton au coin sup‚rieur
                                          gauche pour fermer la fenˆtre
                                  BIT 2 : Fuller - Bouton au coin sup‚rieur
                                          droit pour ouvrir la fenˆtre sur tout
                                          le bureau
                                  BIT 3 : Barre de d‚placement - En fait, la
                                          Barre de Titre, mais indique … l'AES
                                          que l'on d‚sire que cette fenˆtre
                                          soit d‚pla‡able
                                  BIT 4 : Info - La ligne d'informations juste
                                          sous la Barre de Titre
                                  BIT 5 : Sizer - Le bouton au coin inf‚rieur
                                          droit pour modifier la taille de la
                                          fenˆtre
                                  BIT 6 : UpArrow - La flŠche vers le haut
                                  BIT 7 : DnArrow - La flŠche vers le bas
                                  BIT 8 : VSlide - La "cabine" verticale, ainsi
                                          que l'ascenseur
                                  BIT 9 : LfArrow - La flŠche vers la gauche
                                  BIT A : RtArrow - La flŠche vers la droite
                                  BIT B : HSlide - La "cabine" horizontale,
                                          ainsi que le couloir
                    2 = WF_NAME : Titre de la fenˆtre
                                  In1 et In2 : Adresse de la chaŒne de caractŠre
                                               du Titre de la fenˆtre.
                                               Cependant, l'AES prend l'adresse,
                                               et non la chaŒne de caractŠres,
                                               donc il ne faut surtout pas
                                               changer cette chaŒne de caractŠre
                                               tant que la fenˆtre est ouverte
                    3 = WF_INFO : Ligne d'infos de la fenˆtre
                                  In1 et In 2 : Adresse de la chaŒne de
                                                caractŠres de la ligne d'Infos.
                                                Mˆmes remarques que pr‚c‚demment
                    5 = WF_CURRXYWH : Fixe la nouvelle position et taille de la
                                      fenˆtre
                                      In1 : X
                                      In2 : Y
                                      In3 : Largeur
                                      In4 : Hauteur
                    8 = WF_HSLIDE : Fixe la position de la "Cabine" horizontale
                                    In1 : Position
                                    La position est simple … calculer, 0 ‚tant
                                    le d‚part et 1000 la fin (attention,
                                    derniŠre page, donc calculez le nombres de
                                    lignes dans cette page). La position est
                                    donc ‚gale … :
                                    (Num‚ro de la premiŠre ligne affich‚e /
                                    (Num‚ro de la derniŠre ligne - Nombre de
                                     lignes par page))*1000
                    9 = WF_VSLIDE : Idem pour la "Cabine" verticale
                                    In1 : Position
                                    Idem que pr‚cedemment.
                    10 = WF_TOP : Fait venir la fenˆtre au premier plan
                    14 = WF_NEWDESK : Fixe un nouveau menu (avec nouvelle barre
                                      de menu). Cependant, avant de quitter,
                                      appeler cette fonction avec comme
                                      paramŠtre 0 pour que le menu du GEM s'y
                                      remette.
                                        Facultatif cependant, car le GEM, … la
                                      sortie d'un programme, reprend le bureau).
                                      Peut ˆtre pour forcer MultiTOS …
                                      rafraŒchir l'‚cran … la sortie
                                      In1 et In2 : Adresse de l'arbre
                                      In3 : Num‚ro du premier Objet … dessiner
                    15 = WF_HSLSLIDE : Fixe la taille de la "Cabine" horizontale
                                       In1 : Taille
                                       Sachant que la taille de la cabine est
                                       proportionnelle … la taille du document
                                       affich‚, la longueur du couloir est en
                                       principe de 1000+Taille de la Cabine.
                                       Pour calculer cette taille, prenez la
                                       formule magique de Mr ATTARD, c'est …
                                       dire :
                                       (1000* Largeur Affich‚e)/Largeur Totale.
                                       Ainsi, si le document est entiŠrement
                                       affich‚, la taille vaut 1000, et la
                                       moiti‚ si la largeur affich‚e est deux
                                       fois moindre.
                    16 = WF_VSLSLIDE : Fixe la taille de la "Cabine" verticale
                                       In1 : Taille
                                       Mˆme r‚sonnement que pr‚cedemment.
             WORD : In1, … 0 si inutilis‚
             WORD : In2, idem
             WORD : In3, idem
             WORD : In4, idem
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 20

ATTENTION : Lors des calcul pour la position ou la taille en rapport avec les
            ascenseurs des fenˆtres, de travailler avec le plus de pr‚cision
            possible, pour ‚viter les pertes, vu que vous travaillez sur des
            entiers, en g‚n‚ral. €a permet d'‚viter les stupides erreurs
            d'arrondis (grossiers dans ce cas de figure).
              D'ordinaire, c'est avec des WORDs que l'on travaille, mais rien ne
            doit vous empˆcher d'utiliser les services du coprocesseur si vous
            le trouvez dans la configuration (voyez le Cookie _FPU). Les
            nouveaux processeurs comme le 68030 peuvent faire des divisions sur
            des LONGs.

/// AES 106 : WIND_FIND ///

Sert … obtenir le Handle de la fenˆtre qui se trouve sous une position donn‚e.
  En g‚n‚ral (Oui? Ici DEUG-HOLE en direct de Colombe-hait-les-deux-‚glise), on
prend celle de la souris, histoire de mettre en avant plan un fenˆtre recouverte
par d'autres.

ParamŠtres : WORD : X de la position donn‚e
             WORD : Y de la position donn‚e
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Handle de la fenˆtre
Pile : 12

/// AES 107 : WIND_UPDATE ///

Sert … signaler … l'AES que vous allez entreprendre la fastidieuse aventure de
travailler sur votre fenˆtre, et qu'il serait souhaitable qu'il ne touche plus
au bureau le temps que vous ayez fini. Permet aussi de prendre le contr“le … la
main de la souris.
C'est utile pour une copie raster dans l'Espace de Travail de la fenˆtre (pour
afficher une image dans une fenˆtre, donc).

ParamŠtres : WORD : Code de commande
                    0 : END_UPDATE : Vous avez fini de travailler, et vous
                                     indiquez … l'AES qu'il peut continuer sont
                                     travail.
                    1 : BEG_UPDATE : Vous commencez, et vous d‚sirer ne plus
                                     voir … l'‚cran un menu s'ouvrir
                                     intempestivement sur votre dessin que vous
                                     ˆtes en train de recopier directement …
                                     l'‚cran (ce qui n'est fortement pas
                                     conseill‚, passez par une fonction du VDI
                                     comme Copy Raster (VDI 109 ou 121).
                    2 : END_MCTRL : Vous avez fini de faire joujou avec la
                                    souris, et vous demandez … l'AES qu'il la
                                    reprenne dans son ‚levage, pour qu'elle
                                    arrˆte de vous couiner dans les oreilles
                    3 : BEG_MCTRL : Vous prennez la souris par la queue, et vous
                                    pouvez l'assaisonner … la sauce APPL_TPLAY,
                                    histoire de lui faire faire un parcours
                                    qu'elle … d‚j… effectu‚e, ou tout autre
                                    chose.
                                      Sert surtout … la bloquer pour ‚viter
                                    qu'elle ne laisse des traces de son passage
                                    sur votre chef-d'oeuvre. En principe, le
                                    tampon ALERT n'est plus en fonction vu que
                                    le GEM est d‚connect‚. Vous pouvez
                                    l'utiliser comme bon vous semble,
                                    th‚oriquement (d'aprŠs Le Livre Du
                                    Developpeur). J'ai jamais tent‚ cet exercice
                                    de haute voltige sans filet, alors
                                    attention. D'ailleurs, justement, ...
                                    ATTENTION : C'est … vous de tout g‚rer, le
                                                GEM est parti en vacance. Les
                                                menus ne marchent plus, la
                                                souris ne r‚pond plus (utilisez
                                                donc votre super routine de
                                                gestion de la souris - Voyez la
                                                LineA).
                                                  N'essayez donc PAS d'attendre
                                                certains messages ou boutons,
                                                vous risqueriez d'attendre
                                                longtemps.
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 10

/// AES 108 : WIND_CALC ///

Sert … demander les dimension d'une fenˆtre, suivant que l'on d‚sire recevoir sa
dimension totale, ou l'espace de travail.
  Peut servir pour recevoir un "devis" sur une nouvelle fenˆtre que l'on
voudrait cr‚er, mais aussi afficher une image avec une copie raster bien pens‚e
(n'oubliez pas de g‚rer correctement les ascenseurs dans ce cas, car la
pr‚cision n'est plus vraiment fiable si vous travaillez avec des images dont la
r‚solution excŠde 1000, la limite de d‚finition de la position d'une cabine).

ParamŠtres : WORD : Code de commande
                    0 : Calcul de la taille de la fenˆtre
                    1 : Calcul de la taille de l'espace de travail
             WORD : Attribut de la fenˆtre … prendre en compte pour le calcul
                    BIT 0 : Barre de Titre
                    BIT 1 : Closer - Bouton au coin sup‚rieur gauche pour
                            fermer la fenˆtre
                    BIT 2 : Fuller - Bouton au coin sup‚rieur droit pour ouvrir
                            la fenˆtre sur tout le bureau
                    BIT 3 : Barre de d‚placement - En fait, la Barre de Titre,
                            mais indique … l'AES que l'on d‚sire que cette
                            fenˆtre soit d‚pla‡able
                    BIT 4 : Info - La ligne d'informations juste sous la Barre
                            de Titre
                    BIT 5 : Sizer - Le bouton au coin inf‚rieur droit pour
                            modifier la taille de la fenˆtre
                    BIT 6 : UpArrow - La flŠche vers le haut
                    BIT 7 : DnArrow - La flŠche vers le bas
                    BIT 8 : VSlide - La "cabine" verticale, ainsi que
                            l'ascenseur
                    BIT 9 : LfArrow - La flŠche vers la gauche
                    BIT A : RtArrow - La flŠche vers la droite
                    BIT B : HSlide - La "cabine" horizontale, ainsi que le
                            couloir
             WORD : X
             WORD : Y
             WORD : Largeur
             WORD : Hauteur
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.l = 0 si erreur, sinon pointeur vers un tableau contenant les
                dimensions demand‚es
                Structure du tableau : WORD 0 : X
                                       WORD 1 : Y
                                       WORD 2 : Largeur
                                       WORD 3 : Hauteur
Pile : 20

/// AES 109 : WIND_NEW ///

Sert … d‚truire toutes les fenˆtres. TrŠs pratique s'il s'agit de quitter le
programme, plus besoin de le faire … la main, pour chaque fenˆtre.

ParamŠtres : LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : Aucun
Pile : 8

--- LIBRAIRIE RESOURCES ---

/// AES 110 : RSRC_LOAD ///

Sert … charger un fichier ressource pr‚alablement cr‚e avec un ‚diteur de
ressources. Ce fichier contient toutes les informations pour exploiter les
Objets qu'il contient. Voici la structure d'une ressource :

> Structure Ressource
  Pas ENCORE document‚, h‚las... (Vite, aidez moi)

ParamŠtres : LONG : Adresse du nom du fichier
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 12

/// AES 111 : RSRC_FREE ///

LibŠre la m‚moire contenant la ressource charg‚e avec RSRC_LOAD. Attention
cependant, car si quitter un programme avec P_TERM(0) libŠre toute la m‚moire
r‚serv‚e par M_(X)ALLOC, quitter le programme ne libŠre pas la m‚moire r‚serv‚e
par RSRC_LOAD (quoique par la pratique, c'est pas si sur que ‡a, … moins qu'il
existe un buffer pour les ressources), donc il faut imp‚rativement invoquer
RSRC_FREE (pas besoin de bougies, de statuettes et de sacrifices pour cela),
avant de quitter proprement l'application en cours.
  En fait, il se trouve que mˆme si on ne fait pas cela, le ressource est
lib‚r‚. Je pense qu'en fait ‡a sert surtout si l'on veut utiliser un autre
ressource (TestSSAV nouvelle version fait ‡a … outrance, celle qui est livr‚e
avec SSAVCALL 1.11, l…, entre vos doigts ‚mus (parce qu'avant, ce n'‚tait qu'un
seul fichier de ressource, mais vu que ORCS me limite … 64Ko, j'ai trouv‚ ce
stratagŠme pour exploser les limites)).
  Avec Appl_Memory, vous n'aurez plus … faire cela, car vous pourrez avoir
jusqu'a seize ressources en m‚moire (oui oui, 16...).

ParamŠtres : LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 8

/// AES 112 : RSRC_GADDR ///

Sert … obtenir l'adresse d'un Objet, d'un arbre, d'une structure, ou de tout
autre chose ayant une relation (intime) avec les Objets du GEM.

ParamŠtres : WORD : Type d'Objet recherch‚
                     0 : R_TREE : Adresse d'un Arbre
                                  Les Boites et les Menus font partis de cette
                                  grande famille.
                     1 : R_OBJECT : Adresse d'un Objet
                     2 : R_TEDINFO : Adresse d'une TedInfo
                     3 : R_ICONBLK : Adresse d'une IconBlk
                     4 : R_BITBLK : Adresse d'une BitBlk
                     5 : R_STRING : Adresse d'une String ou chaŒne Free
                                    Les boites d'Alertes, par exemple
                     6 : R_IMAGEDATA : Adresse d'une Image Free
                     7 : R_OBSPEC : Adresse d'une Ob_Spec
                     8 : R_TEDTEXT : Adresse de l'adresse de TE_PTEXT
                     9 : R_TEDTMPLT : Adresse de l'adresse de TE_PTMPLT
                    10 : R_TEPVALID : Adresse de l'adresse de TE_PVALID
                    11 : R_IBPMASK : Adresse de l'adresse de IB_PMASK
                    12 : R_IBPDATA : Adresse de l'adresse de IB_PDATA
                    13 : R_IBPTEXT : Adresse de l'adresse de IB_PTEXT
                    14 : R_BIPDATA : Adresse de l'adresse de BI_PDATA
                    15 : R_FRSTR : Adresse de l'adresse d'une chaŒne Free
                    16 : R_FRIMG : Adresse de l'adresse d'une image Free
             WORD : Num‚ro d'ordre de l'Objet dans sa famille. C'est un coup de
                    force de "finesse" de la part de Digital Research, car il
                    n'existe pas de fonction pour d‚finir ce num‚ro. En fait, il
                    s'agit du num‚ro d'apparition de ce type d'Objet dans le
                    fichier.
                      A vous donc de savoir combien vous en avez mis dans le
                    premier arbre, dans le deuxiŠme, etc.. pour vous y
                    retrouver. Du coup, vous ˆtes largue-z, et pour trouver ce
                    fichus Objet, vous z'ˆtes perdu...
                      Disons, vous ne pouvez plus demander au GEM de le faire,
                    et cet Objet prend une position "absolue", car si l'on
                    modifie un temps soit peu le fichier ressource, et pas votre
                    programme, ‡a plante car les positions pr‚alablement
                    d‚finies ne correspondent plus. Cet Objet devra toujours
                    ˆtre o— il est, sans que ses attributs ne puissent ˆtres
                    modifi‚s (pas les graphiques, mais disons parental).
                      C'est pour cela que je suis en train de mettre au point
                    OBJC_SEARCH, une version plus conviviale de cette fonction.
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.l = 0 si erreur, sinon adresse recherch‚e
Pile : 12

/// AES 113 : RSRC_SADDR ///

Sert … changer d'adresse une structure. Attention … ne pas faire de bˆtise, car
l'AES risque de ne pas appr‚cier s'il venait … rencontrer une structure non
standard, et … faire plein de petites bˆtises, ce qui risque fort de vous
contrarier. Zut alors...
  S‚rieusement : Peut, par exemple, changer l'adresse d'un arbre, et le
rediriger vers un que vous venez de faire … la main. C'est trŠs utile pour les
cr‚ateur le ressource (vous savez, les "Ressource Construction Set").
  Faites cependant attention … que les adresses soient relog‚es en absolue, et
d‚signent v‚ritablement l'adresse d'un objet en m‚moire. Ici, l'adressage
relatif au PC (quelque chose de similaire, ‚videment) est impossible (ce serait
vraiment, vraiment trop beau).

ParamŠtres : WORD : Type d'Objet … changer
                     0 : R_TREE : Arbre d'Objets
                     1 : R_OBJECT : Objet
                     2 : R_TEDINFO : TedInfo
                     3 : R_ICONBLK : IconBlk
                     4 : R_BITBLK : BitBlk
                     5 : R_STRING : String ou chaŒne Free
                     6 : R_IMAGEDATA : Image Free
                     7 : R_OBSPEC : Ob_Spec
                     8 : R_TEDTEXT : Adresse de TE_PTEXT
                     9 : R_TEDTMPLT : Adresse de TE_PTMPLT
                    10 : R_TEPVALID : Adresse de TE_PVALID
                    11 : R_IBPMASK : Adresse de IB_PMASK
                    12 : R_IBPDATA : Adresse de IB_PDATA
                    13 : R_IBPTEXT : Adresse de IB_PTEXT
                    14 : R_BIPDATA : Adresse de BI_PDATA
                    15 : R_FRSTR : Adresse d'une chaŒne Free
                    16 : R_FRIMG : Adresse d'une image Free
             WORD : Num‚ro d'ordre de l'Objet dans sa famille.
             LONG : Adresse … fixer
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 16

/// AES 114 : RSRC_OBFIX ///

Sert … convertir les coordonn‚es et la taille d'un objet dont elles sont
exprim‚es en caractŠres, en points. C'est utile, car dans ce cas, les Objets
changent de taille suivant la r‚solution, et s'y adaptent.
Nez en moins, ce n'est pas tout … fait grƒce cela que je convertit les
coordonn‚es et tailles avec CONV_RSC2WK.
Lors d'un chargement d'une ressource, RSRC_LOAD s'en charge (c'est le cas de le
dire) d‚j….

ParamŠtres : LONG : Adresse de l'arbre
             WORD : Num‚ro de l'Objet … convertir
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : Aucun
Pile : 14

/// AES 115 : RSRC_RCFIX ///

(Pas document‚, mais implant‚)

ParamŠtres : LONG : Handle
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Int_Out0
Pile : 12

--- LIBRAIRIE SHELL ---

/// AES 120 : SHEL_READ ///

Je ne peut h‚las vous expliquer, car j'ai absolument rien pig‚. Quelqu'un peut
m'expliquer sans faire de chichi, simplement? Ce serait vachement cool.
Ces fonctions sont bien ‚videments implant‚es.
  Je n'ose plus entreprendre la m‚thode empirique, car j'en suis … pr‚sent … mon
deuxieme crash de disque dur en deux mois (oui Stabilo, encore un...). Mais
qu'elle id‚e de reprendre un vieux projet sans docs fiables...
Celles dont je dispose sur le GEM ne le sont pas toujours, alors je prend des
pr‚cautions, car y'en a marre de perdre r‚gulierement des projet pour ne pas les
avoirs sauvegard‚s assez r‚gulierement (les disquettes, ‡a coute cher et c'est
lent...). Mais bon, ‡a fait parti de ma politique, et je n'ai pas … m'en
plaindre (NdM: en pricipe non).

ParamŠtres : LONG : Adresse de la commande
             LONG : Adresse des fonctions compl‚mentaires
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 16

/// AES 121 : SHEL_WRITE ///

(Pas document‚, mais implant‚)

ParamŠtres : WORD : Mode d'action
                    0 = Retour au bureau
                    1 = Lancer le programme d‚sign‚ par la commande
             WORD : Mode graphique de l'application
                    0 = Application non GEM
                    1 = Application GEM
             WORD : R‚serv‚
             LONG : Adresse de la commande
             LONG : Adresse des fonctions compl‚mentaires
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 22

/// AES 122 : SHEL_GET ///

(Pas document‚, mais implant‚)

ParamŠtres : LONG : Adresse du tampon
             WORD : Nombre de caractŠres … lire
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 14

/// AES 123 : SHEL_PUT ///

(Pas document‚, mais implant‚)

ParamŠtres : LONG : Adresse du tampon
             WORD : Nombre de caractŠres … lire
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 14

/// AES 124 : SHEL_FIND ///

(Pas document‚, mais implant‚)

ParamŠtres : LONG : Adresse du nom du fichier
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = 0 si erreur, sinon OK
Pile : 12

/// AES 125 : SHEL_ENVRN ///

(Pas document‚, mais implant‚)

ParamŠtres : LONG : Adresse d'un tampon de 4 OCTETs pour recevoir un pointeur
             LONG : Adresse de la chaŒne du critŠre de recherche
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : Aucun
Pile : 16

--- LIBRAIRIE APPLICATIONS (SUITE) ---

/// AES 130 : APPL_GETINFO ///

(Pas document‚, mais implant‚)

ParamŠtres : WORD : Type
             LONG : Adresse du buffer des variables (AES_PARAMS)
Retour : D0.w = Int_Out0
Pile : 10

/// (AES 131 X : APPL_MEMORY V1.00, en cours de d‚veloppement) ///

Gestion ‚tendue de la m‚moire. Se base sur l'excellent Memory Manager de Parx,
mais comme chaque copie d'une bonne id‚e, apporte de (trŠs) nombreuses
modifications et notables am‚liorations.
  Cependant, que PARX ne s'inquiŠte pas, cette fonction n'a pas ‚t‚ implant‚e
pour concurrencer la leur, mais pour pouvoir utiliser facilement plusieurs
ressources et modules d'extension en mˆme temps.

*** V D I (115) ***

Les fonctions VDI peuvent mettre mal … l'aise ceux qui sont habitu‚s … utiliser
l'AES car elle ne sont pas class‚es par num‚ro croissant, et qu'elles sont d'un
utilisation diff‚rente, mais il faut vous y faire. Ici, on se repose d‚j… moins
sur le bon vouloir du GEM, et l'on exploite des fonctions un peu plus "terre …
terre", mais trŠs utiles...
En dehors du fouillis apparent, les fonctions du VDI sont en fait class‚es en
familles.
N'oubliez pas que ici, ce n'est plus largeur et hauteur, mais un deuxiŠme
couple de coordonn‚es qui est utilis‚ (attendez, vous allez comprendre … la
lecture).

--- FONCTIONS DE CONTROLE ---

/// VDI 1 : V_OPNWK (OPEN WORKSTATION) ///

Ouvre une station de travail limit‚e … l'‚cran. De plus on peut d‚finir le
systŠme de coordonn‚es.
En soit, n'essayez pas d'utiliser cette fonction, car voyez vous, en utilisant
le GEM, vous travaillez d‚j… sur une station de travail. En ouvrir une seconde,
mat‚rielle, planterais l'ordinateur.
Pour vos station, utilisez les virtuelles.
  Cependant si, par exemple, comme moi, vous avez ‚crit un shell qui change de
r‚solution pour s'adapter … celle du programme que l'on veut lancer, il s'agit
d'effacer la station de travail actuelle, et d'en rouvrir une, adapt‚e.
Si vous ne faites pas cela, et vous contentez de changer de r‚solution avec
V_SetScreen (XBIOS 5), vous aurez des surprises … l'utilisation du GEM. Par
exemple, vous passez de haute … basse r‚solution. L'ouverture d'un FileSelect
se fera en bas … droite, aux coordonn‚es o— il se serait affich‚ en haute
r‚solution, et la fonte est en 16*8. Compris?

ParamŠtres : WORD : Num‚ro du p‚riph‚rique
             WORD : Type de ligne (Voir VDI 15)
             WORD : Index de couleur des lignes PolyLine (Voir VDI 17)
             WORD : Type de marqueur (Voir VDI 18)
             WORD : Index de couleur des marqueur PolyMarker (Voir VDI 20)
             WORD : Fonte de caractŠre
             WORD : Index de couleur du texte (1 en g‚n‚'al, pou' le noi')
             WORD : Style de remplissage
             WORD : Num‚ro du style de remplissage
             WORD : Index de couleur du remplissage
             WORD : SystŠme de coordonn‚es
                    0 = NDC. SystŠme standard dont l'origine se trouve en bas …
                             gauche. De plus, les coordonn‚es son fix‚es de 0 …
                             32767 dans les deux directions. Utile si l'on veut
                             exploiter une table tra‡ante par exemple, ou tout
                             autre chose.
                    1 = R‚serv‚
                    2 = RC. Comme l'‚cran. L'origine se situe en haut … gauche.
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = VDI_ID
         D1.l = Pointeur vers un tableau contenant toutes les informations
                relatives aux p‚riph‚riques actuels et standards.
                Structure du tableau : WORD  0 : Largeur de l'‚cran en point
                                                 (639 en ST High)
                                      WORD  1 : Hauteur de l'‚cran en points
                                      WORD  2 : Pr‚cision du p‚riph‚rique
                                                0 = Pr‚cis
                                                1 = Impr‚cis
                                      WORD  3 : Largeur d'un point en microns
                                      WORD  4 : Hauteur d'un point en microns
                                      WORD  5 : Nombre de tailles d'‚criture
                                                disponibles
                                                0 = Y'a pas (NdM : C'est
                                                possible ‡a?)
                                      WORD  6 : Nombre de types de ligne
                                                disponibles
                                      WORD  7 : Nombre de largeurs de ligne
                                                disponibles
                                                0 = Y'a toujours pas (NdM :
                                                    Huu..?)
                                      WORD  8 : Nombre de types de marqueur
                                                disponibles
                                      WORD  9 : Nombre de tailles de marqueur
                                                disponibles
                                                0 = C'est une manie ou quoi, y'a
                                                    rien? T'es sur qu'il marche
                                                    ton ordinateur?
                                      WORD 10 : Nombre de fontes disponibles
                                      WORD 11 : Nombres de motifs de remplissage
                                      WORD 12 : Nombre de types de hachures
                                      WORD 13 : Nombre de couleurs affichables
                                      WORD 14 : Nombre de GDP (VDI 11)
                                      WORD 15 : Liste des dix GDP de bases
                                                1 = Barre
                                                2 = Arc de cercle
                                                3 = Section de cercle
                                                4 = Cercle
                                                5 = Ellipse
                                                6 = Arc d'ellipse
                                                7 = Section d'ellipse
                                                8 = Rectangle … coins arrondis
                                                9 = Rectangle rempli … coins
                                           …        arrondis
                                                10 = Texte graphique
                                      WORD 24 : -1 = Fin de la liste
                                      WORD 25 : Attributs correspondants …
                                                chaque GDP
                                                0 = Lignes multiples (GDP 2, 6,
                                                    8)
                                                1 = Marqueurs multiples
                                                2 = Texte (GDP 10)
                                           …    3 = Surface remplie (GDP 1, 3,
                                                    4, 5, 7, 9)
                                      WORD 34 : 4 = Que dalle
                                      WORD 35 : Couleur
                                                0 = Non
                                                1 = Oui
                                      WORD 36 : Rotation du texte possible
                                                0 = Non
                                                1 = Oui
                                      WORD 37 : Remplissage possible
                                                0 = Non
                                                1 = Oui
                                      WORD 38 : Fonction de cellules (VDI 10)
                                                possible
                                                0 = Non
                                                1 = Oui
                                      WORD 39 : Nombre de couleurs dans la
                                                palette
                                                0 = True Color
                                                2 = Monochrome, sinon le nombre
                                                    de couleur dans la palette
                                                    (512 pour un ST, 4096 pour
                                                    un STe et TT, 262144 pour le
                                                    Falcon)
                                      WORD 40 : Controle du pointeur de la
                                                souris
                                                1 = Clavier seulement
                                                2 = Clavier et autre chose (la
                                                    souris peut ˆtre...)
                                      WORD 41 : P‚riph‚rique d'entr‚e
                                                1 = Clavier
                                                2 = Autre (???)
                                      WORD 42 : Touches sp‚ciales
                                                1 = Touches de fonctions
                                                2 = Autre
                                      WORD 43 : P‚riph‚rique AlphaNum‚rique
                                                0 = Aucun (votre clavier est il
                                                    bien branch‚?)
                                                1 = Sir Clavier (non, pas toi
                                                    Christian...)
                                      WORD 44 : Type de station de travail
                                                0 = Sortie seule (‚cran)
                                                1 = Entr‚e seule (...)
                                                2 = Entr‚e et sortie (‚cran
                                                    tactile peut ˆtre)
                                                3 = MetaFile (fichier GEM)
         D2.l = Pointeur vers un tableau contenant les informations de sortie
                texte actuel.
                Structure du tableau : WORD  0 : Largeur minimale d'un caractŠre
                                       WORD  1 : Hauteur minimale d'un caractŠre
                                       WORD  2 : Largeur maximale d'un caractŠre
                                       WORD  3 : Hauteur maximale d'un caractŠre
                                       WORD  4 : Largeur minimale d'une ligne
                                       WORD  5 : R‚serv‚ (… 0)
                                       WORD  6 : Largeur maximale d'une ligne
                                       WORD  7 : R‚serv‚ (… 0)
                                       WORD  8 : Largeur minimale d'un marqueur
                                       WORD  9 : Hauteur minimale d'un marqueur
                                       WORD 10 : Largeur maximale d'un marqueur
                                       WORD 11 : Hauteur maximale d'un marqueur
Pile : 30

/// VDI 2 : V_CLSWK (CLOSE WORKSTATION) ///

Ferme une station de travail.

ParamŠtres : WORD : VDI_ID de la station … fermer (quoi, d‚j… 22H? j'ai encore
                    un m‚tro … prendre).
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 10

/// VDI 100 : V_OPNVWK (OPEN VIRTUAL WORKSTATION) ///

Comme VDI 1, Open WorkStation, mais ici, on peu en ouvrir plusieurs, et
chaqu'une est ind‚pendante des autres. On peut ainsi d‚finir des attributs
diff‚rents pour chaque station virtuelle. Les paramŠtres d'entr‚e et de sortie
sont identiques … ceux de Open WorkStation, la diff‚rence ‚tant un paramŠtre en
plus : le code du p‚riph‚rique. Celui ci est en principe le num‚ro d'un
p‚riph‚rique physique (0 … 5).
  Cependant, il s'agit de l'ouvrir comme ‚tant l'‚cran. Dans ce cas, vous
l'initialisez avec les paramŠtres de l'‚cran en cours.

ParamŠtres : WORD : Code du p‚riph‚rique
                      0 = Clavier
                      1 = Ecran
                      2 = Port S‚rie
                      3 = Port ParallŠle
                      4 =
                      5 =
             WORD : Num‚ro du p‚riph‚rique
             WORD : Type de ligne (Voir VDI 15)
             WORD : Index de couleur des lignes PolyLine (Voir VDI 17)
             WORD : Type de marqueur (Voir VDI 18)
             WORD : Index de couleur des marqueur PolyMarker (Voir VDI 20)
             WORD : Fonte de caractŠre
             WORD : Index de couleur du texte (1 en gˆn‚'al, pou' le noi')
             WORD : Style de remplissage
             WORD : Num‚ro du style de remplissage
             WORD : Index de couleur du remplissage
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Voyez Open WorkStation
Pile : 30

/// VDI 101 : V_CLSVWK (CLOSE VIRTUAL WORKSTATION) ///

Ferme une station de travail virtuelle.

ParamŠtres : WORD : VDI_ID de la station virtuelle … fermer
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 10

/// VDI 3 : V_CLRWK (CLEAR WORKSTATION) ///

D‚truit la station de travail, donc vide l'‚cran (comme aprŠs un V_SetScreen
(XBIOS 5)).

ParamŠtres : WORD : VDI_ID de la station de travail … d‚truire
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 10

/// VDI 4 : V_UPDWK (UPDATE WORKSTATION) ///

Sert … forcer la sortie graphique sur la station de travail demand‚e. Sur un
‚cran, n'a aucun effet car la sortie graphique est imm‚diate, mais sur une
imprimante, ou une table tra‡ante, sort imm‚diatement les donn‚es du tampon
graphique (ne vous en inqui‚tez pas, je ne sait pas ce que c'est, mais c'est
‚crit (une preuve incontestable que certains ‚diteurs veulent vraiment nous
prendre le choux et passer pour des omniscient)).
Pour faire un saut de page, faites un Clear WorkStation aprŠs cette fonction.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 10

/// VDI 119 : VST_LOAD_FONTS (LOAD FONTS) ///

Charge des fontes externes. GDOS doit donc ˆtre install‚ (ou quelque chose de
similaire).

ParamŠtres : WORD : VDI_ID
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Nombre de fontes charg‚es
Pile : 10

/// VDI 120 : VST_UNLOAD_FONTS (UNLOAD FONTS) ///

Demande d'effacer les fontes charg‚es. Cela ne se fera v‚ritablement que
lorsque toutes les stations utilisant les mˆmes fontes l'auront demand‚es, ou
que celles ci soient ferm‚es.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 10

/// VDI 129 : VS_CLIP (SET CLIPPING RECTANGLE) ///

Le CLIPPING, on y arrive. Certains d'entre vous se sont peut ˆtre d‚j… rong‚s
les ongles jusqu'a l'os, d'angoisse, … la simple ‚vocation de cette ... chose.
Et bien voila, le CLIPPING, c'est pas sorcier, les tagueur savent tous ce que
c'est : c'est juste un pochoir. Disons qu'il est tout de mˆme un peu
particulier. Avec les coordonn‚es pr‚cis‚es, le GEM va cr‚er une sorte de
pochoir logique … l'‚cran, et c'est seulement ce qui sera dessin‚ dans ce
rectangle qui sera v‚ritablement autoris‚ … apparaŒtre. Ainsi, le reste
n'apparaŒt pas. C'est trŠs utile dans les programmes de dessins, o— vous faites
un CLIPPING sur l'int‚rieur de la fenˆtre (la zone de travail, ‡a vous rappel
quelque chose?), et c'est seulement dans cette zone qu'apparaŒtra votre dessin,
sans qu'il aille couler partout. Et c'est seulement ce rectangle que le GEM vous
demandera, ou le fera lui mˆme, de redessiner.
Alors, qui a dit que le GEM est compliqu‚, "que je le fra-ca-sse..." (½ Ellie
Kakou)

ParamŠtres : WORD : VDI_ID
             WORD : Mode
                    0 = On peut taguer partout (mais pas sur les murs de votre
                        chambre SVP, je ne tiens pas … avoir des maux avec vos
                        parents).
                    1 = Le CLIPPING est actif
             WORD : X1 (en haut … gauche)
             WORD : Y1 (Idem)
             WORD : X2 (en bas … droite)
             WORD : Y2 (Idem)
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 20

--- FONCTIONS D'EDITION ---

/// VDI 6 : V_PLINE (POLYLINE) ///

Dessine une "souite" de lignes dont la suivante commence o— la pr‚c‚dente se
termine. Les attributs suivants sont pris en compte : Couleur
                                                      Type
                                                      Epaisseur
                                                      Style
                                                      Mode

ParamŠtres : WORD : VDI_ID
             WORD : Nombre de points. Vu que la premiŠre ligne est d‚finie par
                    deux points, et que les suivantes n'utilisent plus qu'un
                    seul, Nombre de points-1 donne le nombre de lignes …
                    afficher.
             LONG : Adresse des coordonn‚es des points. Ceux ci doivent ˆtres
                    compos‚s de la coordonn‚e X sur un WORD, suivit de la
                    coordonn‚e Y sur un WORD, et ainsi de suite.
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 16

/// VDI 7 : V_PMARKER (POLYMARKER) ///

Place plusieurs marqueurs … l'‚cran. Ces marqueurs peuvent servirent par exemple
au points de passage d'une courbe de b‚zier dans un programme de dessin. Les
attributs suivants sont pris en compte : Couleur
                                         Echelle
                                         Type
                                         Mode

ParamŠtres : WORD : VDI_ID
             WORD : Nombre de marqueurs.
             LONG : Adresse des coordonn‚es des marqueurs. Mˆme remarque que
                    pr‚cedemment.
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 16

/// VDI 8 : V_GTEXT (TEXT) ///

Sert … afficher un texte graphique. Sa particularit‚ est qu'il peut ˆtre plac‚
au pixel prŠs, d'une fonte diff‚rente, et des attributs diff‚rents.
N'oubliez pas le Clipping, comme toutes les autres fonctions graphique.

ParamŠtres : WORD : VDI_ID
             WORD : Nombre de caractŠre … afficher
             WORD : X
             WORD : Y
             LONG : Adresse du texte … afficher, au format C normal!
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 20

/// VDI 9 : V_FILLAREA (FILLED AREA) ///

Sert … tracer un polygone complexe (convexe, concave), et … le remplir suivant
les attributs de couleur, de style d‚finis … l'ouverture de la station de
travail (par d‚fauts), ou d‚finit ult‚rieurement par l'utilisateur.

ParamŠtres : WORD : VDI_ID
             WORD : Nombre de points
             LONG : Adresse des coordonn‚es des points. Comme d'hab, le X sur
                    un WORD, ainsi que le Y, puis on continue.
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 16

/// VDI 10 : V_CELLARRAY (CELL ARRAY) ///

(Pas document‚, mais implant‚)

ParamŠtres : WORD : VDI_ID
             WORD : Longueur du tableau des couleurs
             WORD : Longueurs des lignes du tableau des couleurs
             WORD : Nombre de couleurs par lignes
             WORD : Nombre de lignes dans le tableau
             WORD : Mode d'‚criture (Voyez VDI)
             LONG : Adresse du tableau des couleurs
                    Chaque index de la couleur tiens sur un WORD
             WORD : X du coin inf‚rieur gauche
             WORD : Y du coin inf‚rieur gauche
             WORD : X du coin sup‚rieur droit
             WORD : Y du coin sup‚rieur droit
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 32

/// VDI 103 : V_CONTOURFILL (CONTOUR FILL) ///

Remplit une surface … partir d'un points.

ParamŠtres : WORD : VDI_ID
             WORD : Index de la couleur d'arrˆt. Si -1 est mis ici, le VDI
                    s'arrˆte … toutes les couleurs diff‚rentes du points de
                    d‚part. De plus, le VDI s'arrˆte au bords de l'‚cran.
             WORD : X
             WORD : Y
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 16

ATTENTION : Cette fonction est bugg‚e dans le TOS 4. PARX a d‚velopp‚ un patch
            (qui ne marche pas sous D2M, un de leurs soft...), ainsi que Seb des
            Removers (une pub vraiment gratuite).

/// VDI 114 : VR_RECTFL (FILL RECTANGLE) ///

Sert … afficher un rectangle remplit des attributs d‚finis.

ParamŠtres : WORD : VDI_ID
             WORD : X1 (souvent en haut … gauche, mais pas oblig‚)
             WORD : Y1 (Idem)
             WORD : X2 (l'oppos‚ par la diagonale au premier points, c'est le
                    VDI qui l'a d‚cid‚)
             WORD : Y2 (Idem)
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 18

--- FONCTIONS ESCAPE (SORTIE TEXTE) ---

Les fonctions Escapes ne servent qu'a sortir du texte. La particularit‚ de ces
fonctions c'est qu'en fait, c'est les sorties de texte du BIOS, mais dont les
appels sont au format VDI.
Avec ces fonctions, vous perdez en pr‚cision : vous ne pouvez plus ‚crire au
pixel prŠs, mais revenez … la notion de ligne et colonne. N‚anmoins vous gagnez
en rapidit‚ car ces fonctions sont trŠs rapides, par rapport … l'utilisation du
mode graphique (au pixel prŠs).
De plus, ces fonctions ‚tant officielles, elles risquent fort d'ˆtres support‚es
dans les version ult‚rieures des systŠmes d'exploitation des compatibles ATARI
(je pense … Dolmen du prochain Centek's Ph‚nix, car j'essaye de programmer
compatible, m“a...).

ATTENTION : pour les fonctions ESC(5) et GDP(11), le num‚ro de la sous fonction
            est … empiler AVANT l'adresse de VDI_Params.

/// VDI 5,1 : INQUIRE ADDRESSABLE ALPHA CHARACTER CELLS ///

Sert … savoir de combien de lignes et de colonnes est compos‚ l'‚cran.

ParamŠtres : WORD : VDI_ID
             WORD : 1
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Nombre de lignes.w et Nombre de colonnes.w
Pile : 12

/// VDI 5,2 : EXIT ALPHA MODE ///

Sert … sortir du mode alphanum‚rique. Le curseur disparaŒt, et le GEM reprend
la main et vous rend la souris, ainsi que son pointeur.

ParamŠtres : WORD : VDI_ID
             WORD : 2
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 5,3 : ENTER ALPHA MODE ///

Sert … p‚n‚trer (Rrhooo...) le mode alphanum‚rique. La souris cŠde sa place au
curseur.

ParamŠtres : WORD : VDI_ID
             WORD : 3
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 5,4 : ALPHA CURSOR UP ///

Fait monter le curseur d'une ligne vers le haut. S'il y est d‚j…, il y reste.
C'est exactement la mˆme chose que le code VT52 EscA. Mais n'oubliez pas que
ici il est question du p‚riph‚rique d‚finit.

ParamŠtres : WORD : VDI_ID
             WORD : 4
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 5,5 : ALPHA CURSOR DOWN ///

Fait descendre le curseur d'une ligne. S'il se trouve au rez de chauss‚, il y
reste sans descendre … la cave. Idem que EscB.

ParamŠtres : WORD : VDI_ID
             WORD : 5
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 5,6 : ALPHA CURSOR RIGHT ///

Le curseur se d‚place d'un coup … droite. s'il est au bout, il y reste. Idem
que EscC.

ParamŠtres : WORD : VDI_ID
             WORD : 6
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 5,7 : ALPHA CURSOR LEFT ///

La mˆme chose, mais vers la gauche. Idem que EscD.

ParamŠtres : WORD : VDI_ID
             WORD : 7
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 5,8 : HOME ALPHA CURSOR ///

Fait revenir le curseur tout en haut … gauche (position Home). Pareil que EscH.

ParamŠtres : WORD : VDI_ID
             WORD : 8
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 5,9 : ERASE TO END OF ALPHA SCREEN ///

Vide l'‚cran depuis le curseur inclus, jusqu'a la fin. Idem que EscJ

ParamŠtres : WORD : VDI_ID
             WORD : 9
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 5,10 : ERASE TO END OF ALPHA TEXT LINE ///

Vide la ligne depuis le curseur inclus, jusqu'a la fin. Idem que EscK.

ParamŠtres : WORD : VDI_ID
             WORD : 10
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 5,11 : DIRECT ALPHA CURSOR ADDRESS ///

Positionne le curseur … un endroit pr‚cis. Si les coordonn‚es pr‚cis‚es sont
excessives, celles ci son ramen‚es au maximum permit, c'est … dire la ligne
maximum ou la colonne maximum. Idem que EscY

ParamŠtres : WORD : VDI_ID
             WORD : Num‚ro de la ligne
             WORD : Num‚ro de la colonne
             WORD : 11
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 16

/// VDI 5,12 : OUTPUT CURSOR ADDRESSABLE ALPHA TEXT ///

Sort une chaŒne de caractŠres. Idem que C_CONWS (GEMDOS 9).

ParamŠtres : WORD : VDI_ID
             WORD : Nombre de caractŠre … sortir
             LONG : Adresse du texte
             WORD : 12
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 18

/// VDI 5,13 : REVERSE VIDEO ON ///

Passe en inverse vid‚o. L'‚criture passe en blanc, et le fond en noir. Idem que
Escp.

ParamŠtres : WORD : VDI_ID
             WORD : 13
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 5,14 : REVERSE VIDEO OFF ///

Revient en ‚criture normale. Idem que Escq.

ParamŠtres : WORD : VDI_ID
             WORD : 14
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 5,15 : INQUIRE CURRENT ALPHA CURSOR ADDRESS ///

Sert … obtenir la position actuelle du curseur.

ParamŠtres : WORD : VDI_ID
             WORD : 15
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l : Num‚ro de ligne.w et Num‚ro de colonne.w
Pile : 12

/// VDI 5,16 : INQUIRE TABLET STATUS ///

Sert … savoir si y'a quelque chose de connect‚ au clavier (joystick, souris).
Et pas de tablettes, comme certains se plaisent … nommer ces p‚riph‚riques.
Il y a un test … l'allumage de votre ATARI-BRANDT-BOSCH-CITROEN pour savoir
cela, donc, THEORIQUEMENT, si vous rebranchez votre clavier aprŠs l'allumage de
votre ordinateur, il ne devrait pas remarquer le changement. Cela car
l'initialisation du 6301 se fait au boot (la cause du bug du 6301 si vous
gardez les deux boutons de la souris enfonc‚slors du boot).
Mais bon, qui s'amuse … brancher son clavier aprŠs avoir allum‚ son ST...

ParamŠtres : WORD : VDI_ID
             WORD : 16
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = 0 : Y'a rien
                1 : Y'a quelque chose
Pile : 12

/// VDI 5,17 : HARD COPY ///

Balance le contenu de l'‚cran sur l'imprimante. Ne marche qu'en ST High.
N‚anmoins, rien ne vous empˆche de faire une routine de tramage, et
d'impression se r‚f‚rent … des modules (Speedo?). Le processeur saute … $502.w.
Mais chut, je n'ait rien dit...

ParamŠtres : WORD : VDI_ID
             WORD : 17
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 5,18 : PLACE GRAPHIC CURSOR AT LOCATION ///

Fait apparaŒtre le pointeur de la souris au cas o— l'on avait demand‚
pr‚c‚demment de le faire disparaŒtre.

ParamŠtres : WORD : VDI_ID
             WORD : X
             WORD : Y
             WORD : 18
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 16

/// VDI 5,19 : REMOVE LAST GRAPHIC CURSOR ///

Fait disparaŒtre le pointeur de la souris. TrŠs utile lorsque l'on d‚cide
d'aller dessiner dans une fenˆtre.

ParamŠtres : WORD : VDI_ID
             WORD : 19
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

--- FONCTIONS GRAPHIQUES (PRIMITIVES) ---

C'est les ‚l‚ments de base du graphisme. D‚brouillez vous...

/// VDI 11,1 : V_BAR (BAR) ///

Sert … afficher une barre. En fait, il s'agit d'une ligne dont l'attribut
d'‚paisseur est pris en compte. Y'a aussi : Motif de remplissage
                                            Mode
                                            Couleur
                                            P‚rimŠtre

ParamŠtres : WORD : VDI_ID
             WORD : X1
             WORD : Y1
             WORD : X2
             WORD : Y2
             WORD : 1
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 20

/// VDI 11,2 : V_ARC (ARC) ///

Sert … dessiner un arc de cercle, et non pas d'ellipse. Les attributs sont pris
en compte : Motif de remplissage
            Mode
            Couleur
            P‚rimŠtre

ParamŠtres : WORD : VDI_ID
             WORD : Angle de d‚part. N'oubliez pas que l'on est dans le
                    r‚f‚rentiel trigonom‚trique. Donc 0 c'est trois heures, 90
                    c'est midi, 180 c'est neuf heures, et 270 c'est six heures.
                    Doit ˆtre exprim‚ en dixiŠme de degr‚.
                    V‚rifiez cependant que le systŠme peut utiliser les dixiŠmes
                    de degr‚, ou est limit‚ au pas de 90 degr‚s (voyez VDI 102).
             WORD : Angle de fin. Idem
             WORD : X du centre
             WORD : Y du centre
             WORD : Rayon
             WORD : 2
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 22

/// VDI 11,3 : V_PIESLICE (PIE) ///

C'est presque pareille qu'avant, mais au lieu d'avoir juste un cercle, vous
avez la fameuse part de camembert.

ParamŠtres : WORD : VDI_ID
             WORD : Angle de d‚part.
             WORD : Angle de fin.
             WORD : X du centre
             WORD : Y du centre
             WORD : Rayon
             WORD : 3
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 22

/// VDI 11,4 : V_CIRCLE (CIRCLE) ///

Un cercle, simplement.

ParamŠtres : WORD : VDI_ID
             WORD : X du centre
             WORD : Y du centre
             WORD : Rayon
             WORD : 4
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 18

/// VDI 11,5 : V_ELLIPSE (ELLIPSE) ///

Une ellipse. C'est un cercle quelque peu d‚form‚.

ParamŠtres : WORD : VDI_ID
             WORD : X du centre
             WORD : Y du centre
             WORD : Rayon horizontal
             WORD : Rayon vertical
             WORD : 5
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 20

/// VDI 11,6 : V_ELLARC (ELLIPTICAL ARC) ///

Hybride entre l'Arc et l'Ellipse.

ParamŠtres : WORD : VDI_ID
             WORD : Angle de d‚part
             WORD : Angle de fin
             WORD : X du centre
             WORD : Y du centre
             WORD : Rayon horizontal
             WORD : Rayon vertical
             WORD : 6
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 24

/// VDI 11,7 : V_ELLPIE (ELLIPTICAL PIE) ///

Hybride entre le Camembert et l'Ellipse (Beurk...)

ParamŠtres : WORD : VDI_ID
             WORD : Angle de d‚part
             WORD : Angle de fin
             WORD : X du centre
             WORD : Y du centre
             WORD : Rayon horizontal
             WORD : Rayon vertical
             WORD : 7
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 22

/// VDI 11,8 : V_RBOX (ROUNDED RECTANGLE) ///

Rectangle aux coins arrondis.

ParamŠtres : WORD : VDI_ID
             WORD : X1 (en bas … gauche cette fois)
             WORD : Y1 (Idem)
             WORD : X2 (en haut … droite)
             WORD : Y2 (Idem)
             WORD : 8
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 20

/// VDI 11,9 : V_RFBOX (FILLED ROUNDED RECTANGLE) ///

Rectangle aux coins arrondis, et rempli.

ParamŠtres : WORD : VDI_ID
             WORD : X1 (en bas … gauche cette fois)
             WORD : Y1 (Idem)
             WORD : X2 (en haut … droite)
             WORD : Y2 (Idem)
             WORD : 9
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 20

/// VDI 11,10 : V_JUSTIFIED (JUSTIFIED GRAPHICS TEXT) ///

Sert … sortir un texte format‚ justifi‚. On peut ainsi d‚finir sur quelle
longueur il aura le droit (et non pas le gauche) de s'‚taler.

ParamŠtres : WORD : VDI_ID
             WORD : Nombre de caractŠres … afficher
             WORD : Espacement entre les mots. C'est le VDI qui va d‚cider de
                    combien d'espace il va rajouter entre les mots pour faire
                    remplir l'espace demand‚ par le texte.
                    0 = Aucun
                    1 = Autoris‚
             WORD : Espacement entre les lettres. Idem.
                    0 = Aucun
                    1 = Autoris‚
             LONG : Adresse du texte … afficher
             WORD : X de d‚part du texte
             WORD : Y de d‚part du texte
             WORD : Longueur horizontale demand‚e
             WORD : 10
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 28

--- FONCTIONS COMPLEMENTAIRES ---

/// VDI 12 : VST_HEIGH (SET CHARACTER HEIGHT - ABSOLUTE MODE) ///

Sert … d‚finir la taille d'une cellule de caractŠre.
  Pour les fontes Non-Proportionnelles (fontes systŠmes), dont tous les
caractŠres occupent la mˆme place, cela d‚finit la taille pour tous les
caractŠres de la fonte.
  Pour les fontes Proportionnelles, o— certains caractŠres, plus larges,
occupent plus de place, cette fonction fixe la taille pour le caractŠre le plus
large.

ParamŠtres : WORD : VDI_ID
             WORD : Taille demand‚e
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Adresse d'un tableau contenant les tailles des caractŠres.
                Structure du tableau : WORD 0 : Largeur du caractŠre
                                       WORD 1 : Hauteur du caractŠre (entre sa
                                                base et le haut de la cellule du
                                                caractŠre)
                                       WORD 2 : Largeur de la cellule
                                       WORD 3 : Hauteur de la cellule
Pile : 12

/// VDI 13 : VST_ROTATION (SET CHARACTER BASELINE VECTOR) ///

Permet de d‚finir l'angle du texte.
V‚rifiez d'abord si vous pouvez demander n'importe quel angle par un Extended
Inquire Function (VDI 102)

ParamŠtres : WORD : VDI_ID
             WORD : Angle demand‚ (en dixiŠme de degr‚)
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Angle r‚ellement s‚lectionn‚ (en principe par pas de 90ø)
Pile : 12

/// VDI 14 : VS_COLOR (SET COLOR REPRESENTATION) ///

Sert … changer la couleur d'un index de la palette. Les intensit‚ … entrer sont
aux formats VDI (0 … 1000).

ATTENTION : Sur les moniteurs monochromes, une autres valeur que blanc donne du
            noir. Cependant, sur Falcon030, en monochrome sur un ‚cran VGA par
            exemple, les couleurs d‚finis sont r‚ellement utilis‚es. Ainsi on
            peut avoir un ‚cran en "Rouge et Noir" suivant son choix par
            exemple.

ParamŠtres : WORD : VDI_ID
             WORD : Index de la couleur … changer
             WORD : Intensit‚ du rouge (0 … 1000)
             WORD : Intensit‚ du vert (0 … 1000)
             WORD : Intensit‚ du bleu (0 … 1000)
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 18

/// VDI 15 : VSL_TYPE (SET POLYLINE LINE TYPE) ///

Sert … d‚finir le type de ligne.

ParamŠtres : WORD : VDI_ID
             WORD : Type demand‚
                    1 = Ligne continue  (%1111111111111111)
                    2 = Tiret long      (%1111111111110000)
                    3 = Pointill‚       (%1100000011000000)
                    4 = Tiret et point  (%1111111100001100)
                    5 = Tiret           (%1111111100000000)
                    6 = Tiret, 2 points (%1111000110011000)
                    7 = Utilisateur (Voyez VDI 113 pour cela)
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Type r‚ellement utilis‚
Pile : 12

/// VDI 16 : VSL_WIDTH (SET POLYLINE LINE WIDTH) ///

Sert … d‚finir la largeur d'une ligne.

ParamŠtres : WORD : VDI_ID
             WORD : Largeur demand‚e (impair de pr‚f‚rence)
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Largeur r‚ellement s‚lectionn‚e
Pile : 12

/// VDI 17 : VSL_COLOR (SET POLYLINE COLOR INDEX) ///

Sert … d‚finir la couleur de la ligne.

ParamŠtres : WORD : VDI_ID
             WORD : Idex de la couleur demand‚e
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Index r‚ellement utilis‚
Pile : 12

/// VDI 18 : VSM_TYPE (SET POLYMARKER TYPE) ///

Sert … d‚finir le type de repr‚sentation utilis‚ pour les marqueurs.

ParamŠtres : WORD : VDI_ID
             WORD : Type de repŠre
                    1 = Point (.)
                    2 = Croix horizontale (un peu comme le signe +)
                    3 = Etoile (dans le genre de *)
                    4 = Carr‚ (mieux que [])
                    5 = Croix diagonale (comme X)
                    6 = Losange (dans la mˆme famille que <>)
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Type de repŠre r‚ellement utilis‚
Pile : 12

/// VDI 19 : VSM_HEIGHT (SET POLYMARKER HEIGHT)///

Sert … choisir la taille des repŠres.

ParamŠtres : WORD : VDI_ID
             WORD : Taille demand‚
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Taille r‚ellement s‚lectionn‚e
Pile : 12

/// VDI 20 : VSM_COLOR (SET POLYMARKER COLOUR INDEX) ///

Sert … choisir la couleur des repŠres.

ParamŠtres : WORD : VDI_ID
             WORD : Index de couleur demand‚
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Index r‚ellement utilis‚
Pile : 12

/// VDI 21 : VST_FONT (SET TEXT FACE) ///

Sert … choisir la fonte. Il faut en principe en avoir pr‚alablement charg‚.

ParamŠtres : WORD : VDI_ID
             WORD : Num‚ro de la fonte voulue
                    1 = Fonte systŠme (toujours disponible)
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Num‚ro de la fonte r‚ellement s‚lectionn‚
Pile : 12

/// VDI 22 : VST_COLOR (SET GRAPHIC TEXT COLOUR INDEX) ///

Sert … d‚finir la couleur du texte.

ParamŠtres : WORD : VDI_ID
             WORD : Index de la couleur … utiliser
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Index r‚ellement utilis‚
Pile : 12

/// VDI 23 : VSF_INTERIOR (SET FILL INTERIOR STYLE) ///

Sert … choisir le style de remplissage.

ParamŠtres : WORD : VDI_ID
             WORD : Style demand‚
                    0 = Remplissage plein avec la couleur d'index 0
                    1 = Remplissage plein avec la couleur demand‚e
                    2 = Remplissage avec motif
                    3 = Remplissage avec hachures
                    4 = Motif utilisateur (Voyez VDI 112)
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Style s‚lectionn‚
Pile : 12

/// VDI 24 : VSF_STYLE (SET FILL STYLE INDEX) ///

Sert … d‚finir le num‚ro de style du motif de remplissage

ParamŠtres : WORD : VDI_ID
             WORD : Num‚ro de style
                    Style Motif :  1 = 12.5% tramage entre couleur la couleur
                                       de fond (index 0), et la couleur demand‚
                                   2 = 25% tramage
                                   3 = 37.5% tramage
                                   4 = 50% tramage
                                   5 = 62.5% tramage
                                   6 = 75% tramage
                                   7 = 87.5% tramage
                                   8 = 100% tramage, couleur demand‚
                                   9 = Briques
                                  10 = Briques diagonales (bas gauche vers haut
                                       droit)
                                  11 = Pointes
                                  12 = "Coupes de Champagne"
                                  13 = Relief m‚tallique
                                  14 = "Papier Peint"
                                  15 =
                                  16 = Tissage
                                  17 = Motif tissus en dent de scie
                                  18 = Motif tissus carr‚
                                  19 = Bulles
                                  20 = Tuiles rondes
                                  21 = Tuiles obliques (haut gauche vers bas
                                       droit)
                                  22 = Damier
                                  23 = Damier oblique
                                  24 = Parquet
                    Style Hachure :  1 = Lignes obliques (bas gauche vers haut
                                         droit)
                                     2 = Idem que 1, mais lignes ‚paisses
                                     3 = Cadrillage oblique
                                     4 = Lignes verticales
                                     5 = Lignes horizontales
                                     6 = Cadrillage
                                     7 = Idem que 1, mais espac‚es
                                     8 = Idem que 2, mais espac‚es
                                     9 = Idem que 3, mais lignes espac‚es
                                    10 = Idem que 4, mais lignes espac‚es
                                    11 = Idem que 5, mais lignes espac‚es
                                    12 = Idem que 6, simplement
                                    2 =
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Num‚ro du style r‚ellement s‚lectionn‚
Pile : 12

/// VDI 25 : VSF_COLOR SET FILL COLOUR INDEX) ///

Sert … d‚finir la couleur du remplissage.

ParamŠtres : WORD : VDI_ID
             WORD : Couleur demand‚e
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Couleur r‚ellement utilis‚e
Pile : 12

/// VDI 32 : VSWR_MODE (SET WRITING MODE) ///

Sert … choisir le mode d'‚criture. Permet d'effectuer une op‚ration logique
entre le motif ou les caractŠres … afficher, et le fond.

ParamŠtres : WORD : VDI_ID
             WORD : Mode choisit
                    1 = Replace : Les nouvelles donn‚es remplacent les
                                  pr‚c‚dentes sans autre forme de procŠs.
                    2 = Transparent : Le masque est utilis‚ pour d‚finir les
                                      points … changer.
                    3 = XOR : Inverse les BITs en communs avec le masque. Donc
                              si vous faites une deuxiŠme fois appel … cette
                              fonction, tout ce qui avait ‚t‚ invers‚ revient
                              dans le statut de d‚part. Essayez voir...
                    4 = Invers Transparent : Idem que Transparent, sauf qu'ici,
                                             ce sont les BITs … 0 qui servent …
                                             d‚finir les points … changer.
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Mode r‚ellement s‚lectionn‚
Pile : 12

/// VDI 104 : VSF_PERIMETER (SET FILL PERIMETER VISIBILITY) ///

Sert … choisir si oui ou non, la zone de remplissage doit ˆtre entour‚e d'une
ligne (attention … son ‚paisseur) de la couleur demand‚e.

ParamŠtres : WORD : VDI_ID
             WORD : P‚rimetre de remplissage
                    0 = Non
                    1 = Oui
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Mode r‚ellement s‚lectionn‚
Pile : 12

/// VDI 106 : VST_EFFECTS (SET GRAPHIC TEXT SPECIAL EFFECTS) ///

Sert … d‚finir les effets graphiques sur le texte.

ParamŠtres : WORD : VDI_ID
             WORD : Effets demand‚s
                    BIT 0 = Bold - Gras
                    BIT 1 = Light - Clair
                    BIT 2 = Italic - Italique
                    BIT 3 = Soulign‚
                    BIT 4 = OutLined - Contour
                    BIT 5 = Shade - Ombr‚
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Effets r‚ellement s‚lectionn‚s
Pile : 12

/// VDI 107 : VST_POINT (SET CHARACTER CELL HEIGHT - POINTS MODE) ///

Sert … choisir la taille de la cellule d'un caractŠre. Si normalement VDI 12
suffit, ici c'est en pr‚vision d'une impression.
Cette fonction est extrˆmement utile pour les traitement de textes WYSIWYG
(What You See Is What You Get - Ce Que Vous Voyez Est Ce Que Vous Obtenez), car
on peut avoir un rapport proportionnel … l'‚cran, par rapport … ce que l'on
veut obtenir sur l'imprimante.

ParamŠtres : WORD : VDI_ID
             WORD : Taille en 1/72ø de pouce (soit 0.35277 millimŠtres par
                    points)
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Taille r‚ellement s‚lectionn‚
Pile : 12

/// VDI 108 : VSL_ENDS (SET POLYLINE END STYLES) ///

Sert … choisir le style de terminaison des extr‚mit‚s des lignes.

ParamŠtres : WORD : VDI_ID
             WORD : Style du d‚part
                    0 = Bout carr‚
                    1 = FlŠche
                    2 = Bout arrondi
             WORD : Style de fin
                    Idem que style de d‚part
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 14

/// VDI 112 : VSF_UDPAT (SET USER DEFINED FILL PATTERN) ///

Sert … d‚finir un style de remplissage utilisateur.
Un grand avantage de cette fonction, est de permettre de d‚finir des styles en
couleurs.

ParamŠtres : WORD : VDI_ID
             WORD : Nombre de plans
             LONG : Adresse des plans formants le motif
                    Chaque plan doit ˆtre compos‚ de 16 WORDs.
                    Les plans doivent se suivre.
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 16

/// VDI 113 : VSL_UDSTY (SET USER-DEFINED LINE STYLE PATTERN) ///

Permet de d‚finir un style de ligne utilisateur

ParamŠtres : WORD : VDI_ID
             WORD : Style de la ligne sur 16 BITs
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

--- FONCTIONS DE QUADRILLAGE ---

Les fonctions se rapportant aux quadrillage ne sont en fait que des blocs
m‚moire ‚cran ou autre. Certains dans certaines documentations ont utilis‚s la
notion de quadrillage car cela est "sens‚" rappeler les coordonn‚es des pixels.

/// VDI 105 : V_GET_PIXEL (GET PIXEL) ///

Permet d'obtenir l'index de couleur d'un point.

ParamŠtres : WORD : VDI_ID
             WORD : X
             WORD : Y
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Valeur.w et Index.w de la couleur du point
Pile : 14

/// VDI 109 : VRO_CPYFM (COPY RASTER - OPAQUE) ///

Copie d'un bloc vers un autres. Ces blocs peuvent appartenir … l'‚cran ou non.
Ce sont les plus petites dimensions donn‚es qui sont utilis‚es. Il apparaŒt une
nouvelle structure, se rapportant … l'‚cran.

> Structure MFDB
  LONG 0 : Pointeur sur le bloc de l'image
  WORD 2 : Largeur du bloc en points
  WORD 3 : Hauteur du bloc en points
  WORD 4 : Longueur d'un ligne en WORDs
  WORD 5 : Format du bloc
           0 = Machine (Raster, o— les plans sont entrelac‚s)
           1 = Standard (les plans se suivent (et ne se ressemblent pas))
  WORD 6 : Nombre de plans
  WORD 7 : R‚serv‚

ATTENTION : Le systŠme d'exploitation, pour les copie de blocs, ne gŠre pas le
            format Standard.

ParamŠtres : WORD : VDI_ID
             WORD : Op‚ration logique … effectuer sur le bloc.
                    Ce sont les mˆmes que celle du Blitter (qui est la version
                    Hard de cette fonction, sp‚cialement d‚velopp‚e par ATARI).
                       0 = Destination … 0
                       1 = Source AND Destination
                       2 = Source NAND Destination
                       3 = Source (copie simple)
                       4 = NOT Source AND Destination
                       5 = Destination
                       6 = Source XOR Destination
                       7 = Source OR Destination
                       8 = NOT Source NAND Destination
                       9 = NOT Source XOR Destination
                      10 = NOT Destination
                      11 = Source NOR Destination
                      12 = NOT Source
                      13 = NOT Source OR Destination
                      14 = NOT Source NOR Destination
                      15 = Destination … "1"
             WORD : X du d‚but du bloc source
             WORD : Y du d‚but du bloc source
             WORD : X de fin du bloc source
             WORD : Y de fin du bloc source
             WORD : X de d‚but du bloc de destination
             WORD : Y de d‚but du bloc de destination
             WORD : X de fin du bloc de destination
             WORD : Y de fin du bloc de destination
             LONG : Adresse du MFDB du bloc source
             LONG : Adresse du MFDB du bloc destination
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 36

/// VDI 110 : VR_TRNFM (TRANSFORM FORM) ///

Transforme le format graphique d'un bloc au format actuel. Il est donc inutile
de sp‚cifier le nouveau format dans le MFDB Destination. C'est, je pense, une
grave erreur de la part de Digital Research, de n'avoir pas pr‚vus cela.
Mais bon, cela sera peut ˆtre diff‚rent dans une prochaine version de SSAV.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse du MFDB du bloc source
             LONG : Adresse du MFDB du bloc destination
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 18

/// VDI 121 : VRT_CPYFM (COPY RASTER - TRANSPARENT) ///

Copie un bloc en lui faisant effectuer une transformation de format, pour
l'adapter … l'‚cran. Le bloc source doit ˆtre au format monochrome.

ParamŠtres : WORD : VDI_ID
             WORD : Mode de transformation
                    1 = Remplacement : Les BITs … 1 du bloc source sont
                                       affich‚s avec la couleur demand‚e, ainsi
                                       que les BITs … 0.
                    2 = Transparent : Seuls les BITs du bloc source … 1 sont
                                      affich‚s dans la couleur demand‚e.
                    3 = XOR :
                    4 = Transparent Inverse : Seuls les BITs du bloc source … 1
                                              sont affich‚s dans la couleur
                                              demand‚e.
             WORD : Index de couleur pour les BITs du bloc source … 1
             WORD : Index de couleur pour les BITs du bloc source … 0
             WORD : X du d‚but du bloc source
             WORD : Y du d‚but du bloc source
             WORD : X de fin du bloc source
             WORD : Y de fin du bloc source
             WORD : X de d‚but du bloc de destination
             WORD : Y de d‚but du bloc de destination
             WORD : X de fin du bloc de destination
             WORD : Y de fin du bloc de destination
             LONG : Adresse du MFDB du bloc source
             LONG : Adresse du MFDB du bloc destination
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 40

--- FONCTIONS D'ENTREE ---

Ces fonctions de saisies sont les plus puissantes de l'ATARI. Ce sont elles qui
permettent de ne pas stopper l'ordinateur, mais d'effectuer la saisie en "tache
de fond".

/// VDI 33 : VSIN_MODE (SET INPUT MODE) ///

Sert … d‚terminer le mode de saisie de chaque type de p‚riph‚rique.
Attention, car les fonctions suivantes celle ci r‚agiront de maniŠre d‚termin‚e
par cette fonction, donc faites trŠs attention.

ParamŠtres : WORD : VDI_ID
             WORD : P‚riph‚rique de saisie.
                    Le VDI en traite quatre de types diff‚rents
                    1 = Locator : Un p‚riph‚rique qui donne une position
                                  (souris, stylo, tablette graphique, ...)
                    2 = Valuator : Modification de valeurs suivant l'entr‚e.
                                   En principe, ne marche pas sur ATARI.
                                   Sur PC, ce sont par exemple les JoySticks
                                   analogique contenants des potentiomŠtres,
                                   et pouvant fournir une valeur, donc.
                                     Il parait que c'est la modification d'un
                                   nombre avec les fleches, mais vu que le ST
                                   est capable de le faire, je ne vois pas
                                   pourquoi cela n'a pas ‚t‚ adapt‚ sur ATARI.
                    3 = Choice : Ici, sur ATARI, ce sont nos touches de
                                 fonctions
                    4 = String : Le clavier, tout simplement, avec lettres et
                                 chiffres.
             WORD : Mode d'attente
                    1 = Request. Dans ce cas, la fonction attend le nombre
                        d'OCTET … entrer.
                    2 = Sample. La fonction renvoie code ASCII par code ASCII
                        ceux des touches enfonc‚es.
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Mode r‚ellement s‚lectionn‚
Pile : 14

/// VDI 28 : VRQ_LOCATOR (INPUT LOCATOR) ///

Cette fonction fournit la position de la souris ou compagnie.

Request Mode : La souris est positionn‚e aux coordonn‚es pr‚cis‚es. La fonction
               se d‚roule jusqu'a qu'une touche du clavier ou de la souris soit
               enfonc‚e.
               ATTENTION : Le pointeur de la souris est affich‚, mˆme s'il ne
                           l'‚tait pas
Sample Mode : La souris est positionn‚e aux coordonn‚es pr‚cis‚es, mais cette
              fois ci, la fonction attend que la position de la souris de la
              souris ait chang‚e ou qu'une touche du clavier ou de la souris
              ait ‚t‚ enfonc‚e.
              ATTENTION : Ici, vous obtenez soit la nouvelle position de la
                          souris ou le code ASCII de la touche enfonc‚e.
                          De plus, le pointeur de la souris est effac‚ (mais
                          peut ˆtre affich‚ "Met" Show Cursor)

ATTENTION : Le code renvoy‚ pour le bouton gauche est $20 (32) [Espace]
                                           droit  est $21 (33) [!]
            Prenez donc la valeur du BIT 0 pour savoir ce qu'il en est.

ParamŠtres : WORD : VDI_ID
             WORD : X
             WORD : Y
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Code ASCII de la touche enfonc‚e (pour les boutons de la
                souris, voyez plus haut)
         D1.l = X.w et Y.w de la souris
Pile : 14

/// VDI 29 : VRQ_VALUATOR (INPUT VALUATOR) ///

En soit, cette fonction est inutile car n'a pas ‚t‚ adapt‚e sur ATARI, vus qu'il
n'existe aucun p‚riph‚rique d'entr‚e analogique en s‚rie (mont‚ d'origine) sur
ATARI. Cependant, si Maitre DALSTEIN veut bien faire un truc dans ce sens, …
connecter sur le port cartouche, pourquoi n'y aurait il pas une raison … ce que
la prochaine version de SSAV dispose effectivement de routines pour g‚rer la
chose en question.
Mais c'est … voir, et les propositions de connecteurs (pour JoySticks
analogique?), ou autres, en ce sens (NdM: encore...?), sont les bienvenues.

Normalement, les docs d‚veloppeur indiquent que cette fonction sert … changer
une valeur comprise entre 0 et 100 avec les flŠches. Celles du bas ou du haut
servant … augmenter ou diminuer la valeur par pas de dix, et celle de gauche et
de droite par pas de 1 (un peu comme la modification de la m‚moire sous SysInfo
V8.23).

Request Mode : Modifie la valeur jusqu'a que la fonction re‡oive un code ASCII
               ou que les boutons de la souris soient enfonc‚s.

Sample Mode : La fonction se termine au premier changement significatif.

ParamŠtres : WORD : VDI_ID
             WORD : Valeur initiale (comprise entre 0 et 100)
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Valeur.w finale et Code.w ASCII
         D1.w = Evenement si Sample Mode
                0 : Rien pass‚
                1 : Valeur chang‚e
                2 : Code ASCII
Pile : 12

/// VDI 30 : VRQ_CHOICE (INPUT CHOICE) ///

Cette fonction attend qu'une touche de fonction soit actionn‚e.
Si la r‚ponse est invalide (allez savoir pourquoi), la fonction renvoie la
valeur initiale (permet par exemple de savoir si une touche de fonction a ‚t‚
appuy‚e en mettant la valeur initiale … -1).

Request Mode : Attend une touche de fonction.

Sample Mode : La fonction regarde si a ce moment l…, une touche de fonction est
              enfonc‚e, et fournie sa valeur dans ce cas

ParamŠtres : WORD : VDI_ID
             WORD : Valeur initiale (inutile en Sample Mode)
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Num‚ro de la touche de fonction, ou valeur.
Pile : 12

/// VDI 31 : VRQ_STRING (INPUT STRING) ///

Permet de saisir une chaŒne de caractŠre. Si la sortie sur ‚cran est permise,
la chaŒne est affich‚e avec les attributs du texte courant, et … la position
indiqu‚e.

Request Mode : La fonction ne s'arrˆte que si le buffer est plein, ou que la
               touche [Return] ou [Enter] ait ‚t‚ enfonc‚e.

Sample Mode : Comme Request Mode, mais de fa‡on intempestive.

ParamŠtres : WORD : VDI_ID
             WORD : Longueur maximum de la chaŒne … saisir
                    ATTENTION : Cette valeur ne doit SURTOUT pas d‚passer le
                    nombre de IntOut que vous avez d‚finit dans votre
                    programme.
             WORD : Mode de sortie
                    0 = Pas de sortie sur l'‚cran
                    1 = Sortie sur l'‚cran autoris‚e
             WORD : X
             WORD : Y
             LONG : Adresse o— doit ˆtre inscrite la chaŒne
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Longueur saisie
Pile : 22

/// VDI 111 : VSC_FORM (SET MOUSE FORM) ///

Encore une autre maniŠre de changer de souris.

ParamŠtres : WORD : VDI_ID
             WORD : X du Point Chaud
             WORD : Y du Point Chaud
             WORD : Index de couleur pour le masque (en principe 0 pour Blanc)
             WORD : Index de couleur pour les donn‚es (1 pour Noir normalement)
             LONG : Adresse de 16 WORDs composants le masque
             LONG : Adresse de 16 WORDs composants le pointeur
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 26

/// VDI 118 : VEX_TIMV (EXCHANGE TIMER INTERRUPT VECTOR) ///

Permet de faire ex‚cuter une action par le VDI.
Celle ci sera ex‚cut‚e … chaque battement du Timer (r‚visez votre MFP). En
principe, c'est … chaque VBL que s'effectue l'appel … votre routine.

ATTENTION : Pendant l'ex‚cution de la routine, les interruptions sont
            d‚sactiv‚es. Les registres ne doivent en AUCUN cas ˆtres modifi‚s,
            et celle ci ne doit pas ˆtre trop longue.

ParamŠtres : WORD : VDI_Id
             LONG : Adresse de la routine … activer
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Nombre de millisecondes entre deux battements du Timer
         D1.l = Adresse de la pr‚c‚dente routine
Pile : 14

/// VDI 122 : V_SHOW_C (SHOW CURSOR) ///

Fait apparaŒtre le pointeur de la souris, si celui ci avait disparu.

ParamŠtres : WORD : VDI_ID
             WORD : Mode
                    0 = Force l'apparition du curseur
                    1 = Prend en compte le nombre de fois que l'on a demand‚ au
                        curseur de disparaŒtre.
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 12

/// VDI 123 : V_HIDE_C (HIDE CURSOR) ///

Fait disparaŒtre le curseur.

ATTENTION : Mˆme invisible, le curseur continu … ˆtre g‚r‚, donc n'attendez pas
            … le revoir forcement r‚apparaŒtre o— il avait disparu.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : Aucun
Pile : 10

/// VDI 124 : VQ_MOUSE (SAMPLE MOUSE BUTTON STATE) ///

Sert … obtenir l'‚tat de la souris.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = X.w et Y.w de la souris
         D1.w = Etats des boutons de la souris
                BIT 0 : Bouton gauche
                BIT 1 : Bouton droit
Pile : 10

/// VDI 125 : VEX_BUTV (EXCHANGE BUTTON CHANGE VECTOR) ///

Permet de faire ex‚cuter une routine … chaque changement de l'‚tat des boutons
de la souris. Pour changer les boutons par exemple, et obtenir une souris pour
gaucher.

Pour cela, voici un petit programme qui s'en occupe:

Left_Mouse      lsl.l           #14,D0          ; Les BITs des boutons
                                                ; chevauchent les deux WORDs
                swap            D0              ; On inverse les WORDs
                bclr.l          #31,D0          ; On efface l'‚tat du bouton
                                                ; gauche
                BEQ             Exit_Lefter     ; S'il ‚tait … 0, on s'en fout
                bset.b          #1,D0           ; Sinon, on le replace

Exit_Lefter     RTS

ATTENTION : Le VDI, … ce niveau, n'a pas encore enregistr‚ l'‚tat de ces
            boutons, mais vous appelle, car il … d‚tect‚ un changement.
            Cependant, l'‚tat actuel vous est transmit dans D0.w.
            A la fin de la routine, vous devez renvoyer cet ‚tat (que vous
            pouvez avoir modifi‚) dans D0.
            Le VDI prend alors en compte ce nouvel ‚tat (dans D0).
            Les registres, en dehors de D0, NE doivent PAS avoir chang‚.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse de votre routine
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Adresse de la pr‚c‚dente routine
Pile : 14

/// VDI 126 : VEX_MOTV (EXCHANGE MOUSE MOVEMENT VECTOR) ///

Permet de faire ex‚cuter une routine … chaque affichage du pointeur de la
souris (en principe … chaque fois quelle change de position).

ATTENTION : Le VDI n'a pas encore enregistr‚ les nouvelles coordonn‚es.
            Vous obtenez dans D0.w la nouvelle position X, et dans D1.w, la Y.
            Ces valeurs doivent s'y retrouver au retour.
            Les registres ne doivent en AUCUN cas avoir chang‚s.
            Les interruptions sont impossibles.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse de la routine
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Adresse de la pr‚c‚dente routine
Pile : 14

/// VDI 127 : VEX_CURV (EXCHANGE CURSOR CHANGE VECTOR) ///

Permet de faire ex‚cuter une routine d'affichage du curseur.
Si vous voulez demander au VDI de le faire pour vous, utilisez l'ancienne
adresse, renvoy‚e aprŠs l'appel de cette fonction.

Pensez que vous avez besoin, … l'appel de la routine de :
 - Effacer votre curseur
 - Sauvegarder le fond
   Il n'est pas utile de faire un tas d'op‚ration logiques pour sauvegarder
   juste ce qui sera sous le pointeur. Faites juste une copie du rectangle o—
   sera affich‚ le pointeur.
 - Afficher … la nouvelle position

ATTENTION : Le VDI n'a pas encore enregistr‚ les nouvelles coordonn‚es.
            Vous obtenez dans D0.w la nouvelle position X, et dans D1.w, la Y.
            Ces valeurs doivent s'y retrouver au retour.
            Les registres ne doivent en AUCUN cas avoir chang‚s.
            Les interruptions sont impossibles.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse de la routine
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Adresse de l'ancienne routine
Pile : 14

/// VDI 128 : VQ_KEY_S (SAMPLE KEYBOARD STATE INFORMATION) ///

Permet de connaŒtre l'‚tat des touches sp‚ciales du clavier.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Etat des touches sp‚ciales
                BIT 0 : SHIFT Droit
                BIT 1 : SHIFT Gauche
                BIT 2 : CONTROL
                BIT 3 : ALTERNATE
Pile : 10

--- FONCTIONS D'ETAT DU SYSTEME ---

/// VDI 26 : VQ_COLOR (INQUIRE COLOR REPRESENTATION) ///

Permet d'obtenir des informations sur les couleurs mises en places.

ParamŠtres : WORD : VDI_ID
             WORD : Index de la couleur … obtenir
             WORD : Mode
                    0 = Couleur d‚finit dans le VDI, et qui devrait
                        normalement s'afficher
                    1 = Couleur r‚ellement affich‚e
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Adresse d'un tableau contenant les informations sur la couleur
                Structure du tableau : WORD 0 : Index de la couleur
                                       WORD 1 : Rouge (0 … 1000)
                                       WORD 2 : Vert (0 … 1000)
                                       WORD 3 : Bleu (0 … 1000)
Pile : 14

/// VDI 27 : VQT_ARRAY (INQUIRE CELL ARRAY) ///

(Pas document‚, mais carr‚ment implant‚, si si...)

ParamŠtres : WORD : VDI_ID
             WORD : Longueur d'une ligne dans le tableau d'index
             WORD : Nombre de lignes dans le tableau d'index
             WORD : X du coin haut - gauche
             WORD : Y du coin haut - gauche
             WORD : X du coin bas - droite
             WORD : Y du coin bas - droite
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Adresse du tableau
         D1.l = Adresse d'un tableau contenant les informations du tableau
                d'index
                Structure du tableau : WORD 0 : Longueur du tableau d'index
                                       WORD 1 : Nombre d'‚l‚ment par ligne
                                       WORD 2 : Nombre de lignes du tableau
                                       WORD 3 : Validit‚
                                                0 = Pas d'erreur (c'est ...)
                                                1 = Certains points n'ont pus
                                                    ˆtre d‚termin‚s.
                                                    Dans ce cas, la case
                                                    correspondant au point
                                                    contient -1.
Pile : 22

/// VDI 35 : VQL_ATTRIBUTES (INQUIRE CURRENT POLYLINE ATTRIBUTES) ///

Permet d'obtenir les attributs de lignes de la station courante.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Adresse d'un tableau contenant les attributs de lignes
                Structure du tableau : WORD 0 : Style de la ligne
                                       WORD 1 : Index de couleur
                                       WORD 2 : Mode d'‚criture
                                       WORD 3 : Style du d‚part
                                       WORD 4 : Style de la fin
         D1.w = Largeur courant de la ligne
Pile : 10

/// VDI 36 : VQM_ATTRIBUTES (INQUIRE CURRENT POLYMARKER ATTRIBUTES) ///

Sert … obtenir les attributs actuels des marqueurs.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Adresse d'un tableau contenant les attributs courants des
                marqueurs.
                Structure du tableau : WORD 0 : Style du marqueur
                                       WORD 1 : Index de couleur
                                       WORD 2 : Mode d'‚criture
         D1.l = Epaisseur.w et Hauteur.w
Pile : 10

/// VDI 37 : VQF_ATTRIBUTES (INQUIRE CURRENT FILL AREA ATTRIBUTES) ///

Sert … obtenir les paramŠtres actuel de remplissage.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : DO.l : Adresse d'un tableau contenant les attributs courants du
                remplissage
                Structure du tableau : WORD 0 : Style de remplissage
                                       WORD 1 : Index de couleur du remplissage
                                       WORD 2 : Num‚ro du style du remplissage
                                       WORD 3 : Mode d'‚criture
                                       WORD 4 : Visualisation du p‚rimŠtre
Pile : 10

/// VDI 38 : VQT_ATTRIBUTES (INQUIRE CURRENT GRAPHIC TEXT ATTRIBUTES) ///

Sert … obtenir (et non … fixer) les attributs de sortie graphique.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Adresse d'un tableau contenant les attributs d'affichage
                Structure du tableau : WORD 0 : Police actuellement mise en
                                                oeuvre
                                       WORD 1 : Couleur du texte
                                       WORD 2 : Angle de rotation du texte (en
                                                dixiŠme de degr‚)
                                       WORD 3 : Alignement horizontale
                                       WORD 4 : Alignement verticale
                                       WORD 5 : Mode d'‚criture
         D1.l = Adresse d'un tableau contenant les attributs des caractŠres
                Structure du tableau : WORD 0 : Largeur d'un caractŠre
                                       WORD 1 : Hauteur d'un caractŠre
                                       WORD 2 : Largeur d'une cellule
                                       WORD 3 : Hauteur d'une cellule
Pile : 10

/// VDI 102 : VQ_EXTND (EXTENDED INQUIRE FONCTION) ///

Permet d'obtenir encore plus d'informations sur la station de travail, que
celles offertes … son ouverture.

ParamŠtres : WORD : VDI_ID
             WORD : Type d'informations demand‚es
                    0 = Celle offerte … l'ouverture de la station
                    1 = Les ‚tendues, celle que normalement on ne connaŒt pas
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Handle
         D1.l = Adresse d'un tableau contenant les informations demand‚es.
                Si vous avez demand‚ les informations normales, vous obtenez le
                mˆme tableau qu'a l'ouverture de votre station, sinon, c'est un
                tableau diff‚rent.
                Structure du tableau : WORD  0 : Type de la sortie ‚cran
                                                 0 = C'est pas un ‚cran (???)
                                                     Une paire de rames peut
                                                     ˆtre, pour voir clair.
                                                 1 = Deux parties distinctes,
                                                     graphiquement et
                                                     textuellement, ainsi que
                                                     deux RAM vid‚o diff‚rentes
                                                     (donc en principe deux
                                                     ‚crans, un graphique, et
                                                     un textuel).
                                                 2 = Deux parties diff‚rentes,
                                                     mais RAM vid‚o commune
                                                     (y'aurait pas un os?).
                                                 3 = L'inverse : Les deux
                                                     parties de gestion
                                                     graphique et textuel sont
                                                     communes, mais il y a deux
                                                     RAM vid‚o (une pour chaque
                                                     partie, mais c'est pas
                                                     possible)
                                                 4 = Les deux parties sont
                                                     communes, ainsi que la RAM
                                                     vid‚o (cas des ATARIs)
                                       WORD  1 : Nombre de couleurs de fond
                                                 (???)
                                       WORD  2 : Effets graphiques support‚s sur
                                                 le texte. Voyez la fonction
                                                 correspondante (VDI 106)
                                       WORD  3 : Agrandissement/R‚duction
                                                 0 = Impossible
                                                 1 = Possible
                                       WORD  4 : Nombre de plans vid‚o
                                       WORD  5 : Table Look Up (???)
                                                 0 = Non g‚r‚e
                                                 1 = Ger‚e
                                       WORD  6 : Coefficient de performance.
                                                 C'est le nombre d'op‚rations
                                                 effectu‚es par seconde sur une
                                                 matrice de 16*16 points. €a
                                                 permet de donner un ordre
                                                 d'id‚e sur la performance de
                                                 votre machine, surtout si vous
                                                 connaissez la valeur d'autre
                                                 machine. Mais entre nous, ne
                                                 vous y fiez SURTOUT pas.
                                                 Ce doit ˆtre le temps que met
                                                 le GEM … tracer la souris (ce
                                                 qu'il fait en permanence).
                                                 Le rapport d'un Falcon030 par
                                                 rapport … un ST est donn‚ …
                                                 138% ici, alors que test‚ dans
                                                 les conditions normales
                                                 d'utilisation, on atteind sans
                                                 peine les 340%.
                                       WORD  7 : Possibilit‚ de remplir une zone
                                                 en tenant compte des
                                                 diff‚rences de couleurs pour
                                                 g‚rer la limite du remplissage.
                                                 0 = Non
                                                 1 = Oui
                                       WORD  8 : Possibilit‚ de rotation des
                                                 caractŠres.
                                                 0 = Non
                                                 1 = Par pas de 90ø
                                                 2 = Par pas de dixiŠme de degr‚
                                                 ATTENTION : TrŠs important!
                                       WORD  9 : Nombre de mode d'‚criture
                                       WORD 10 : Modes de saisit possibles
                                                 0 = Aucun
                                                 1 = Request
                                                 2 = Request - Sample
                                       WORD 11 : Possibilit‚ d'alignement du
                                                 texte
                                                 0 = Non
                                                 1 = Oui
                                       WORD 12 : Possibilit‚ de gestion de
                                                 l'encrage de l'imprimante
                                                 0 = Non
                                                 1 = Oui
                                       WORD 13 : Possibilit‚ de changer de
                                                 couleur par d‚placement du
                                                 ruban sur les imprimantes
                                                 couleur matricielles
                                                 0 = Non
                                                 1 = Oui, sur plusieurs lignes
                                                 2 = Oui, sur plusieurs lignes
                                                     et rectangles
                                       WORD 14 : Nombre maximum de coordonn‚es
                                                 g‚r‚es pour les diff‚rents
                                                 fonctions en n‚cessitant
                                                 (PolyLine, PolyMarker, Filled
                                                 Area, ...)
                                                 -1 = Illimit‚
                                       WORD 15 : Nombre d'entr‚es IntIn
                                                 -1 = Illimit‚
                                       WORD 16 : Nombre de boutons de la souris
                                                 (d‚pend si elle a de l'acn‚)
                                       WORD 17 : Possibilit‚ d'application des
                                                 styles sur le lignes larges.
                                                 0 = Non
                                                 1 = Oui
                                       WORD 18 : Mode d'‚criture pour les lignes
                                                 larges
         D2.l = Infos sur les caractŠres si vous avez demand‚ les informations
                … l'ouverture d'une station
Pile : 12

/// VDI 115 : VQT_INPUT (INQUIRE INPUT MODE) ///

L'inverse de la fonction VDI 33. Permet de connaŒtre, pour chaque type de
p‚riph‚rique, le mode d'attente.

ParamŠtres : WORD : VDI_ID
             WORD : Num‚ro du p‚riph‚rique
                    1 = Locator
                    2 = Valuator
                    3 = Choice
                    4 = String
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = 1 : Mode Request
                2 : Mode Sample
Pile : 12

/// VDI 116 : VQT_EXTENT (INQUIRE TEXT EXTENT) ///

Permet de connaŒtre la position et la place qu'occupera … l'‚cran la chaŒne de
caractŠre pr‚cis‚e.

ParamŠtres : WORD : VDI_ID
             WORD : Nombre de caractŠres … afficher
             LONG : Adresse de la chaŒne de caractŠres
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Adresse d'un tableau contenant les coordonn‚es des extr‚mit‚s
                du rectangle contenant la chaŒne.
                Structure du tableau : WORD 0 : X du coin inf‚rieur gauche du
                                                rectangle
                                       WORD 1 : Y du coin inf‚rieur gauche du
                                                rectangle
                                       WORD 2 : X du coin inf‚rieur droit du
                                                rectangle
                                       WORD 3 : Y du coin inf‚rieur droit du
                                                rectangle
                                       WORD 4 : X du coin sup‚rieur gauche du
                                                rectangle
                                       WORD 5 : Y du coin sup‚rieur gauche du
                                                rectangle
                                       WORD 6 : X du coin sup‚rieur droit du
                                                rectangle
                                       WORD 7 : Y du coin sup‚rieur droit du
                                                rectangle
Pile : 16

/// VDI 117 : VQT_WIDTH (INQUIRE CHARACTER CELL WIDTH) ///

Sert … connaŒtre la largeur d'une cellule de caractŠre, ainsi que l'intervalle
… gauche et … droite (un petit espace pour que les caractŠres ne collent pas
entres eux).

ParamŠtres : WORD : VDI_ID
             WORD : Num‚ro du caractŠre dans la fonte
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.w = Num‚ro du caractŠre, -1 s'il n'est pas disponible
         D1.l = Adresse d'un tableau contenant les informations sur le
                caractŠre d‚finit.
                Structure du tableau : WORD 0 : Largeur de la cellule du
                                                caractŠre
                                       WORD 1 : Intervalle … gauche de la
                                                cellule
                                       WORD 2 : Intervalle … droite de la
                                                cellule
Pile : 12

/// VDI 130 : VQT_NAME (INQUIRE FACE NAME & INDEX) ///

Permet d'obtenir le nom de la fonte, ainsi que son num‚ro.

ATTENTION : Le nom de la fonte est sur 32 OCTETs, dont la structure est
             - 16 OCTETs pour le nom proprement dit de la fonte
             - 16 OCTETs pour les attributs (Bold (Gras), Italics (...))

ParamŠtres : WORD : VDI_ID
             WORD : Num‚ro de la fonte
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Adresse d'un tableau contenant le num‚ro et le nom de la fonte
                Structure du tableau : WORD 0 : Num‚ro de la fonte
                                       WORD 1 …  8 : Nom
                                       WORD 9 … 16 : Attributs
Pile : 12

/// VDI 131 : VQT_FONTINFO (INQUIRE CURRENT FACE INFORMATION) ///

Sert … obtenir des informations confidentielles sur la fonte actuelle.

ParamŠtres : WORD : VDI_ID
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour : D0.l = Valeur ASCII minimale.w et maximale.w
         D1.l = Adresse d'un tableau contenant les informations de la fonte
                courante
                Structure du tableau : WORD 0 : Largeur maximale d'une cellule
                                                d'un caractŠre sans effet
                                                graphique.
                                       WORD 1 : Distance entre la ligne de base
                                                (la base du caractŠre) et le bas
                                                de la cellule d'un caractŠre.
                                       WORD 2 : Elargissement horizontale due …
                                                un effet graphique.
                                       WORD 3 : Distance entre la ligne de
                                                descente (la base de la jambe du
                                                p, g, j, ...) et le bas de la
                                                cellule d'un caractŠre. Il y a
                                                une fine ligne inutilis‚e pour
                                                que les caractŠres ne collent
                                                pas.
                                       WORD 4 : D‚calage … gauche pour
                                                l'italique
                                       WORD 5 : Distance entre la ligne de
                                                moiti‚ de cellule (le haut d'un
                                                caractŠre minuscule) et la ligne
                                                de base (la base du caractŠre)
                                       WORD 6 : D‚calage … droite pour
                                                l'italique
                                       WORD 7 : Distance entre la ligne
                                                ascendante (le haut d'un
                                                caractŠre majuscule) et la ligne
                                                de base (la base du caractŠre)
                                       WORD 8 : R‚serv‚, … 0
                                       WORD 9 : Distance entre la ligne de base
                                                (la base du caractŠre) et le
                                                haut de la cellule d'un
                                                caractŠre
Pile : 10

--- FONCTIONS NON ENCORE IMPLANTEES FAUTE DE DOCUMENTATION ---

ATTENTION : Ces fonction sont en r‚alit‚ PARTIELLEMENT implant‚es, en pr‚vision
            d'une obtention de documents me permettant de les implanter
            compl‚temment, donc ne faites SURTOUT PAS appel … elles, sinon vous
            courrez droit au Bug.

/// VDI 5,99 : V_BEZ_QUAL ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 6,13 : V_BEZ ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 9,13 : V_BEZ_FILL ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 11,13,0 : V_BEZ_OFF ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 11,13,1 : V_BEZ_ON ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 39 : VST_ALIGNMENT (SET GRAPHIC TEXT ALIGNMENT) ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 232 : VQT_FONTHEADER () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :


/// VDI 234 : VQT_TRACKKERN () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 235 : VQT_PAIRKERN () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 236 : VST_CHARMAP () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 237 : VST_KERN () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :


/// VDI 239 : V_GETBITMAT_INFO () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 240 : VQT_F_EXTENT () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 241 : V_FTEXT () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 242 : V_FTEXT_OFFSET () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 243 : V_GETOUTLINE () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 244 : VST_SCRATCH () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 245 : VST_ERROR () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 246 : VST_ARBPT () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 247 : VQT_ADVANCE () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 248 : VQT_DEVINFO () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 249 : V_SAVECACHE () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 250 : V_LOADCACHE () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 251 : V_FLUSHCACHE () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 252 : VST_SETSIZE() ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 253 : VST_SKEW () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 254 : VQT_GET_TABLE () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI 255 : VQT_CACHESIZE () ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

/// VDI -1 : V_SET_APP_BUFF ///

ParamŠtres :
             LONG : Adresse du buffer des variables (VDI_PARAMS)
Retour :
Pile :

*** LINE A ***

Voici pour clore cette documentation les codes op‚ratoires de la Line A. Vous
n'ˆtes pas sans savoir, vous, programmeur en assembleur, que l'octet de poids
fort de l'OpCode d'une instruction d‚finit sa famille.
  Ici, la Line A traite les instructions sp‚ciales dont cet OCTET de poids fort
est $A. Ces instructions provoquent dans l'ATARI des commandes graphiques
extrˆmement rapides car imm‚diatement interpr‚t‚es par le processeur, mais
n‚anmoins font appels … une bibliothŠque d'instructions "normale". Ces
instruction graphiques sont les plus utilis‚es. Y'en a juste 16, mais c'est
largement suffisant.
  Vu que ce sont des fonctions sp‚cifique (en fait un v‚ritable Op-Code), pour
appeler par exemple la premiŠre fonction, il faut ‚crire dans votre programme

             dc.w            $A000

  Une fois la fonction ex‚cut‚e, le programme poursuit … l'instruction suivante,
sans avoir besoin de restaurer la pile ou autre chose, vu que vous n'utilisez
pas de registres.

ATTENTION : Cette partie n'est pas forcement juste car je n'utilise que trŠs
            occasionnellement la LineA. Aussi, je ne peut, ici, garantir
            l'exactitude de mes propos, ainsi que de vous donner une explication
            plus claire pour certaines fonctions. Je compte r‚gulariser cela
            dans la prochaine version.
              De plus, de trifouiller directement les variables du GEM n'est pas
            forcement judicieux lorsqu'on est en train de l'utiliser. Cependant,
            c'est trŠs utile lorsque l'on fait un jeu, ou une d‚mo, ou
            simplement un programme sous TOS.

Voici donc la description de chaque instruction :

/// A000 : LineA Init ///

Met la Line A en branle. €a fait pas de bruit, ne mange pas de pain, mais Dieu,
que c'est pratique.
Retour : D0.l et A0 = Adresse des variables Line A. Ces variables forment un
                      gigantesque tableau contenant toutes (ou presque) les
                      informations sur tout ce qui peut ˆtre utile au systŠme
                      d'exploitation. J'en voit d‚j… en train de se chauffer le
                      bout des doigts, en songeant d‚j… au Patch qui va
                      r‚volutionner le monde (un patch pour ‚liminer BG? Le trip
                      total, quoi...).
                        C'est d'ailleurs grƒce … ces variables que FalconScreen
                      ‚tend la r‚solution de l'‚cran (avec modification
                      judicieuse des registres du Videl (NdM: N'essayez pas sur
                      votre ST, il n'a pas ‚t‚ pr‚vus pour, et un systeme
                      OverScan prendrait trop de temps)). Mais voyez plut“t :
OffSet Size Name         Data
  -906 LONG Cur_Font     Pointeur sur le Header de la Fonte utilis‚e
  -902                   R‚serv‚
     …
  -856 WORD M_Pos_HX     X du Point Chaud
  -854 WORD M_Pos_HY     Y du Point Chaud
  -852 WORD M_Planes     Mode d'‚criture de la souris
                          1 = Normal
                         -1 = XOR
  -850 WORD M_Cdb_BG     Couleur du masque de la souris
  -848 WORD M_Cdb_FG     Couleur du pointeur de la souris
  -846 WORD Mask_Form    Les donn‚es de la souris
                         16 WORDs : Le masque
                         16 WORDs : Le pointeur
  -782 WORD Inq_Tab      Les 45 WORDs renvoy‚s par Vq_Extend (VDI )
  -692 WORD Dev_Tab      Les 45 WORDs renvoy‚s pas V_Opn(V)Wk (VDI 1-100)
  -602 WORD G_CurX       La coordonn‚e X actuelle de la souris
  -600 WORD G_CurY       Idem mais pour Y (hin hin...)
  -598 WORD M_Hid_Ct     Compteur du nombre de fois que vous avez demandez de
                         faire disparaŒtre la souris
  -596 WORD Mouse_Bt     Etat des boutons de la souris (une souris … 16 boutons
                         est donc possible, et non, elle n'a pas de l'acn‚).
  -594 WORD Req_Col      Les part VDI des couleurs RGB. Voyez Vq_Color (VDI )
                         sur 48 WORDs
  -498 WORD Siz_Tab      Sur 15 WORDs, les tailles pour les sorties texte
  -468 WORD              R‚serv‚
  -466 WORD              R‚serv‚
  -464 LONG Cur_Work     Pointeur vers les attributs de la station de travail
                         actuelle
  -460 LONG Def_Font     Pointeur vers le Header de la fonte par d‚faut
  -456 LONG Font_Ring    4 LONGs qui forment la "Font_Queue", … l'image de la
                         VBL_Queue.
  -440 WORD Font_Count   Nombre de fonte dans Font_Ring
  -438                   R‚serv‚
     …
  -348 BYTE Cur_Ms_Stat  Statut de la souris
  -347 BYTE              R‚serv‚
  -346 WORD V_Hid_Cnt    Nombre de fois que l'on a demand‚ au curseur de
                         disparaŒtre
  -344 WORD Cur_X        Coordonn‚e de la nouvelle position de la souris. Si
                         cette position est la mˆme que G_CurX et G_CurY, le
                         systŠme d'exploitation ne se donne pas la peine de
                         retracer la souris, et ainsi vous gagnez quelques
                         cycles machines. Regardez l'oscillo d'un SoundTracker,
                         bougez la souris, et concluez...
  -342 WORD Cur_Y        Idem pour les Y.
  -340 BYTE Cur_Flag     Si diff‚rent de z‚ro, la souris sera redessin‚e … la
                         prochaine VBL
  -339 BYTE Mouse_Flag   Si diff‚rent de z‚ro, la souris est lƒch‚e sur le
                         Bureau, sinon elle est immobilis‚e
  -338 LONG              R‚serv‚
  -334 WORD V_Sav_X      Coordonn‚e X sauvegard‚e du curseur
  -332 WORD V_Sav_Y      Coordonn‚e Y sauvegard‚e du curseur
  -330 WORD Save_Len     Hauteur en point du morceau d'‚cran sauvegard‚ sous le
                         pointeur de la souris (en principe ‚gal … la hauteur
                         de la souris)
  -328 LONG Save_Adr     Adresse du premier mot sauvegard‚ du morceau d'‚cran
                         sous la souris. En principe d‚pend de la forme de la
                         souris.
  -324 WORD Save_Stat
  -322 WORD Save_Area    128 WORDs composants le fond de l'‚cran avant que la
                         souris n'ait eu le temps de le salir de ses pixels
                         rebels et revendicateurs.
   -66 LONG User_Tim     Pointeur vers la routine utilisateur invoqu‚e … chaque
                         battement de l'horloge. Voyez VEx_Time (VDI ).
   -62 LONG Next_Tim     Pointeur vers la routine de tra‡age du pointeur de la
                         souris.
   -58 LONG User_But     Pointeur vers la routine personnelle de gestion des
                         boutons de la souris.
   -54 LONG User_Cur     Pointeur vers la routine de tra‡age personnelle de la
                         souris.
   -50 LONG User_Mot     Pointeur vers la routine personnelle de gestion du
                         d‚placement de la souris
   -46 WORD V_Cel_Ht     Hauteur en points de la cellule d'un caractŠre
   -44 WORD V_Cel_MX     Nombre de caractŠres par ligne-1
   -42 WORD V_Cel_MY     Nombre de lignes-1
   -40 WORD V_Cel_WR     Nombre d'OCTETs entre une ligne et la suivante
   -38 WORD V_Col_BG     Couleur du fond
   -36 WORD V_Col_FG     Couleur du premier plan
   -34 LONG V_Cur_Ad     Adresse du curseur … l'‚cran
   -30 WORD V_Cur_Of     Nombre d'OCTETs entre le d‚but de l'‚cran et la
                         premiŠre ligne de texte
   -28 WORD V_Cur_X      Position X du curseur
   -26 WORD V_Cur_Y      Position Y du curseur
   -24 BYTE V_Period     Nombre de VBL entre deux clignotement du curseur
   -23 BYTE V_Cur_Ct     Compte … rebours avant le clignotement du curseur
   -22 LONG V_FntAd      Pointeur vers les donn‚es de la fonte actuelle
   -18 WORD V_Fnt_Nd     Code ASCII maximum de la fonte
   -16 WORD V_Fnt_St     Code ASCII minimum de la fonte
   -14 WORD V_Fnt_Wd     Largeur de la fonte (en OCTETs)
   -12 WORD V_Rez_Hz     Nombre de points de l'‚cran actuel
   -10 LONG V_Off_Ad     Pointeur vers une tables d'OffSet de fontes
    -6 WORD              R‚serv‚
    -4 WORD V_Rez_Vt     Nombre de lignes de l'‚cran actuel
    -2 WORD Bytes_Ln     Largeur MFDB de l'‚cran
     0 WORD V_Planes     Nombre de plan de l'‚cran actuel
     2 WORD V_Lin_Wr     Nombre d'OCTETs par ligne
     4 LONG GEM_Contrl   Pointeur vers le tableau Contrl du GEM
     8 LONG GEM_IntIn    Pointeur vers le tableau IntIn du GEM
    12 LONG GEM_PtsIn    Pointeur vers le tableau PtsIn du GEM
    16 LONG GEM_IntOut   Pointeur vers le tableau IntOut du GEM
    20 LONG GEM_PtsOut   Pointeur vers le tableau PtsOut du GEM
    24 WORD _FG_BP_1
    26 WORD _FG_BP_2
    28 WORD _FG_BP_3
    30 WORD _FG_BP_4
    32 WORD _LstLin      -1 ici
    34 WORD _Ln_Mask     Motif de ligne
    36 WORD _Wrt_Mode    Mode d'‚criture (Voyez VDI 32)
                         0 = Source
                         1 = Transparent
                         2 = XOR
                         3 = NOT Transparent
    38 WORD _X1          Coordonn‚e X du coin sup‚rieur gauche
    40 WORD _Y1          Coordonn‚e Y du coin sup‚rieur gauche
    42 WORD _X2          Coordonn‚e X du coin inf‚rieur droit
    44 WORD _Y2          Coordonn‚e Y du coin inf‚rieur droit
    46 LONG _PatPtr      Pointeur vers les donn‚es du motif de remplissage
    50 WORD _PatMsk      Pointeur vers le masque du motif de remplissage
    52 WORD _MultiFill   0 = Motif de remplissage sur un seul plan
                         1 = Motif de remplissage sur tous les plans
    54 WORD _Clip        0 = Pas de CLIPPING
                         1 = CLIPPING
    56 WORD _XMn_Clip    Coordonn‚e X du coin sup‚rieur gauche du CLIPPING
    58 WORD _YMn_Clip    Coordonn‚e Y du coin sup‚rieur gauche du CLIPPING
    60 WORD _XMx_Clip    Coordonn‚e X du coin inf‚rieur droit du CLIPPING
    62 WORD _YMx_Clip    Coordonn‚e Y du coin inf‚rieur droit du CLIPPING
    64 WORD _XAcc_DDA    ???
    66 WORD _DDA_Inc     Facteur d'Agrandissement/R‚duction
    68 WORD _T_SclSts    0 = R‚duction
                         1 = Agrandissement
    70 WORD _Mono_Status 0 = Fonte proportionnelle
                         1 = Fonte non proportionnelle
    72 WORD _SourceX     X du caractŠre dans la fonte
    74 WORD _SourceY     Y du caractŠre dans la fonte
    76 WORD _DestX       Coordonn‚e X du caractŠre … l'‚cran
    78 WORD _DestY       Coordonn‚e Y du caractŠre … l'‚cran
    80 WORD _DelX        Largeur du caractŠre
    82 WORD _DelY        Hauteur du caractŠre
    84 LONG _FBase       Pointeur vers le d‚but des donn‚es de la fonte
    88 WORD _FWidth      Largeur de la fonte
    90 WORD _Style       Effets graphiques
    92 WORD _LiteMask    Masque pour l'‚criture en clair
    94 WORD _SkewMask    Masque pour l'‚criture en italique
    96 WORD _Weight      Nombre de BITs pour le gras
    98 WORD _R_Off       D‚placement droit pour l'italique
   100 WORD _L_Off       D‚placement gauche pour l'italique
   102 WORD _Scale       0 = Non
                         1 = Oui
   104 WORD _Chup        Angle de rotation du texte en dixiŠme de degr‚
   106 WORD _Text_FG     Couleur du texte
   108 LONG _ScrtChp     Adresse de la m‚moire tampon pour la production des
                         effets graphiques sur le texte
   112 WORD _Scrpt2
   114 WORD _Text_BG     Couleur du fond pour le texte
   116 WORD _CopyTran    Si … 0, Copie Opaque (normale)
                              1, Copie Transparente (monochrome vers couleur)
   118 LONg _Fill_Abort  Pointeur vers une routine de test d'arrˆt pour le
                         remplissage. Il faut mettre 0 dans D0 pour faire
                         continuer le remplissage, sinon 1 pour qu'il s'arrˆte.

         A1 = Pointeur vers un tableau contenant les adresses des trois fontes
              systŠmes (6*6 ic“nes, 8*8 Low Reso, 8*16 Hi Reso)
              Structure du tableau : LONG 0 : Adresse du Header de la fonte 6*6
                                     LONG 1 : Adresse du Header de la fonte 8*8
                                     LONG 2 : Adresse du Header de la fonte
                                              8*16
         A2 = Pointeur vers un tableau contenant les adresses des diff‚rentes
              routines Line A
              Structure du tableau : LONG 0 : Put Pixel
                                     LONG 1 : Get Pixel
                                     LONG 2 : Line
                                     LONG 3 : Horizontal Line
                                     LONG 4 : Filled Rectangle
                                     LONG 5 : Filled Polygon
                                     LONG 6 : BitBlt
                                     LONG 7 : TextBlt
                                     LONG 8 : Show Mouse
                                     LONG 9 : Hide Cursor
                                     LONG A : Transform Mouse
                                     LONG B : UnDraw Sprite
                                     LONG C : Draw Sprite
                                     LONG D : Copy Raster Form
                                     LONG E : Contour Fill

/// A001 : Put Pixel ///

Place un point d'une couleur donn‚e … l'‚cran.

ParamŠtres : X dans PtsIn0 (celui du GEM (voir variables LineA))
             Y dans PtsIn1 (Idem)
             Index de la couleur dans IntIn0 (Idem)
Retour : Aucun (sauf … l'‚cran)

/// A002 : Get Pixel ///

Permet d'obtenir la couleur d'un point.

ParamŠtres : X dans PtsIn0 (Celui du GEM)
             Y dans PtsIn1 (Idem)
Retour : D0.w = Index de couleur du point

/// A003 : Line ///

Permet de tracer une ligne. La fonction trace de la gauche vers la droite et de
haut en bas, donc attention … l'ordre des X et des Y.

ParamŠtres : X1 dans _X1
             Y1 dans _Y1
             X2 dans _X2
             Y2 dans _Y2
               Attention, car les lignes qui sortent de l'‚cran ne subissent pas
               de CLIPPING. En clair, la ligne est ‚crite jusqu'au bout. Pour
               faire cela, imaginez vous le jeu Asteroid, o— lorsque le vaisseau
               sort d'un cot‚ de l'‚cran, il r‚apparaŒt de l'autre cot‚.
                 Ici, c'est la mˆme chose. Une ligne de 0,0 … 639,639 sera
               affich‚e en fait de 0,0 … 479,479 et de 480,0 … 639,159.
                 Pour des lignes en couleur, il ne s'agit pas d'indiquer
               simplement l'index de couleur … utiliser, mais de d‚finir
               directement les plans de BITs … afficher.
             Plan 0 dans _FG_BP_1
             Plan 1 dans _FG_BP_2
             Plan 2 dans _FG_BP_3
             Plan 3 dans _FG_BP_4
             Motif de la ligne dans _Ln_Mask
             Mode d'‚criture dans _Wrt_Mod
               0 = Trace normalement la ligne
               1 = OR entre l'‚cran et le motif de la ligne
               2 = XOR entre l'‚cran et le motif de la ligne
               3 = XNOR entre l'‚cran et le motif de la ligne
             -1 dans _LstLin
Retour : Aucun (sauf bien ‚videment … l'‚cran)

/// A004 : Horizontal Line ///

Version optimis‚e de la pr‚c‚dente, qui ne trace que des lignes horizontales.
C'est donc trŠs rapide. Cependant, cette fonction n'est pas plus simple que la
pr‚c‚dente.

ParamŠtres : X1 dans _X1
             Y dans _Y1
             X2 dans _X2
             Y dans _Y2
             Plan 0 dans _FG_BP_1
             Plan 1 dans _FG_BP_2
             Plan 2 dans _FG_BP_3
             Plan 3 dans _FG_BP_4
             Motif de la ligne dans _Ln_Mask
             Mode d'‚criture dans _Wrt_Mod
               0 = Trace normalement la ligne
               1 = OR entre l'‚cran et le motif de la ligne
               2 = XOR entre l'‚cran et le motif de la ligne
               3 = XNOR entre l'‚cran et le motif de la ligne
             Pointeur sur le motif de ligne … utiliser dans _PatPtr
             Masque du motif de la ligne dans _PatMsk
Retour : Aucun

/// A005 : Filled Rectangle ///

Sert … afficher un rectangle plein. Cette fonction est une d‚clinaison de la
pr‚c‚dente, et en GROS, affiche une suite de lignes horizontales … l'‚cran. Mˆme
chose, l'ordre des coordonn‚es est important, donc haut … gauche d'abord, puis
bas … droite.

ParamŠtres : X1 dans _X1
             Y1 dans _Y1
             X2 dans _X2
             Y2 dans _Y2
             Pour les couleurs, c'est pareils.
             Plan 0 dans _FG_BP_1
             Plan 1 dans _FG_BP_2
             Plan 2 dans _FG_BP_3
             Plan 3 dans _FG_BP_4
             Mode d'‚criture dans _Wrt_Mod
               0 = Trace normalement la ligne
               1 = OR entre l'‚cran et le motif de la ligne
               2 = XOR entre l'‚cran et le motif de la ligne
               3 = XNOR entre l'‚cran et le motif de la ligne
             Pointeur sur le motif de la ligne dans _PatPtr
             Pointeur vers le masque dans _PatMsk
             Flag du CLIPPING dans _Clip
               0 = Le rectangle est affich‚ tel quel, comme on le demande
               1 = Le CLIPPING d‚finit est pris en compte
             X1 du CLIPPING dans _XMn_Clip
             Y1 du CLIPPING dans _YMn_Clip
             X2 du CLIPPING dans _XMx_Clip
             Y2 du CLIPPING dans _YMx_Clip
Retour : Aucun (sinon … l'‚cran, bien sur)

/// A006 : Filled Polygon ///

Trace un ensemble de lignes, et remplit les espaces.

ParamŠtres : Nombre de couple de coordonn‚es dans Contrl1
             Les diff‚rents couples dans PtsIn
               ATTENTION : Pour le premier couple, X dans PtsIn0 et Y dans
                           PtsIn1. Pour clore un polygone, terminer avec les
                           mˆmes premiŠres coordonn‚es.
             Y de la ligne dans _Y1
             Plan 0 dans _FG_BP_1
             Plan 1 dans _FG_BP_2
             Plan 2 dans _FG_BP_3
             Plan 3 dans _FG_BP_4
             Mode d'‚criture dans _Wrt_Mod
               0 = Trace normalement la ligne
               1 = OR entre l'‚cran et le motif de la ligne
               2 = XOR entre l'‚cran et le motif de la ligne
               3 = XNOR entre l'‚cran et le motif de la ligne
             Pointeur sur le motif de la ligne dans _PatPtr
             Pointeur vers le masque dans _PatMsk
             Flag du CLIPPING dans _Clip
               0 = Le rectangle est affich‚ tel quel, comme on le demande
               1 = Le CLIPPING d‚finit est pris en compte
             X1 du CLIPPING dans _XMn_Clip
             Y1 du CLIPPING dans _YMn_Clip
             X2 du CLIPPING dans _XMx_Clip
             Y2 du CLIPPING dans _YMx_Clip
Retour : Aucun

/// A007 : BitBlt ///

Copie d'une zone de m‚moire vers une autre, OBLIGATOIREMENT de la mˆme taille.
Si vous z'avez un Blitter, la fonction l'exploite.

ParamŠtres : Adresse d'une structure BitBlt dans A6 (c'est pas commun, hein?)

> Structure BitBlt
  WORD  0 : Largeur de la zone en points
  WORD  1 : Hauteur de la zone en points
  WORD  2 : Nombre de plans
  WORD  3 : Couleur du premier plan
  WORD  4 : Couleur de fond
  LONG  5 : Op‚ration logique … effectuer. Les mˆmes que celle du Blitter.
               0 = Destination … 0 (utile pour effacer une zone de m‚moire)
               1 = Source AND Destination
               2 = Source NAND Destination
               3 = Source (le plus fr‚quent)
               4 = NOT Source AND Destination
               5 = Destination (quelle utilit‚?)
               6 = Source XOR Destination
               7 = Source OR Destination
               8 = NOT Source NAND Destination
               9 = NOT Source XOR Destination
              10 = NOT Destination
              11 = Source NOR Destination
              12 = NOT Source
              13 = NOT Source OR Destination
              14 = NOT Source NOR Destination
              15 = Destination plein (tous les BITs … 1)
  WORD  7 : Coordonn‚e X du coin sup‚rieur gauche du bloc source
            Si vous voulez copier un bloc entier, mettez 0
  WORD  8 : Coordonn‚e Y du coin sup‚rieur gauche du bloc source
  LONG  9 : Adresse du bloc source
  WORD 11 : Nombre d' OCTETs entre deux WORD … copier. Normalement 2 pour une
            copie contigu‰.
  WORD 12 : Nombre d'OCTETs … sauter pour la ligne suivante.
  WORD 13 : Nombre d'OCTETs … sauter pour arriver sur le prochain plan. 2 il me
            semble.
  WORD 14 : Coordonn‚e X du coin sup‚rieur gauche du bloc destination
  WORD 15 : Coordonn‚e Y du coin sup‚rieur gauche du bloc destination
  LONG 16 : Adresse de la destination
  WORD 18 : Idem que WORD 11, mais pour la destination
  WORD 19 : Idem que WORD 12, mais toujours pour la destination
  WORD 20 : Idem que WORD 13, destination donc
  LONG 21 : Adresse de la "grille" Pattern. - Je comprend Pas -
  WORD 23 : Taille d'une ligne de la grille en OCTETs
  WORD 24 : Nombre d'OCTETs jusqu'au prochain plan de la grille
  WORD 25 : Hauteur de la grille
  WORD 26 : Masque (???)
       …
  WORD 37 :

Retour : Aucun

/// A008 : TextBlt ///

C'est LA fonction texte de l'ATARI. Elle est ind‚pendante des fonctions BIOS,
mais vraiment sup‚rieure. Cependant, les apports qu'elle offre, faudra les
pr‚ciser pr‚cedemment, donc attendez vous … un gros boulot. Le mieux, entre
nous, est d'‚crire une macro routine pour l'utiliser, avec un passage de
paramŠtres. De plus, on peut utiliser des fontes diff‚rentes, ce qui veut dire
casse tˆte (un vrai de vrai, ici).

> Structure Font
  Structure d'une fonte normale.
  WORD  0 : Font Identifier : num‚ro de la fonte
              1 = Fonte systŠme
  WORD  1 : Taille de la fonte en points
  WORD  2 … 17 : Nom de la fonte
  WORD 18 : Code ASCII minimum des caractŠres affichables (32 pour l'espace, en
            principe)
  WORD 19 : Code ASCII maximum des caractŠres affichables
  WORD 20 : Distance entre la ligne de base et la ligne sup‚rieure
  WORD 21 : Distance entre la ligne de base et la ligne ascendante
  WORD 22 : Distance entre la ligne de base et la demi ligne
  WORD 23 : Distance entre la ligne de base et la ligne descendante
  WORD 24 : Distance entre la ligne de base et la ligne inf‚rieure
  WORD 25 : Largeur du caractŠre le plus large de la fonte
  WORD 26 : Largeur de la cellule de caractŠre la plus large de la fonte (en
            principe un point de plus que la largeur du caractŠre le plus
            large)
  WORD 27 : D‚calage gauche pour l'‚criture en italique
  WORD 28 : D‚calage droit pour l'‚criture en italique
  WORD 29 : Nombre de BITs en plus … afficher pour obtenir une ‚criture en gras
  WORD 30 : Hauteur de la ligne pour l'‚criture en UnderLine
  WORD 31 : Masque pour l'‚criture en clair
  WORD 32 : Masque pour l'‚criture en italique
  WORD 33 : Type de la fonte
            BIT 0 : Systeme
                      0 = Non
                      1 = Oui
            BIT 1 : Table de d‚calage horizontale
                      0 = Non
                      1 = Oui
            BIT 2 : Byte Swap Flag - Format de la fonte
                      0 = Format INTEL (OCTET Bas - OCTET Haut (sens Z80))
                      1 = Format MOTOROLA (OCTET Haut - OCTET Bas (sens normal))
            BIT 3 : Proportionnalit‚ de la fonte
                      0 = Fonte Proportionnelle, la largeur des caractŠres
                          d‚pend de leur taille
                      1 = Fonte Non-Proportionnelle, la largeur est la mˆme pour
                          tous les caractŠres
  LONG 34 : Adresse de la table de d‚calage horizontale
  LONG 36 : Adresse de la table de d‚calage des caractŠres
  LONG 38 : Adresse des donn‚es de la fonte
  WORD 40 : Taille d'une ligne de caractŠre
  WORD 41 : Nombre de lignes de la fonte
  LONG 42 : Adresse de la prochaine fonte

N'ayant pas encore eut le temps d'exp‚rimenter plus profond‚ment cette fonction
(NdM: Je croyais que c'‚tait g‚n‚ralis‚ … toutes les fonctions LineA? (Moi: Oui,
c'est bon, j'avoue...)), je ne peut … l'heure actuelle vous donner de plus
amples renseignement. Ye pense que cela sera r‚par‚ avec la prochaine version de
SSAV, si vous y prˆtez un int‚rˆt sup‚rieur au nul absolu (En fait, je vais m'y
plonger sans votre b‚n‚diction...).

ParamŠtres : Mode d'‚criture dans _Wrt_Mode
             Index de couleur du texte dans _Text_Fg
             Index de couleur du fond du texte dans _Text_Bg
             Pointeur sur le d‚but des donn‚es de la fonte dans _FBase
             Largeur de la fonte dans _FWidth
             X du caractŠre dans la fonte dans _SourceX
             Y du caractŠre dans la fonte dans _SourceY
             X du caractŠre … l'‚cran dans _DestX
             Y du caractŠre … l'‚cran dans _DestY
             Largeur du caractŠre en points dans _DelX
             Hauteur du caractŠre en points dans _DelY
             Effets … appliquer sur le texte dans _Style
             Masque pour l'‚criture en clair dans _LiteMask
             Masque pour l'‚criture en italique dans _SkewMask
             Facteur d'agrandissement du caractŠre dans _Weight
             D‚placement droit pour l'italique dans _R_Off
             D‚placement gauche pour l'italique dans _L_Off
             Mode d'Agrandissement/R‚duction dans _Scale
             Accumulateur pour l'agrandissement dans _XACC_DDA
             Facteur d'agrandissement ou de r‚duction dans _DDA_Inc
             Direction de l'alignement dans _T_SclSts
             Angle de rotation dans _Chup
             Mode d'‚criture fixe dans _Mono_Status
             Poiteur sur un buffer de travail pour l'application des effets
               dans _ScrtChp
             D‚placement pour l'alignement dans _ScrtChp dans _ScrPt2
Retour : Aucun

/// A009 : Show Mouse ///

Fait apparaŒtre la souris, mˆme sous TOS.

ParamŠtres : 0 dans Contrl1
             1 dans Contrl3
             Si vous mettez 0 dans IntIn0, le pointeur de la souris apparaŒt
             imm‚diatement, sinon le compteur est pris en compte, et vous devez
             appeler cette fonction autant de fois qu'il … ‚t‚ demand‚ de faire
             disparaŒtre le pointeur avant que celui ne r‚apparaisse. Kapito?
Retour : La souris dans les basques (La voisine perch‚e sur une chaise au
         milieu de la cuisine : Hiiiiiiiiiii!)

/// A00A : Hide Cursor ///

Demande de faire disparaŒtre la souris.

ParamŠtres : Aucun
Retour : Clap, plus de souris. La voisine : "Rhhhƒƒaa... Lovely" (½ Gotlib)

/// A00B : Transform Mouse ///

Une nouvelle souris, une.

ParamŠtres : Couleur du masque (0 = Blanc en principe) dans IntIn3
             Couleur du pointeur (1 = Noir en principe) dans IntIn4
             Les donn‚es du masque dans IntIn5 … IntIn20
             Les donn‚es du pointeur dans IntIn21 … IntIn36
Retour : Votre souris change de tˆte. Formidable, non? Essayez avec celle d'un
         ‚l‚phant, ‡a trompe ‚norm‚ment.

/// A00C : Undraw Sprite ///

Dessine un Sprite de 16*16 pixels.

ParamŠtres : Adresse du buffer contenant le fond … replacer dans A2
Retour : Plus de Sprite

/// A00D : Draw Sprite ///

Dessine un Sprite monochrome.

ParamŠtres : Coordonn‚e X du Point Chaud du Sprite … afficher dans D0
             Coordonn‚e Y du Point Chaud du Sprite … afficher dans D1
             Pointeur vers la d‚finition du Sprite dans A0
               WORD 0 : Coordonn‚e X du Point Chaud dans le Sprite
               WORD 1 : Coordonn‚e Y du Point Chaud dans le Sprite
               WORD 2 : Format
                        0 = VDI
                        1 = XOR (???)
                Suivant ce que contient les variables FG_Func et BG_Func, il se
                passe quelque chose de diff‚rent, suivant en plus le format
                choisit :


               WORD 3 : Couleur du masque
               WORD 4 : Couleur du Sprite

               puis 32 WORDs (2*16 lignes) o— les lignes du masque et du Sprite
               sont entrelac‚es

               WORD 5 : Ligne 0 du masque
               WORD 6 : Ligne 0 du Sprite
               WORD 7 : Ligne 1 du masque
               WORD 8 : Ligne 1 du Sprite
               ...
             Pointeur vers un buffer pour stocker le fond dans A2
               Ce buffer doit avoir une taille de 64 OCTETs pour chaque plan,
               plus 10 OCTETs
Retour : Un Sprite, … l'‚cran, en principe.

/// A00E : Copy Raster Form ///

Copie d'une zone de m‚moire … m‚moire. La diff‚rence avec BitBlt vient du fait
que cette fonction est un peu plus simple, et que l'on peut se passer des MFDB
si l'on ne prend que des morceaux d'‚cran.

ATTENTION : C'est une copie, donc le format Standard (PC, les OCTETs des pixels
            les uns … la suite des autres) n'est pas support‚.

ParamŠtres : Options de copie dans IntIn0
               BIT 3-0 : Suivant le mode de copie Opaque ou Transparente
                         Copie Opaque : 0 = Destination … 0
                                        1 = Source AND Destination
                                        2 = Source NAND Destination
                                        3 = Source (le plus fr‚quent)
                                        4 = NOT Source AND Destination
                                        5 = Destination (quelle utilit‚?)
                                        6 = Source XOR Destination
                                        7 = Source OR Destination
                                        8 = NOT Source NAND Destination
                                        9 = NOT Source XOR Destination
                                        10 = NOT Destination
                                        11 = Source NOR Destination
                                        12 = NOT Source
                                        13 = NOT Source OR Destination
                                        14 = NOT Source NOR Destination
                                        15 = Destination … "1"
                         Copie Transparente : 0 = Replace Mode
                                              1 = Transparent Mode
                                              2 = XOR Mode
                                              3 = Reverse Transparent Mode
               BIT 4 : Utilisation de la grille Pattern
                       0 = Non
                       1 = Oui
             Index des BIT … 1 pour la copie Transparente dans IntIn1
             Index des BIT … 0 pour la copie Transparente dans IntIn2
             X1 du coin sup‚rieur gauche de la source dans PtsIn0
             Y1 du coin sup‚rieur gauche de la source dans PtsIn1
             X2 du coin inf‚rieur droit de la source dans PtsIn2
             Y2 du coin inf‚rieur droit de la source dans PtsIn3
             X1 du coin sup‚rieur gauche de la destination dans PtsIn4
             Y1 du coin sup‚rieur gauche de la destination dans PtsIn5
             X2 du coin inf‚rieur droit de la destination dans PtsIn6
             Y2 du coin inf‚rieur droit de la destination dans PtsIn7
             Adresse du MFDB source dans Contrl7-8
               Si cette adresse est … 0, la Line A suppose que l'on lui demande
               poliment une op‚ration sur l'‚cran en cours, et se passe donc de
               notre sympathique MFDB.
             Adresse du MFDB destination dans Contrl9-10
               Mˆme remarque.
             Pointeur de Pattern dans _PatPtr
             Mode du Pattern dans _MultiFill
               0 = Pattern monochrome
               1 = Pattern couleur
             Mode de copie dans _CopyTran
               0 = Copie Opaque, couleur vers couleur
               1 = Copie Transparente, monochrome vers couleur (les registres
                   IntIn1-2 sont pris en compte)
Retour : Aucun

/// A00F : Contour Fill ///

Remplit une surface avec une couleur.

ParamŠtres : X dans PtsIn0
             Y dans PtsIn1
             Index de couleur dans IntIn0
               Si cet index est positif, la couleur s'arrˆte de remplir
               lorsqu'elle rencontre le bord de l'‚cran, ou la couleur de mˆme
               index. Si par contre cet index est n‚gatif, la couleur s'arrˆte …
               toutes les couleurs diff‚rentes de celle o— elle … ‚t‚ d‚pos‚e.
             Adresse d'une routine invoqu‚e r‚guliŠrement dans _Fill_Abort
               On peut ainsi, avec un petit programme, demander d'arrˆter de
               remplir. Mais celui ci DOIT ˆtre le plus cours possible (moins
               d'une milliseconde de pr‚f‚rence), ne pas faire appel au systŠme
               d'exploitation, mais directement au HardWare. Terminez par un
               RTS.
Retour : Aucun (sauf l'‚cran)

*** Fin de la DosCulMensuration ***

Dans la prochaine version :

  Il se trouve que je ne possŠde aucun document sur la structure d'un fichier
ressource. De l…, je ne peut encore terminer Objc_Search, Appl_Memory,
Conv_Rsc2Lang, et Conv_Rsc2Wk. Comme je compte utiliser Objc_Search dans
SSX2Form_Do au lieu de Rsrc_GAddr, relativement idiot, je ne peut terminer
SSX2Form_Do, ainsi que SSForm_Process.
  Pour Conv_ColorPic, c'est une autre histoire (Guido Vollbeding, ta routine de
tramage de 1StGuide m'int‚resse au plus au point...).
  Quand … la documentazion, elle subira indubitablement de larges et profondes
modifications tenants comptes de vos remarques pour la rendre plus complŠte et
plus compr‚hensive (certaines fonctions VDI et LineA essentiellement).
  Un nouveau chapitre apparaŒtra, intitul‚ "Alchimie du GEM". Son titre est
assez ‚vocateur pour vous laisser imaginer son pr‚cieux contenu (Swapping sous
GEM, m‚thodes pour faire un traitement de texte ou un logiciel de dessin sous
GEM, menu fant“me (et peut ˆtre Pop-Up), menu Pop-Icon, ...)

Bibliographie :

CLEFS POUR ATARI ST Tome 2 "GEM" par MARTIN Daniel aux Editions du P.S.I.
 ISBN 2-86595-374-2 CodBar 9-782865-953745 1986
GEM FšR DEN ATARI 520 ST par STEINER Joseph et Gerhard … Markt&Technik
 ISBN 3-89090-230-8 CodBar 4-001057-902305 1985-1986
DEVELOPPER EN GFA BASIC par l'auteur OSTROWSKI Frank … Micro Application
 ISBN 2-86899-103-3 CodBar X-XXXXXX-XXXXXX ISSN 0980-1928 Code 281 Ref ML295
LE LIVRE DU DEVELOPPEUR TOME 1 aux Editions Micro Application
 ISBN 2-86899-402-4 CodBar 9-782868-994028 ISSN 0980-1928
ASSEMBLEUR 68000 DE L'ATARI ST par HARD Olivier … Cedic/Nathan
 ISBN 2-86699-527-9 CodBar 9-782866-995270
AES LIBRARY & VDI LIBRARY par HiSoft
 ISBN 0-948517-59-X CodBar 5-024100-000192 1988-1992

De nombreux articles sur la chose parus dans ATARI Magazine, Start Micro
Magazine, et ST Magazine (et bient“t StraTOS, peut ˆtre, mais il est mal
diffus‚ (je n'ai que r‚ussi … me procurer le nø2 chez moi)).

Merci encore pour leurs pr‚cieux support moral durant le long coding … :

A-HA (October, Cry Wolf, Maybe Maybe, Soft Rains Of April, The Swing Of Things)
BASSLINE BOYS (On se calme)
BELAFONTE Harry (Paradise In Gazankulu, Sisiwami, Skin To Skin, Global Carnival)
BLACK BOX (EveryBody, Ride On Time)
BROWN Bobby (On Your Own)
CAUET ("Je m'excuse")
CHERRY Neneh (7 Seconds, Mame Bamba)
CONFETTI'S (The Sound Of C, The House of C, Jingle Bells)
D.J. BOBO (There Is A Party)
EURYTHMIC (Missionary Man, A Little Of You, The Miracle Of Love)
FURYO (La B.O. du film du mˆme nom, avec BOWIE David (EKO, vot' d‚mo, pas pig‚))
GENERATION DISCO (Generation Disco)
ICE Mc (Easy)
INNOCENTS (Les) (Un Homme Extraordinaire, L'autre Finistere, Fous … Lier)
JARRE Jean-Michel (Oxygen 5, EthniColor, Equinox, Rendez Vous)
LATINO PARTY (The Party, Tequila)
LILICUB (Voyage en Italie, J'ai crois‚ Ton Regard)
LORDS OF ACID (Voodoo-U, Marijuana In Your Brain, The Wet Dream, Dirty Willy)
MIND EVOLUTIONS (Trancelate, Quantum Beats, The Sun, NetWork 303, Pulstar)
M-PEOPLE (Moving On Up, Just For You)
OLDFIELD Mike ([Earth Moving], [QE2], [Crises], [Tubular Bells])
PUBLIC ENEMY (Give It Up, I Ain't Mad At All, Stop In The Name, Hitler Day)
SASH (Encore Une Fois, Oxygen 10, Ecuador)
S-EXPRESS (The Theme)
SNAP (The Power, Rythm Is A Dancer, Cult Of Snap, The First The Last Eternity)
SNOW Marc (X-Files Theme)
SPICE GIRLS (Wanna Be, Bumper To Bumper)
SPIN DOCTORS (Two Princes, Off My Line)
TECHNOTRONIC (Pump Up The Jam)
et tous les autres, insignifiants ou moins (Bjork, France Gall, Treponem Pal,
OffSpring, etc...) qui passent en fond sonore, mais que je n'oublie pas pour
autant.

Diffusion du fichier :

SSAV est un Hexa_Ware, c'est … dire qu'il y a six fa‡ons de s'enregistrer.
  ARTE_Ware, supporter audimatement la meilleure chaŒne TV du monde et essayer
             de lui faire passer le cap des 4% d'audimat largement m‚rit‚s
  Bugs_Ware, m'envoyer une liste de Bugs que VOUS avez trouv‚
  Disk_Ware, m'envoyer une boite de 10 disquettes HD sans erreurs
  Info_Ware, m'envoyer des informations relatives … la programmation sur ATARI
  Prog_Ware, m'envoyer un programme de votre cr‚ation (utilisant ou non SSAV)
  SSAV_Ware, utiliser SSAV, tout simplement...

  Pour vous enregistrer, il faut que vous choisissiez au moins deux modes
diff‚rents parmi ceux de la liste pr‚c‚dente. J'estime que ce n'est pas trop
demand‚...
  Ceux qui m'envoie des informations sur le GEM afin que je corrige certains
d‚fauts de SSAV, je le considŠre comme un enregistrement complet (Bugs_Ware et
Info_Ware).

Contacts :

Si vous voulez par exemples ajouter une fonction … la routine, reporter un bug,
me donner des informations sur le GEM (et MultiTOS surtout), me parler, bref, me
contacter, voici mon adresse :

KOCH David
29 Rue de GENEVE
85200 FONTENAY LE COMTE
FRANCE

et facultativement, ...
EUROPA (Allemagne, Belgique, Hollande, Italie, Luxembourg, Danemark, Irelande,
        Royaume Unis, Grece, Espagne, Portugal, Autriche, Finlande, Suede)
EARTH (North America, South America, Australia, Asia, Africa)
SOL (Mercure, Venus, Mars, Jupiter, Saturne, Uranus, Neptune, Pluton)
CORE SYSTEM (Proxima Centauri, Alpha Centauri, Barnard Star, Ross 154, Lalande
             21185, Lyuten 727-8, Sirius, Wolf 359, Ross 248, Epsilon Eridani,
             Ross 128, Luyten 789-6, Groombridge 34, Epsilon Indi, 61 Cygni,
             Sigma 2398, Tau Ceti, Procyon, Lacaille 9352, G 51-15, Van Maanen
             Star, Formalhaut, ...)
(Ces systŠmes solaires existent v‚ritablement et ne font pas partis du d‚lire
 spatial de Sir BRABEN David, concepteur des fabuleux VIRUS (ZARCH sur
 ArchimŠdes d'Acorn (Regardez l'‚mission du mˆme nom sur ARTE, elle est
 (presque) parfaite)) et FRONTIER)
VOIE LACTEE (Notre galaxie, c'est comme ‡a qu'elle s'appelle)
LOCAL GROUP (M 31 (Andromeda), M 33 (Triangulum), NGC 205, M 32, Leo 1, Leo 2,
             NGC 6503 (Draco), Ursa Minor, SMC (Tucuna), LMC (Dorado), NGC 253
             (Sculptor), NGC 1365 (Fornax), NGC 185, NGC 147, IC 1613, NGC 6822,
             ...)
...

P.S.: Pour la modification de la routine, laissez moi faire, s'il vous plaŒt.
      Envoyez moi vos coordonn‚es pour que je puisse vous envoyer rapidement la
      nouvelle version (un timbre et une disquette ne sont pas superflus, car je
      ne suis d‚j… pas trŠs riche et les Services Postaux s... Bref, vous voyez
      quoi).
        Je peux comprendre que vous ayez du mal … suivre un type comme moi :
      j'‚crit partiellement un programme, et je vous demande de l'aide, … vous,
      utilisateurs, pour le finir (si MicroSoft avait fait cela, je ne suit pas
      sur qu'ils auraient eus le mˆme succŠs (NdM: Mais c'est pas d‚j… ce qu'ils
      font? Ah non, eux c'est pour les bugs, "uniquement")). N‚anmoins, je
      compte sur vous, qui poss‚dez certainement quelque chose dont je n'ai pas
      eu vent dans ma jeunesse. Aussi, en ‚change de mon aide, aidez moi...

                                          Kochise Of STALLION SOFTWARE

Appel … l'AIDE : - J'ai besoin de toutes les informations possible
                   (HardWare et SoftWare) sur : 68020, 68030, 68040, 68060,
                   68881/2, 6800/2/9, 6502, DSP 56000/1/2, DSP 96000/1/2,
                   8086/7,8, 80186/7, 80188, 80286/7, 80386/7, 80486, 80586,
                   80686, PowerPC, ColdFire.
                 - Toutes les informations possible sur la programmation de
                   TOUS les ATARI (du ST au Falcon030, en passant par le TT, le
                   Stacy, le STBook, l'ATW800, les ABC, le PortFolio, les VCS
                   2600, 5200, 7800, Lynx, Panther (si quelqu'un a quelque
                   chose dessus), Jaguar, et autres si j'en oublie...

Cette ‚norme documentation … ‚t‚ ‚crite sous le monstrueux 7UP V2.03f
(TheoSoft, Michael T„nitz, francis‚ par LWING). Ch'u pas enr‚gistr‚, mais ‡a va
pas tarder, car un soft aussi ergonomique pour ‚crire les docs, c'est pas
courant.
